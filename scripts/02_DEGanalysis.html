<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DGEanalysis_assignment_BiostateAI</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="02_DEGanalysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="02_DEGanalysis_files/libs/quarto-html/quarto.js"></script>
<script src="02_DEGanalysis_files/libs/quarto-html/popper.min.js"></script>
<script src="02_DEGanalysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="02_DEGanalysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="02_DEGanalysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="02_DEGanalysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="02_DEGanalysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="02_DEGanalysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="02_DEGanalysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#loading-the-required-libraries" id="toc-loading-the-required-libraries" class="nav-link active" data-scroll-target="#loading-the-required-libraries">Loading the required libraries</a>
  <ul>
  <li><a href="#function-to-add-gene-names-didnt-use-it-though" id="toc-function-to-add-gene-names-didnt-use-it-though" class="nav-link" data-scroll-target="#function-to-add-gene-names-didnt-use-it-though">Function to add gene names [Didnt use it though]</a></li>
  <li><a href="#importing-the-counts-matrix" id="toc-importing-the-counts-matrix" class="nav-link" data-scroll-target="#importing-the-counts-matrix">Importing the counts matrix</a></li>
  <li><a href="#loading-the-metadata-file" id="toc-loading-the-metadata-file" class="nav-link" data-scroll-target="#loading-the-metadata-file">Loading the metadata file</a></li>
  </ul></li>
  <li><a href="#creation-and-exploration-of-dds-object" id="toc-creation-and-exploration-of-dds-object" class="nav-link" data-scroll-target="#creation-and-exploration-of-dds-object">Creation and exploration of dds object</a>
  <ul>
  <li><a href="#pca-plot" id="toc-pca-plot" class="nav-link" data-scroll-target="#pca-plot">PCA plot</a></li>
  <li><a href="#sample-correlation-heatmap-using-vst-counts" id="toc-sample-correlation-heatmap-using-vst-counts" class="nav-link" data-scroll-target="#sample-correlation-heatmap-using-vst-counts">Sample correlation heatmap using vst counts</a></li>
  </ul></li>
  <li><a href="#differential-gene-expression-analysis" id="toc-differential-gene-expression-analysis" class="nav-link" data-scroll-target="#differential-gene-expression-analysis">Differential gene expression analysis</a>
  <ul>
  <li><a href="#main-effects-due-to-tissue" id="toc-main-effects-due-to-tissue" class="nav-link" data-scroll-target="#main-effects-due-to-tissue">Main effects due to tissue</a>
  <ul class="collapse">
  <li><a href="#comparison-of-wald-versus-lrt-test-degs-main-effects-due-to-tissue" id="toc-comparison-of-wald-versus-lrt-test-degs-main-effects-due-to-tissue" class="nav-link" data-scroll-target="#comparison-of-wald-versus-lrt-test-degs-main-effects-due-to-tissue">Comparison of Wald versus LRT test DEGs Main effects due to tissue</a></li>
  <li><a href="#visualization-of-tissue-specific-degs-using-deseq2" id="toc-visualization-of-tissue-specific-degs-using-deseq2" class="nav-link" data-scroll-target="#visualization-of-tissue-specific-degs-using-deseq2">Visualization of tissue-specific DEGs using DESeq2</a></li>
  <li><a href="#expression-pattern-of-top-tissue-specific-degs" id="toc-expression-pattern-of-top-tissue-specific-degs" class="nav-link" data-scroll-target="#expression-pattern-of-top-tissue-specific-degs">Expression pattern of top tissue-specific DEGs</a></li>
  <li><a href="#pathway-analysis-using-the-tissue-specific-degs-main-effects-using-ora" id="toc-pathway-analysis-using-the-tissue-specific-degs-main-effects-using-ora" class="nav-link" data-scroll-target="#pathway-analysis-using-the-tissue-specific-degs-main-effects-using-ora">Pathway analysis using the tissue-specific DEGs (Main effects) using ORA</a></li>
  <li><a href="#pathway-analysis-using-the-tissue-specific-degs-main-effects-using-gsea" id="toc-pathway-analysis-using-the-tissue-specific-degs-main-effects-using-gsea" class="nav-link" data-scroll-target="#pathway-analysis-using-the-tissue-specific-degs-main-effects-using-gsea">Pathway analysis using the tissue-specific DEGs (Main effects) using GSEA</a></li>
  </ul></li>
  <li><a href="#main-effects-due-to-timepoint" id="toc-main-effects-due-to-timepoint" class="nav-link" data-scroll-target="#main-effects-due-to-timepoint">Main effects due to timepoint</a>
  <ul class="collapse">
  <li><a href="#comparison-of-wald-versus-lrt-test-degs-main-effects-due-to-time" id="toc-comparison-of-wald-versus-lrt-test-degs-main-effects-due-to-time" class="nav-link" data-scroll-target="#comparison-of-wald-versus-lrt-test-degs-main-effects-due-to-time">Comparison of Wald versus LRT test DEGs [Main effects due to time]</a></li>
  <li><a href="#visualization-of-timepoint-specific-degs-using-deseq2" id="toc-visualization-of-timepoint-specific-degs-using-deseq2" class="nav-link" data-scroll-target="#visualization-of-timepoint-specific-degs-using-deseq2">Visualization of timepoint-specific DEGs using DESeq2</a></li>
  <li><a href="#expression-pattern-of-top-time-specific-degs" id="toc-expression-pattern-of-top-time-specific-degs" class="nav-link" data-scroll-target="#expression-pattern-of-top-time-specific-degs">Expression pattern of top time-specific DEGs</a></li>
  <li><a href="#pathway-analysis-using-the-timepoint-specific-degs-main-effects-using-ora" id="toc-pathway-analysis-using-the-timepoint-specific-degs-main-effects-using-ora" class="nav-link" data-scroll-target="#pathway-analysis-using-the-timepoint-specific-degs-main-effects-using-ora">Pathway analysis using the timepoint-specific DEGs (Main effects) using ORA</a></li>
  <li><a href="#pathway-analysis-using-the-tissue-specific-degs-main-effects-using-gsea-1" id="toc-pathway-analysis-using-the-tissue-specific-degs-main-effects-using-gsea-1" class="nav-link" data-scroll-target="#pathway-analysis-using-the-tissue-specific-degs-main-effects-using-gsea-1">Pathway analysis using the tissue-specific DEGs (Main effects) using GSEA</a></li>
  </ul></li>
  <li><a href="#interaction-effects" id="toc-interaction-effects" class="nav-link" data-scroll-target="#interaction-effects">Interaction effects</a>
  <ul class="collapse">
  <li><a href="#comparison-of-wald-versus-lrt-test---interaction-effects" id="toc-comparison-of-wald-versus-lrt-test---interaction-effects" class="nav-link" data-scroll-target="#comparison-of-wald-versus-lrt-test---interaction-effects">Comparison of Wald versus LRT test - interaction effects</a></li>
  <li><a href="#visualization-of-interaction-specific-degs-using-deseq2" id="toc-visualization-of-interaction-specific-degs-using-deseq2" class="nav-link" data-scroll-target="#visualization-of-interaction-specific-degs-using-deseq2">Visualization of interaction-specific DEGs using DESeq2</a></li>
  <li><a href="#expression-pattern-of-top-interaction-specific-degs" id="toc-expression-pattern-of-top-interaction-specific-degs" class="nav-link" data-scroll-target="#expression-pattern-of-top-interaction-specific-degs">Expression pattern of top interaction-specific DEGs</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#paired-contrast-analysis---difference-between-liver-and-heart-at-each-timepoint" id="toc-paired-contrast-analysis---difference-between-liver-and-heart-at-each-timepoint" class="nav-link" data-scroll-target="#paired-contrast-analysis---difference-between-liver-and-heart-at-each-timepoint">Paired contrast analysis - Difference between Liver and Heart at each timepoint</a>
  <ul>
  <li><a href="#pathway-analysis-for-tissue-enriched-degs-for-timepoint-t0" id="toc-pathway-analysis-for-tissue-enriched-degs-for-timepoint-t0" class="nav-link" data-scroll-target="#pathway-analysis-for-tissue-enriched-degs-for-timepoint-t0">Pathway analysis for tissue-enriched DEGs for timepoint T0</a></li>
  <li><a href="#pathway-analysis-for-tissue-enriched-degs-for-timepoint-t12" id="toc-pathway-analysis-for-tissue-enriched-degs-for-timepoint-t12" class="nav-link" data-scroll-target="#pathway-analysis-for-tissue-enriched-degs-for-timepoint-t12">Pathway analysis for tissue-enriched DEGs for timepoint T12</a></li>
  </ul></li>
  <li><a href="#heirarchical-clustering-of-all-the-degs" id="toc-heirarchical-clustering-of-all-the-degs" class="nav-link" data-scroll-target="#heirarchical-clustering-of-all-the-degs">Heirarchical clustering of all the DEGs</a></li>
  <li><a href="#plot-the-expression-pattern-of-the-degs-obtained-from-all-the-above-comparisons" id="toc-plot-the-expression-pattern-of-the-degs-obtained-from-all-the-above-comparisons" class="nav-link" data-scroll-target="#plot-the-expression-pattern-of-the-degs-obtained-from-all-the-above-comparisons">Plot the expression pattern of the DEGs obtained from all the above comparisons</a>
  <ul>
  <li><a href="#pathway-analysis-of-various-clusters-obtained-from-the-above-analysis" id="toc-pathway-analysis-of-various-clusters-obtained-from-the-above-analysis" class="nav-link" data-scroll-target="#pathway-analysis-of-various-clusters-obtained-from-the-above-analysis">Pathway analysis of various clusters obtained from the above analysis</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">DGEanalysis_assignment_BiostateAI</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="loading-the-required-libraries" class="level2">
<h2 class="anchored" data-anchor-id="loading-the-required-libraries">Loading the required libraries</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tximport)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#for data wrangling</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DESeq2) <span class="co">#for DEG analysis</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(genekitr) <span class="co">#for pathway analysis</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co">#for data import</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(eatTools) <span class="co">#for rbind functions</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(strex) <span class="co">#for string related functions</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr) <span class="co">#for beautiful tables</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt) <span class="co">#for customized table layouts</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ComplexHeatmap) <span class="co">#for beautiful heatmaps</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyheatmaps) <span class="co">#for heatmap generation from dataframe</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork) <span class="co">#for adding multiple figures to a plot</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer) <span class="co">#for color schemas</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="co">#for plotting</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ExploreModelMatrix) <span class="co">#to explore complicated design in the DESeq2 formula</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(UpSetR) <span class="co">#for upset plots</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DEGreport) <span class="co">#for clustering of genes into groups based on expression pattern</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>gtf <span class="ot">&lt;-</span> rtracklayer<span class="sc">::</span><span class="fu">import</span>(<span class="st">"~/Documents/BiostateAI/data/fastqs/gencode.vM35.basic.annotation.gtf"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>gtf_df<span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(gtf)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#head(gtf_df)</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># this file is used to import the salmon output to summarize the counts from </span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># transcript level to gene level</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>tx2gene<span class="ot">&lt;-</span> gtf_df <span class="sc">%&gt;%</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"transcript"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(transcript_id, gene_id)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># this file is used to map the ENSEMBL gene id to gene symbols in the DESeq2 results</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>gene_name_map<span class="ot">&lt;-</span> gtf_df <span class="sc">%&gt;%</span> </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"gene"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(gene_id, gene_name) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>files<span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">"~/Documents/BiostateAI/results/output/kallisto/"</span>, <span class="at">pattern =</span> <span class="st">".tsv"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(files) <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_split</span>(files, <span class="at">pattern =</span> <span class="st">"/"</span>, <span class="at">simplify =</span> <span class="cn">TRUE</span>)[,<span class="dv">10</span>]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>txi.kallisto.tsv <span class="ot">&lt;-</span> <span class="fu">tximport</span>(files, <span class="at">type =</span> <span class="st">"kallisto"</span>, <span class="at">tx2gene =</span> tx2gene, <span class="at">ignoreAfterBar =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(txi.kallisto.tsv<span class="sc">$</span>counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                      Heart_ZT0_REP1 Heart_ZT0_REP2 Heart_ZT12_REP1
ENSMUSG00000000001.5               1              1               2
ENSMUSG00000000003.16              0              0               0
ENSMUSG00000000028.16              0              0               0
ENSMUSG00000000031.19              3              2               1
ENSMUSG00000000037.18              0              0               0
ENSMUSG00000000049.12              0              0               0
                      Heart_ZT12_REP2 Liver_ZT0_REP1 Liver_ZT0_REP2
ENSMUSG00000000001.5                0              0              1
ENSMUSG00000000003.16               0              0              0
ENSMUSG00000000028.16               0              0              0
ENSMUSG00000000031.19               1              0              0
ENSMUSG00000000037.18               0              0              0
ENSMUSG00000000049.12               0             37             20
                      Liver_ZT12_REP1 Liver_ZT12_REP2
ENSMUSG00000000001.5                0               0
ENSMUSG00000000003.16               0               0
ENSMUSG00000000028.16               0               0
ENSMUSG00000000031.19               0               0
ENSMUSG00000000037.18               0               0
ENSMUSG00000000049.12              31               9</code></pre>
</div>
</div>
<section id="function-to-add-gene-names-didnt-use-it-though" class="level3">
<h3 class="anchored" data-anchor-id="function-to-add-gene-names-didnt-use-it-though">Function to add gene names [Didnt use it though]</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>add_gene_name<span class="ot">&lt;-</span> <span class="cf">function</span>(res){</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  df<span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(res) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"gene_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">gene =</span> <span class="fu">transId</span>(gene_id, <span class="at">transTo =</span> <span class="st">"symbol"</span>, <span class="at">unique =</span> T, <span class="at">keepNA =</span> T)<span class="sc">$</span>symbol) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>(gene) <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(padj, <span class="fu">abs</span>(log2FoldChange))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="importing-the-counts-matrix" class="level3">
<h3 class="anchored" data-anchor-id="importing-the-counts-matrix">Importing the counts matrix</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#loading the length-scaled counts tsv file</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>cts <span class="ot">&lt;-</span> txi.kallisto.tsv<span class="sc">$</span>counts</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#converting NA into 0 and round off the counts</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>cts[<span class="fu">is.na</span>(cts)] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>cts <span class="ot">&lt;-</span> cts <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric, <span class="fu">list</span>(round)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"gene"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gene1 =</span> <span class="fu">transId</span>(gene, <span class="at">transTo =</span> <span class="st">"symbol"</span>, <span class="at">org =</span> <span class="st">"mouse"</span>, <span class="at">unique =</span> T, <span class="at">keepNA =</span> T)<span class="sc">$</span>symbol) <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gene) <span class="sc">%&gt;%</span> </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gene1, <span class="fu">everything</span>())</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>cts <span class="ot">&lt;-</span> cts <span class="sc">%&gt;%</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>gene1 <span class="sc">%in%</span> cts<span class="sc">$</span>gene1[<span class="fu">duplicated</span>(cts<span class="sc">$</span>gene1)]) <span class="sc">%&gt;%</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"gene1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="loading-the-metadata-file" class="level3">
<h3 class="anchored" data-anchor-id="loading-the-metadata-file">Loading the metadata file</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>coldata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sample =</span> <span class="fu">c</span>(<span class="st">"Liver_ZT0_REP1"</span>,<span class="st">"Liver_ZT0_REP2"</span>,<span class="st">"Liver_ZT12_REP1"</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Liver_ZT12_REP2"</span>,<span class="st">"Heart_ZT0_REP1"</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Heart_ZT0_REP2"</span>,<span class="st">"Heart_ZT12_REP1"</span>,<span class="st">"Heart_ZT12_REP2"</span>),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fastq_1 =</span> <span class="fu">c</span>(<span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT0_1_R1.fastq.gz"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT0_2_R1.fastq.gz"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT12_1_R1.fastq.gz"</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT12_2_R1.fastq.gz"</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT0_1_R1.fastq.gz"</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT0_2_R1.fastq.gz"</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT12_1_R1.fastq.gz"</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT12_2_R1.fastq.gz"</span>),</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fastq_2 =</span> <span class="fu">c</span>(<span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT0_1_R2.fastq.gz"</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT0_2_R2.fastq.gz"</span>,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT12_1_R2.fastq.gz"</span>,</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT12_2_R2.fastq.gz"</span>,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT0_1_R2.fastq.gz"</span>,</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT0_2_R2.fastq.gz"</span>,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT12_1_R2.fastq.gz"</span>,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT12_2_R2.fastq.gz"</span>),</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">strandedness =</span> <span class="fu">c</span>(<span class="st">"forward"</span>,</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"forward"</span>,<span class="st">"forward"</span>,<span class="st">"forward"</span>,<span class="st">"forward"</span>,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"forward"</span>,<span class="st">"forward"</span>,<span class="st">"forward"</span>),</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>                         <span class="at">time =</span> <span class="fu">c</span>(<span class="st">"T0"</span>,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"T0"</span>,<span class="st">"T12"</span>,<span class="st">"T12"</span>,<span class="st">"T0"</span>,<span class="st">"T0"</span>,<span class="st">"T12"</span>,<span class="st">"T12"</span>),</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tissue =</span> <span class="fu">c</span>(<span class="st">"Liver"</span>,</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Liver"</span>,<span class="st">"Liver"</span>,<span class="st">"Liver"</span>,<span class="st">"Heart"</span>,<span class="st">"Heart"</span>,</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Heart"</span>,<span class="st">"Heart"</span>)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>           )</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="co">#coldata &lt;- coldata %&gt;% filter(time %in% c("T0", "T12"))</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>coldata<span class="sc">$</span>time <span class="ot">&lt;-</span> <span class="fu">factor</span>(coldata<span class="sc">$</span>time, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"T0"</span>, <span class="st">"T12"</span>))</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>coldata<span class="sc">$</span>tissue <span class="ot">&lt;-</span> <span class="fu">factor</span>(coldata<span class="sc">$</span>tissue, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Heart"</span>, <span class="st">"Liver"</span>))</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Metadata file"</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Sample counts for tissue and timepoint combinations"</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>coldata <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="azrrwmpdpi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#azrrwmpdpi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#azrrwmpdpi thead, #azrrwmpdpi tbody, #azrrwmpdpi tfoot, #azrrwmpdpi tr, #azrrwmpdpi td, #azrrwmpdpi th {
  border-style: none;
}

#azrrwmpdpi p {
  margin: 0;
  padding: 0;
}

#azrrwmpdpi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#azrrwmpdpi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#azrrwmpdpi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#azrrwmpdpi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#azrrwmpdpi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#azrrwmpdpi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#azrrwmpdpi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#azrrwmpdpi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#azrrwmpdpi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#azrrwmpdpi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#azrrwmpdpi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#azrrwmpdpi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#azrrwmpdpi .gt_spanner_row {
  border-bottom-style: hidden;
}

#azrrwmpdpi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#azrrwmpdpi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#azrrwmpdpi .gt_from_md > :first-child {
  margin-top: 0;
}

#azrrwmpdpi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#azrrwmpdpi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#azrrwmpdpi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#azrrwmpdpi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#azrrwmpdpi .gt_row_group_first td {
  border-top-width: 2px;
}

#azrrwmpdpi .gt_row_group_first th {
  border-top-width: 2px;
}

#azrrwmpdpi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#azrrwmpdpi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#azrrwmpdpi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#azrrwmpdpi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#azrrwmpdpi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#azrrwmpdpi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#azrrwmpdpi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#azrrwmpdpi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#azrrwmpdpi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#azrrwmpdpi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#azrrwmpdpi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#azrrwmpdpi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#azrrwmpdpi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#azrrwmpdpi .gt_left {
  text-align: left;
}

#azrrwmpdpi .gt_center {
  text-align: center;
}

#azrrwmpdpi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#azrrwmpdpi .gt_font_normal {
  font-weight: normal;
}

#azrrwmpdpi .gt_font_bold {
  font-weight: bold;
}

#azrrwmpdpi .gt_font_italic {
  font-style: italic;
}

#azrrwmpdpi .gt_super {
  font-size: 65%;
}

#azrrwmpdpi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#azrrwmpdpi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#azrrwmpdpi .gt_indent_1 {
  text-indent: 5px;
}

#azrrwmpdpi .gt_indent_2 {
  text-indent: 10px;
}

#azrrwmpdpi .gt_indent_3 {
  text-indent: 15px;
}

#azrrwmpdpi .gt_indent_4 {
  text-indent: 20px;
}

#azrrwmpdpi .gt_indent_5 {
  text-indent: 25px;
}

#azrrwmpdpi .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#azrrwmpdpi div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="sample">sample</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="fastq_1">fastq_1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="fastq_2">fastq_2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="strandedness">strandedness</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="time">time</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="tissue">tissue</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sample" class="gt_row gt_left">Liver_ZT0_REP1</td>
<td headers="fastq_1" class="gt_row gt_left">/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT0_1_R1.fastq.gz</td>
<td headers="fastq_2" class="gt_row gt_left">/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT0_1_R2.fastq.gz</td>
<td headers="strandedness" class="gt_row gt_left">forward</td>
<td headers="time" class="gt_row gt_center">T0</td>
<td headers="tissue" class="gt_row gt_center">Liver</td></tr>
    <tr><td headers="sample" class="gt_row gt_left">Liver_ZT0_REP2</td>
<td headers="fastq_1" class="gt_row gt_left">/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT0_2_R1.fastq.gz</td>
<td headers="fastq_2" class="gt_row gt_left">/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT0_2_R2.fastq.gz</td>
<td headers="strandedness" class="gt_row gt_left">forward</td>
<td headers="time" class="gt_row gt_center">T0</td>
<td headers="tissue" class="gt_row gt_center">Liver</td></tr>
    <tr><td headers="sample" class="gt_row gt_left">Liver_ZT12_REP1</td>
<td headers="fastq_1" class="gt_row gt_left">/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT12_1_R1.fastq.gz</td>
<td headers="fastq_2" class="gt_row gt_left">/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT12_1_R2.fastq.gz</td>
<td headers="strandedness" class="gt_row gt_left">forward</td>
<td headers="time" class="gt_row gt_center">T12</td>
<td headers="tissue" class="gt_row gt_center">Liver</td></tr>
    <tr><td headers="sample" class="gt_row gt_left">Liver_ZT12_REP2</td>
<td headers="fastq_1" class="gt_row gt_left">/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT12_2_R1.fastq.gz</td>
<td headers="fastq_2" class="gt_row gt_left">/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT12_2_R2.fastq.gz</td>
<td headers="strandedness" class="gt_row gt_left">forward</td>
<td headers="time" class="gt_row gt_center">T12</td>
<td headers="tissue" class="gt_row gt_center">Liver</td></tr>
    <tr><td headers="sample" class="gt_row gt_left">Heart_ZT0_REP1</td>
<td headers="fastq_1" class="gt_row gt_left">/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT0_1_R1.fastq.gz</td>
<td headers="fastq_2" class="gt_row gt_left">/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT0_1_R2.fastq.gz</td>
<td headers="strandedness" class="gt_row gt_left">forward</td>
<td headers="time" class="gt_row gt_center">T0</td>
<td headers="tissue" class="gt_row gt_center">Heart</td></tr>
    <tr><td headers="sample" class="gt_row gt_left">Heart_ZT0_REP2</td>
<td headers="fastq_1" class="gt_row gt_left">/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT0_2_R1.fastq.gz</td>
<td headers="fastq_2" class="gt_row gt_left">/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT0_2_R2.fastq.gz</td>
<td headers="strandedness" class="gt_row gt_left">forward</td>
<td headers="time" class="gt_row gt_center">T0</td>
<td headers="tissue" class="gt_row gt_center">Heart</td></tr>
    <tr><td headers="sample" class="gt_row gt_left">Heart_ZT12_REP1</td>
<td headers="fastq_1" class="gt_row gt_left">/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT12_1_R1.fastq.gz</td>
<td headers="fastq_2" class="gt_row gt_left">/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT12_1_R2.fastq.gz</td>
<td headers="strandedness" class="gt_row gt_left">forward</td>
<td headers="time" class="gt_row gt_center">T12</td>
<td headers="tissue" class="gt_row gt_center">Heart</td></tr>
    <tr><td headers="sample" class="gt_row gt_left">Heart_ZT12_REP2</td>
<td headers="fastq_1" class="gt_row gt_left">/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT12_2_R1.fastq.gz</td>
<td headers="fastq_2" class="gt_row gt_left">/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT12_2_R2.fastq.gz</td>
<td headers="strandedness" class="gt_row gt_left">forward</td>
<td headers="time" class="gt_row gt_center">T12</td>
<td headers="tissue" class="gt_row gt_center">Heart</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>coldata <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">count</span>(tissue,time) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="ulsclwavem" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ulsclwavem table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ulsclwavem thead, #ulsclwavem tbody, #ulsclwavem tfoot, #ulsclwavem tr, #ulsclwavem td, #ulsclwavem th {
  border-style: none;
}

#ulsclwavem p {
  margin: 0;
  padding: 0;
}

#ulsclwavem .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ulsclwavem .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ulsclwavem .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ulsclwavem .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ulsclwavem .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ulsclwavem .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ulsclwavem .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ulsclwavem .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ulsclwavem .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ulsclwavem .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ulsclwavem .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ulsclwavem .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ulsclwavem .gt_spanner_row {
  border-bottom-style: hidden;
}

#ulsclwavem .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ulsclwavem .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ulsclwavem .gt_from_md > :first-child {
  margin-top: 0;
}

#ulsclwavem .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ulsclwavem .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ulsclwavem .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ulsclwavem .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ulsclwavem .gt_row_group_first td {
  border-top-width: 2px;
}

#ulsclwavem .gt_row_group_first th {
  border-top-width: 2px;
}

#ulsclwavem .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ulsclwavem .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ulsclwavem .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ulsclwavem .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ulsclwavem .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ulsclwavem .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ulsclwavem .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ulsclwavem .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ulsclwavem .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ulsclwavem .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ulsclwavem .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ulsclwavem .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ulsclwavem .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ulsclwavem .gt_left {
  text-align: left;
}

#ulsclwavem .gt_center {
  text-align: center;
}

#ulsclwavem .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ulsclwavem .gt_font_normal {
  font-weight: normal;
}

#ulsclwavem .gt_font_bold {
  font-weight: bold;
}

#ulsclwavem .gt_font_italic {
  font-style: italic;
}

#ulsclwavem .gt_super {
  font-size: 65%;
}

#ulsclwavem .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ulsclwavem .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ulsclwavem .gt_indent_1 {
  text-indent: 5px;
}

#ulsclwavem .gt_indent_2 {
  text-indent: 10px;
}

#ulsclwavem .gt_indent_3 {
  text-indent: 15px;
}

#ulsclwavem .gt_indent_4 {
  text-indent: 20px;
}

#ulsclwavem .gt_indent_5 {
  text-indent: 25px;
}

#ulsclwavem .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ulsclwavem div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="tissue">tissue</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="time">time</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="tissue" class="gt_row gt_center">Heart</td>
<td headers="time" class="gt_row gt_center">T0</td>
<td headers="n" class="gt_row gt_right">2</td></tr>
    <tr><td headers="tissue" class="gt_row gt_center">Heart</td>
<td headers="time" class="gt_row gt_center">T12</td>
<td headers="n" class="gt_row gt_right">2</td></tr>
    <tr><td headers="tissue" class="gt_row gt_center">Liver</td>
<td headers="time" class="gt_row gt_center">T0</td>
<td headers="n" class="gt_row gt_right">2</td></tr>
    <tr><td headers="tissue" class="gt_row gt_center">Liver</td>
<td headers="time" class="gt_row gt_center">T12</td>
<td headers="n" class="gt_row gt_right">2</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
</section>
<section id="creation-and-exploration-of-dds-object" class="level2">
<h2 class="anchored" data-anchor-id="creation-and-exploration-of-dds-object">Creation and exploration of dds object</h2>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#creation of dds object without prefiltering</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeqDataSetFromMatrix</span>(<span class="at">countData =</span> cts,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colData =</span> coldata,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">design =</span> <span class="sc">~</span> tissue) <span class="co">#paired design tissue + time if need to adjust for confounders (time in this case)</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>vd <span class="ot">&lt;-</span> <span class="fu">VisualizeDesign</span>(<span class="at">sampleData =</span> coldata,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">designFormula =</span> <span class="sc">~</span> tissue)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#print(vd$plotlist) #can visualize the model matrix and the various coefficients</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>dds<span class="sc">$</span>tissue <span class="ot">&lt;-</span> <span class="fu">relevel</span>(dds<span class="sc">$</span>tissue, <span class="at">ref =</span> <span class="st">"Heart"</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds) <span class="co">#Main effects for tissue #Expression affected by tissue not correcting for  the timepoint effects</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">results</span>(dds, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"tissue"</span>, <span class="st">"Heart"</span>, <span class="st">"Liver"</span>))</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>res <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(padj) <span class="sc">%&gt;%</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pvalue)) <span class="sc">+</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">bins =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"p-value histogram without prefiltering of counts"</span>)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>res <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"gene_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pvalue)) <span class="sc">%&gt;%</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pvalue_bin =</span> <span class="fu">if_else</span>(pvalue <span class="sc">&gt;</span> <span class="fl">0.75</span>, <span class="st">"high"</span>, <span class="st">"low"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pvalue_bin, <span class="at">y =</span> <span class="fu">log2</span>(baseMean))) <span class="sc">+</span> </span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_DEGanalysis_files/figure-html/Conversion%20to%20a%20DESeq%20object-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">p-value histogram without prefiltering of counts</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_DEGanalysis_files/figure-html/Conversion%20to%20a%20DESeq%20object-2.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Genes with high p-values do seem to have lower gene expression</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>p-value histogram distribution looks bimodal. High expressing count genes fall into low p-value bin which is great. Let’s look at the pattern after prefiltering of the counts.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> dds[<span class="fu">rowSums</span>(<span class="fu">counts</span>(dds) <span class="sc">&gt;</span> <span class="dv">10</span>,)] <span class="co">#opted out after the visualization</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#resultsNames(dds)</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">results</span>(dds, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"tissue"</span>, <span class="st">"Heart"</span>, <span class="st">"Liver"</span>)) <span class="co">#FALSE is Heart, Liver is TRUE and is in the denominator</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "p-value histogram after prefiltering of counts"</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Genes with high p-values do seem to have lower gene expression"</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>res <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(padj) <span class="sc">%&gt;%</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pvalue)) <span class="sc">+</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">bins =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"p-value histogram after prefiltering of counts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_DEGanalysis_files/figure-html/Prefiltering%20of%20counts%20using%20the%20dds%20object-1.png" class="img-fluid"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"gene_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pvalue)) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pvalue_bin =</span> <span class="fu">if_else</span>(pvalue <span class="sc">&gt;</span> <span class="fl">0.75</span>, <span class="st">"high"</span>, <span class="st">"low"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pvalue_bin, <span class="at">y =</span> <span class="fu">log2</span>(baseMean))) <span class="sc">+</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_DEGanalysis_files/figure-html/Prefiltering%20of%20counts%20using%20the%20dds%20object-2.png" class="img-fluid"></p>
</div>
</div>
<p>Various contrasts can be identified using <strong>resultNames(dds)</strong> function</p>
<p>The p-value histogram after prefiltering of counts is not looking good. Therefore, I haven’t done prefiltering. Supposedly, DESeq2 takes care of the low counts while identifying DEGs. Refer this link <a href="http://varianceexplained.org/statistics/interpreting-pvalue-histogram/" class="uri">http://varianceexplained.org/statistics/interpreting-pvalue-histogram/</a> for more info on p-value histograms and their interpretations.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#creation of dds object without prefiltering</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeqDataSetFromMatrix</span>(<span class="at">countData =</span> cts,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colData =</span> coldata,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">design =</span> <span class="sc">~</span> tissue) <span class="co">#paired design tissue + time if need to adjust for confounders (time in this case)</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="pca-plot" class="level3">
<h3 class="anchored" data-anchor-id="pca-plot">PCA plot</h3>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>vstcounts <span class="ot">&lt;-</span> <span class="fu">vst</span>(dds, <span class="at">blind =</span> T)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>normalized_cts <span class="ot">&lt;-</span> <span class="fu">assay</span>(vstcounts) <span class="sc">%&gt;%</span> <span class="fu">as.matrix</span>()</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>pca_prcomp <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(<span class="fu">t</span>(normalized_cts), <span class="at">center =</span> T, <span class="at">scale =</span> F)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#names(pca_prcomp)</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>PC1_and_PC2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">PC1 =</span> pca_prcomp<span class="sc">$</span>x[,<span class="dv">1</span>],</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">PC2 =</span> pca_prcomp<span class="sc">$</span>x[,<span class="dv">2</span>],</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">type =</span> <span class="fu">rownames</span>(pca_prcomp<span class="sc">$</span>x))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">#using the complete normalized matrix</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">#ggplot(PC1_and_PC2, aes(x = PC1, y = PC2, col=type)) +</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a> <span class="co"># geom_point() +</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_text(aes(label = type), hjust = 0, vjust = 0) +</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#coord_fixed()</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">#using variable features</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plotPCA</span>(vstcounts, <span class="at">intgroup =</span> <span class="fu">c</span>(<span class="st">"tissue"</span>,<span class="st">"time"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_DEGanalysis_files/figure-html/PCA%20plot-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">PCA when colored by tissue and timepoint</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>Tissue differences contribute to bulk of variance in PC1.</p>
</section>
<section id="sample-correlation-heatmap-using-vst-counts" class="level3">
<h3 class="anchored" data-anchor-id="sample-correlation-heatmap-using-vst-counts">Sample correlation heatmap using vst counts</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sampleCor <span class="ot">&lt;-</span> <span class="fu">cor</span>(normalized_cts)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>sampleDist <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">cor</span>(normalized_cts))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>sampleDistMatrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(sampleDist)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>blueColours <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="dv">9</span>, <span class="st">"Blues"</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">rev</span>(blueColours))(<span class="dv">255</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>annotation_row <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Group =</span> <span class="fu">str_before_first</span>(<span class="fu">colnames</span>(sampleDistMatrix), <span class="st">"_"</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(annotation_row) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(sampleDistMatrix)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="fu">pheatmap</span>(sampleDistMatrix,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">clustering_distance_cols =</span> sampleDist, </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> colors,</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fontsize_row =</span> <span class="dv">6</span>,</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fontsize_col =</span> <span class="dv">8</span>,</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">annotation_row =</span> annotation_row,</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">cutree_rows =</span> <span class="dv">4</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>                   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_DEGanalysis_files/figure-html/Sample%20correlation%20heatmap%20using%20vst%20counts-1.png" class="img-fluid"></p>
</div>
</div>
<p>All the timepoint and tissue replicates cluster in 4 groups corresponding to Liver, Heart and T0,12 combinations.</p>
</section>
</section>
<section id="differential-gene-expression-analysis" class="level2">
<h2 class="anchored" data-anchor-id="differential-gene-expression-analysis">Differential gene expression analysis</h2>
<section id="main-effects-due-to-tissue" class="level3">
<h3 class="anchored" data-anchor-id="main-effects-due-to-tissue">Main effects due to tissue</h3>
<p>Here, I am identifying tissue-specific (Heart versus Liver) DEGs. These DEGs would be Heart- or Liver-enriched.</p>
<section id="comparison-of-wald-versus-lrt-test-degs-main-effects-due-to-tissue" class="level4">
<h4 class="anchored" data-anchor-id="comparison-of-wald-versus-lrt-test-degs-main-effects-due-to-tissue">Comparison of Wald versus LRT test DEGs <a href="#main-effects-due-to-tissue">Main effects due to tissue</a></h4>
<p><strong>DEGs can be defined genes passing the threshold: abs(logFC) &gt; 1 &amp; padj &lt; 0.01</strong></p>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeqDataSetFromMatrix</span>(<span class="at">countData =</span> cts,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colData =</span> coldata,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">design =</span> <span class="sc">~</span> tissue) <span class="co">#not accounting for timepoint</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">results</span>(dds, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"tissue"</span>, <span class="st">"Heart"</span>, <span class="st">"Liver"</span>))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> res1 <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"gene"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(log2FoldChange,padj) <span class="sc">%&gt;%</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DEG =</span> <span class="fu">case_when</span>(log2FoldChange <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"up"</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                         log2FoldChange <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"down"</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>),</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">comparison =</span> <span class="st">"Heart_vs_Liver-Wald"</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">enrichment =</span> <span class="fu">case_when</span>(DEG <span class="sc">==</span> <span class="st">"up"</span> <span class="sc">~</span> <span class="st">"Heart"</span>,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>                                DEG <span class="sc">==</span> <span class="st">"down"</span> <span class="sc">~</span> <span class="st">"Liver"</span>,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>))</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co">#res1 &lt;- add_gene_name(res1)</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>res1 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">count</span>(comparison, enrichment) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co">#LRT test</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeqDataSetFromMatrix</span>(<span class="at">countData =</span> cts,</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colData =</span> coldata,</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>                              <span class="at">design =</span> <span class="sc">~</span> tissue <span class="sc">+</span> time) <span class="co">#accounting for timepoint in design</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds, <span class="at">test =</span> <span class="st">"LRT"</span>, <span class="at">full =</span> <span class="sc">~</span> tissue <span class="sc">+</span> time, <span class="at">reduced =</span> <span class="sc">~</span> time)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">results</span>(dds, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"tissue"</span>, <span class="st">"Heart"</span>, <span class="st">"Liver"</span>))</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> res2 <span class="sc">%&gt;%</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"gene"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(log2FoldChange,padj) <span class="sc">%&gt;%</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DEG =</span> <span class="fu">case_when</span>(log2FoldChange <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"up"</span>,</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>                         log2FoldChange <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"down"</span>,</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>),</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">comparison =</span> <span class="st">"Heart_vs_Liver-LRT"</span>,</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">enrichment =</span> <span class="fu">case_when</span>(DEG <span class="sc">==</span> <span class="st">"up"</span> <span class="sc">~</span> <span class="st">"Heart"</span>,</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>                                DEG <span class="sc">==</span> <span class="st">"down"</span> <span class="sc">~</span> <span class="st">"Liver"</span>,</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>)) </span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a><span class="co">#res2 &lt;- add_gene_name(res2)</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>res2 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">count</span>(comparison, enrichment) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">=</span> <span class="fu">rbind_common</span>(res1,res2)</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="co">#split(res3, f = list(res3$comparison, res3$enrichment))</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="co">#UpSetR::upset()</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a><span class="fu">plotVenn</span>(<span class="fu">map</span>(<span class="fu">split</span>(res3, <span class="at">f =</span> <span class="fu">list</span>(res3<span class="sc">$</span>comparison, res3<span class="sc">$</span>enrichment)), <span class="cf">function</span>(x) x <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene)),</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">use_venn =</span> F,</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">main_text_size =</span> <span class="dv">15</span>,</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend_text_size =</span> <span class="dv">8</span>,</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend_position =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">

<div id="tuaoyhwewd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tuaoyhwewd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tuaoyhwewd thead, #tuaoyhwewd tbody, #tuaoyhwewd tfoot, #tuaoyhwewd tr, #tuaoyhwewd td, #tuaoyhwewd th {
  border-style: none;
}

#tuaoyhwewd p {
  margin: 0;
  padding: 0;
}

#tuaoyhwewd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tuaoyhwewd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tuaoyhwewd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tuaoyhwewd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tuaoyhwewd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tuaoyhwewd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tuaoyhwewd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tuaoyhwewd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tuaoyhwewd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tuaoyhwewd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tuaoyhwewd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tuaoyhwewd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tuaoyhwewd .gt_spanner_row {
  border-bottom-style: hidden;
}

#tuaoyhwewd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tuaoyhwewd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tuaoyhwewd .gt_from_md > :first-child {
  margin-top: 0;
}

#tuaoyhwewd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tuaoyhwewd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tuaoyhwewd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tuaoyhwewd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tuaoyhwewd .gt_row_group_first td {
  border-top-width: 2px;
}

#tuaoyhwewd .gt_row_group_first th {
  border-top-width: 2px;
}

#tuaoyhwewd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tuaoyhwewd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tuaoyhwewd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tuaoyhwewd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tuaoyhwewd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tuaoyhwewd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tuaoyhwewd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tuaoyhwewd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tuaoyhwewd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tuaoyhwewd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tuaoyhwewd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tuaoyhwewd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tuaoyhwewd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tuaoyhwewd .gt_left {
  text-align: left;
}

#tuaoyhwewd .gt_center {
  text-align: center;
}

#tuaoyhwewd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tuaoyhwewd .gt_font_normal {
  font-weight: normal;
}

#tuaoyhwewd .gt_font_bold {
  font-weight: bold;
}

#tuaoyhwewd .gt_font_italic {
  font-style: italic;
}

#tuaoyhwewd .gt_super {
  font-size: 65%;
}

#tuaoyhwewd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tuaoyhwewd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tuaoyhwewd .gt_indent_1 {
  text-indent: 5px;
}

#tuaoyhwewd .gt_indent_2 {
  text-indent: 10px;
}

#tuaoyhwewd .gt_indent_3 {
  text-indent: 15px;
}

#tuaoyhwewd .gt_indent_4 {
  text-indent: 20px;
}

#tuaoyhwewd .gt_indent_5 {
  text-indent: 25px;
}

#tuaoyhwewd .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#tuaoyhwewd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="comparison">comparison</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="enrichment">enrichment</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="comparison" class="gt_row gt_left">Heart_vs_Liver-Wald</td>
<td headers="enrichment" class="gt_row gt_left">Heart</td>
<td headers="n" class="gt_row gt_right">832</td></tr>
    <tr><td headers="comparison" class="gt_row gt_left">Heart_vs_Liver-Wald</td>
<td headers="enrichment" class="gt_row gt_left">Liver</td>
<td headers="n" class="gt_row gt_right">985</td></tr>
    <tr><td headers="comparison" class="gt_row gt_left">Heart_vs_Liver-Wald</td>
<td headers="enrichment" class="gt_row gt_left">non-sig</td>
<td headers="n" class="gt_row gt_right">7178</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p>DEGs obtained with Wald test <a href="#main-effects-due-to-tissue">Main effects due to tissue</a></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">

<div id="xrcufpoccz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xrcufpoccz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xrcufpoccz thead, #xrcufpoccz tbody, #xrcufpoccz tfoot, #xrcufpoccz tr, #xrcufpoccz td, #xrcufpoccz th {
  border-style: none;
}

#xrcufpoccz p {
  margin: 0;
  padding: 0;
}

#xrcufpoccz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xrcufpoccz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xrcufpoccz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xrcufpoccz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xrcufpoccz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xrcufpoccz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xrcufpoccz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xrcufpoccz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xrcufpoccz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xrcufpoccz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xrcufpoccz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xrcufpoccz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xrcufpoccz .gt_spanner_row {
  border-bottom-style: hidden;
}

#xrcufpoccz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xrcufpoccz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xrcufpoccz .gt_from_md > :first-child {
  margin-top: 0;
}

#xrcufpoccz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xrcufpoccz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xrcufpoccz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xrcufpoccz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xrcufpoccz .gt_row_group_first td {
  border-top-width: 2px;
}

#xrcufpoccz .gt_row_group_first th {
  border-top-width: 2px;
}

#xrcufpoccz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xrcufpoccz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xrcufpoccz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xrcufpoccz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xrcufpoccz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xrcufpoccz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xrcufpoccz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xrcufpoccz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xrcufpoccz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xrcufpoccz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xrcufpoccz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xrcufpoccz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xrcufpoccz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xrcufpoccz .gt_left {
  text-align: left;
}

#xrcufpoccz .gt_center {
  text-align: center;
}

#xrcufpoccz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xrcufpoccz .gt_font_normal {
  font-weight: normal;
}

#xrcufpoccz .gt_font_bold {
  font-weight: bold;
}

#xrcufpoccz .gt_font_italic {
  font-style: italic;
}

#xrcufpoccz .gt_super {
  font-size: 65%;
}

#xrcufpoccz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xrcufpoccz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xrcufpoccz .gt_indent_1 {
  text-indent: 5px;
}

#xrcufpoccz .gt_indent_2 {
  text-indent: 10px;
}

#xrcufpoccz .gt_indent_3 {
  text-indent: 15px;
}

#xrcufpoccz .gt_indent_4 {
  text-indent: 20px;
}

#xrcufpoccz .gt_indent_5 {
  text-indent: 25px;
}

#xrcufpoccz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xrcufpoccz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="comparison">comparison</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="enrichment">enrichment</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="comparison" class="gt_row gt_left">Heart_vs_Liver-LRT</td>
<td headers="enrichment" class="gt_row gt_left">Heart</td>
<td headers="n" class="gt_row gt_right">768</td></tr>
    <tr><td headers="comparison" class="gt_row gt_left">Heart_vs_Liver-LRT</td>
<td headers="enrichment" class="gt_row gt_left">Liver</td>
<td headers="n" class="gt_row gt_right">935</td></tr>
    <tr><td headers="comparison" class="gt_row gt_left">Heart_vs_Liver-LRT</td>
<td headers="enrichment" class="gt_row gt_left">non-sig</td>
<td headers="n" class="gt_row gt_right">6931</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p>DEGs obtained with Wald test <a href="#main-effects-due-to-tissue">Main effects due to tissue</a></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_DEGanalysis_files/figure-html/Comparison%20of%20Wald%20test%20and%20LRT%20-%20tissue-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">DEGs obtained with Wald test <a href="#main-effects-due-to-tissue">Main effects due to tissue</a></figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>DEGs with and without accounting for timepoint yields similar DEGs between Wald and LRT tests suggesting that both designs are okay to detect main effects due to tissue.</p>
</section>
<section id="visualization-of-tissue-specific-degs-using-deseq2" class="level4">
<h4 class="anchored" data-anchor-id="visualization-of-tissue-specific-degs-using-deseq2">Visualization of tissue-specific DEGs using DESeq2</h4>
<p>I am going with res1 object that uses Wald test to identify main effects due to tissue.</p>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Volcano plot</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>EnhancedVolcano<span class="sc">::</span><span class="fu">EnhancedVolcano</span>(res1,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">x =</span> <span class="st">"log2FoldChange"</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y =</span> <span class="st">"padj"</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">lab =</span> res1<span class="sc">$</span>gene,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">pCutoff =</span> <span class="fl">0.01</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">FCcutoff =</span> <span class="dv">1</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">title =</span> <span class="st">"Heart vs Liver comparison [Single-factor design]"</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">subtitle =</span> <span class="st">"Differential expression analysis using DESeq2"</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">labSize =</span> <span class="fl">2.0</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>                                 )</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">#test this code</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(<span class="fu">counts</span>(dds[res1<span class="sc">$</span>gene[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], ], <span class="at">normalize =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">rownames =</span> <span class="st">'gene'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">"sample"</span>, <span class="at">values_to =</span> <span class="st">"counts"</span>, <span class="sc">-</span>gene) <span class="sc">%&gt;%</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">as_tibble</span>(<span class="fu">colData</span>(dds), <span class="at">rownames =</span> <span class="st">"group"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(name = paste0(substr(Type, 1, 5), '_', Condition, '_', 1:3)) %&gt;%</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> counts, <span class="at">fill =</span> tissue)) <span class="sc">+</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>, <span class="at">color =</span> <span class="st">"gray30"</span>) <span class="sc">+</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> gene, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_DEGanalysis_files/figure-html/Identification%20of%20tissue-specific%20DEGs-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Number of identified DEGs (|logFC| &gt; 1 &amp; padj &lt; 0.01)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_DEGanalysis_files/figure-html/Identification%20of%20tissue-specific%20DEGs-2.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Tissue-specific DEGs agnostic of the sampling timepoint</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>The tissue based DEGs do not have specific pattern because enrichment can be at any tissue and timepoint combination</p>
</section>
<section id="expression-pattern-of-top-tissue-specific-degs" class="level4">
<h4 class="anchored" data-anchor-id="expression-pattern-of-top-tissue-specific-degs">Expression pattern of top tissue-specific DEGs</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>significant_genes <span class="ot">&lt;-</span> res1 <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.01</span>, <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="fu">abs</span>(log2FoldChange), <span class="at">n =</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(gene)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>sig_mat <span class="ot">&lt;-</span> normalized_cts[significant_genes,]</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>col_anno <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">df =</span> coldata <span class="sc">%&gt;%</span> <span class="fu">select</span>(tissue, time),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">col =</span> <span class="fu">list</span>(<span class="at">tissue =</span> <span class="fu">c</span>(<span class="st">"Liver"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Heart"</span> <span class="ot">=</span> <span class="st">"blue"</span>)))</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Heatmap of top 50 DEGs sorted by |logFC| (|logFC| &gt; 1 &amp; padj &lt; 0.01)"</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Boxplot of top 12 DEGs"</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="fu">Heatmap</span>(<span class="fu">t</span>(<span class="fu">scale</span>(<span class="fu">t</span>(sig_mat))),</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">top_annotation =</span> col_anno,</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">show_row_names =</span> T,</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">cluster_rows =</span> T,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">cluster_columns =</span> F,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">row_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">6</span>),</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">column_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">7</span>),</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">"Scaled normalized</span><span class="sc">\n</span><span class="st">expression"</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_DEGanalysis_files/figure-html/Expression%20pattern%20of%20top%20tissue-specific%20DEGs-1.png" class="img-fluid"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>significant_genes <span class="ot">&lt;-</span> res1 <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.01</span>, <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="fu">abs</span>(log2FoldChange), <span class="at">n =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(gene)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>boxplot_1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(significant_genes, <span class="cf">function</span>(x) {</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotCounts</span>(dds, <span class="at">gene =</span> x,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">intgroup =</span> <span class="fu">c</span>(<span class="st">"tissue"</span>,<span class="st">"time"</span>),</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">returnData =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">paste</span>(tissue,time), <span class="at">y =</span> <span class="fu">log2</span>(count), <span class="at">fill =</span> tissue)) <span class="sc">+</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Experimental group"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Normalized counts"</span>) <span class="sc">+</span> </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(x))</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="fu">wrap_plots</span>(boxplot_1, <span class="at">ncol =</span> <span class="dv">3</span>)                             </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_DEGanalysis_files/figure-html/Expression%20pattern%20of%20top%20tissue-specific%20DEGs-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="pathway-analysis-using-the-tissue-specific-degs-main-effects-using-ora" class="level4">
<h4 class="anchored" data-anchor-id="pathway-analysis-using-the-tissue-specific-degs-main-effects-using-ora">Pathway analysis using the tissue-specific DEGs (Main effects) using ORA</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># perform pathway analysis using multiple pathway genesets</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>msigdb_gs <span class="ot">&lt;-</span> geneset<span class="sc">::</span><span class="fu">getMsigdb</span>(<span class="at">org =</span> <span class="st">"mouse"</span>, <span class="at">category =</span> <span class="st">"H"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>go_gs <span class="ot">&lt;-</span> geneset<span class="sc">::</span><span class="fu">getGO</span>(<span class="at">org =</span> <span class="st">"mouse"</span>, <span class="at">ont =</span> <span class="st">"bp"</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>kegg_gs <span class="ot">&lt;-</span> geneset<span class="sc">::</span><span class="fu">getKEGG</span>(<span class="at">org =</span> <span class="st">"mus"</span>, <span class="at">category =</span> <span class="st">"pathway"</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>react_gs <span class="ot">&lt;-</span> geneset<span class="sc">::</span><span class="fu">getReactome</span>(<span class="at">org =</span> <span class="st">"mouse"</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>gene_set <span class="ot">=</span> <span class="fu">list</span>(msigdb_gs, go_gs, kegg_gs, react_gs)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">#empty lists for adding in the pathway results</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>barplots_1 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gene_set)) {</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  go_results1 <span class="ot">=</span> <span class="fu">safely</span>(genORA)(res1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(enrichment <span class="sc">==</span> <span class="st">"Heart"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene),</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>                               <span class="at">geneset =</span> gene_set[[i]],</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>                               <span class="at">p_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>                               <span class="at">q_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>                               <span class="at">universe =</span> <span class="fu">rownames</span>(res1))<span class="sc">$</span>result</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results1)) {</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    go_results1<span class="sc">$</span>geneset <span class="ot">=</span> gene_set[[i]]<span class="sc">$</span>type</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    go_results1<span class="sc">$</span>enrichment <span class="ot">=</span> <span class="st">"Heart"</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>  go_results2 <span class="ot">=</span> <span class="fu">safely</span>(genORA)(res1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(enrichment <span class="sc">==</span> <span class="st">"Liver"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene),</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>                               <span class="at">geneset =</span> gene_set[[i]],</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>                               <span class="at">p_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>                               <span class="at">q_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>                               <span class="at">universe =</span> <span class="fu">rownames</span>(res1))<span class="sc">$</span>result</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results2)) {</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>    go_results2<span class="sc">$</span>geneset <span class="ot">=</span> gene_set[[i]]<span class="sc">$</span>type</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    go_results2<span class="sc">$</span>enrichment <span class="ot">=</span> <span class="st">"Liver"</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>  df1 <span class="ot">&lt;-</span> <span class="fu">rbind_common</span>(df1, go_results1, go_results2)</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(go_results2)) {</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">plotEnrich</span>(go_results1,</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot_type =</span> <span class="st">"bar"</span>,</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n_term =</span> <span class="dv">10</span>,</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>                   <span class="at">term_metric =</span> <span class="st">"FoldEnrich"</span>,</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stats_metric =</span> <span class="st">"qvalue"</span>)</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">plotEnrich</span>(go_results2,</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot_type =</span> <span class="st">"bar"</span>,</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n_term =</span> <span class="dv">10</span>,</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>                   <span class="at">term_metric =</span> <span class="st">"FoldEnrich"</span>,</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stats_metric =</span> <span class="st">"qvalue"</span>)</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>  barplots_1[[i]] <span class="ot">&lt;-</span> p1 <span class="sc">+</span> p2</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Pathway profile across multiple databases and tissue conditions"</span></span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(df1)) {df1 <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="sc">%&gt;%</span> <span class="fu">gt_preview</span>(<span class="at">top_n =</span> <span class="dv">10</span>)}</span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(df1)) {</span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tidyheatmap</span>(<span class="at">df =</span> df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p.adjust <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">p.adjust =</span> <span class="sc">-</span><span class="fu">log10</span>(p.adjust)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(geneset) <span class="sc">%&gt;%</span> <span class="fu">remove_rownames</span>(), <span class="at">color_legend_n =</span> <span class="dv">1</span>, <span class="at">color_legend_min =</span> <span class="dv">0</span>, <span class="at">color_legend_max =</span> <span class="fl">1.3</span>,<span class="at">rows =</span> Description, <span class="at">columns =</span> enrichment, <span class="at">values =</span> p.adjust, <span class="at">annotation_row =</span> geneset, <span class="at">gaps_row =</span> geneset, <span class="at">gaps_col =</span> enrichment</span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>None of the tissue-enriched DEGs fall into significant pathways across multiple pathway databases (KEGG, GO-BP, MSigDB hallmark and Reactome) when using ORA approach along with the universe argument</strong></p>
<p>Let’s see if change of approach from ORA to GSEA lead to better results.</p>
<p>ORA method is easy to conduct, but it will lose information when genes’ differences are slight. For example, if a gene is essential in some pathway but is low-expressed, it will be filtered by fold change cutoff. Unlike ORA, FCS tools do not set a threshold for differentially expressed genes. Instead, it gives each detected gene a differential expression score and then evaluates whether the scores are more positive or negative than expected by chance for each gene set.</p>
</section>
<section id="pathway-analysis-using-the-tissue-specific-degs-main-effects-using-gsea" class="level4">
<h4 class="anchored" data-anchor-id="pathway-analysis-using-the-tissue-specific-degs-main-effects-using-gsea">Pathway analysis using the tissue-specific DEGs (Main effects) using GSEA</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>rankedGenes <span class="ot">&lt;-</span> res1 <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(gene, padj, log2FoldChange) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="sc">-</span><span class="fu">log10</span>(pvalue) <span class="sc">*</span> <span class="fu">sign</span>(log2FoldChange),</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">entrez =</span> <span class="fu">transId</span>(gene, <span class="at">transTo =</span> <span class="st">"entrez"</span>, <span class="at">keepNA =</span> T, <span class="at">unique =</span> T, <span class="at">org =</span> <span class="st">"mouse"</span>)<span class="sc">$</span>entrezid) <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(rank) <span class="sc">&amp;</span> <span class="fu">is.finite</span>(rank)) <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(rank)) <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(rank, gene)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">#head(rankedGenes)</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>barplots_1 <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gene_set)) {</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  gsea_results1 <span class="ot">=</span> <span class="fu">safely</span>(genGSEA)(<span class="at">genelist =</span> rankedGenes,</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">p_cutoff =</span> <span class="dv">1</span>,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">q_cutoff =</span> <span class="dv">1</span>,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>                                <span class="at">geneset =</span> gene_set[[i]])<span class="sc">$</span>result</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(gsea_results1<span class="sc">$</span>gsea_df)) {</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    barplots_1[[i]] <span class="ot">&lt;-</span> <span class="fu">plotGSEA</span>(gsea_results1, <span class="at">plot_type =</span> <span class="st">"bar"</span>, <span class="at">colour =</span> <span class="fu">c</span>(<span class="st">"navyblue"</span>, <span class="st">"orange"</span>))</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    df1 <span class="ot">=</span> <span class="fu">rbind_common</span>(df1, gsea_results1<span class="sc">$</span>gsea_df <span class="sc">%&gt;%</span> </span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">mutate</span>(<span class="at">enrichment =</span> <span class="fu">ifelse</span>(NES <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"Heart"</span>, <span class="st">"Liver"</span>),</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>                                <span class="at">geneset =</span> gene_set[[i]]<span class="sc">$</span>type))</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_DEGanalysis_files/figure-html/GSEA%20approach%20using%20the%20res1%20output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="02_DEGanalysis_files/figure-html/GSEA%20approach%20using%20the%20res1%20output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="02_DEGanalysis_files/figure-html/GSEA%20approach%20using%20the%20res1%20output-3.png" class="img-fluid"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Pathway table across multiple databases and tissue conditions"</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Signficant pathways (p.adjust &lt; 0.05) identified using GSEA using multiple databases"</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(df1)) {df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p.adjust <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> <span class="fu">gt_preview</span>(<span class="at">top_n =</span> <span class="dv">10</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="mmpfritier" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mmpfritier table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mmpfritier thead, #mmpfritier tbody, #mmpfritier tfoot, #mmpfritier tr, #mmpfritier td, #mmpfritier th {
  border-style: none;
}

#mmpfritier p {
  margin: 0;
  padding: 0;
}

#mmpfritier .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mmpfritier .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mmpfritier .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mmpfritier .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mmpfritier .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mmpfritier .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mmpfritier .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mmpfritier .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mmpfritier .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mmpfritier .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mmpfritier .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mmpfritier .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mmpfritier .gt_spanner_row {
  border-bottom-style: hidden;
}

#mmpfritier .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mmpfritier .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mmpfritier .gt_from_md > :first-child {
  margin-top: 0;
}

#mmpfritier .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mmpfritier .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mmpfritier .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mmpfritier .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mmpfritier .gt_row_group_first td {
  border-top-width: 2px;
}

#mmpfritier .gt_row_group_first th {
  border-top-width: 2px;
}

#mmpfritier .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mmpfritier .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mmpfritier .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mmpfritier .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mmpfritier .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mmpfritier .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mmpfritier .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mmpfritier .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mmpfritier .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mmpfritier .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mmpfritier .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mmpfritier .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mmpfritier .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mmpfritier .gt_left {
  text-align: left;
}

#mmpfritier .gt_center {
  text-align: center;
}

#mmpfritier .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mmpfritier .gt_font_normal {
  font-weight: normal;
}

#mmpfritier .gt_font_bold {
  font-weight: bold;
}

#mmpfritier .gt_font_italic {
  font-style: italic;
}

#mmpfritier .gt_super {
  font-size: 65%;
}

#mmpfritier .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mmpfritier .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mmpfritier .gt_indent_1 {
  text-indent: 5px;
}

#mmpfritier .gt_indent_2 {
  text-indent: 10px;
}

#mmpfritier .gt_indent_3 {
  text-indent: 15px;
}

#mmpfritier .gt_indent_4 {
  text-indent: 20px;
}

#mmpfritier .gt_indent_5 {
  text-indent: 25px;
}

#mmpfritier .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mmpfritier div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Description">Description</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="setSize">setSize</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="enrichmentScore">enrichmentScore</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="NES">NES</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="pvalue">pvalue</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.adjust">p.adjust</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="qvalue">qvalue</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rank">rank</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="leading_edge">leading_edge</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="geneID">geneID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Count">Count</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="enrichment">enrichment</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="geneset">geneset</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><th id="stub_1_1" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">1</th>
<td headers="stub_1_1 Description" class="gt_row gt_left">HALLMARK_MYOGENESIS</td>
<td headers="stub_1_1 setSize" class="gt_row gt_right">130</td>
<td headers="stub_1_1 enrichmentScore" class="gt_row gt_right">-0.7246889</td>
<td headers="stub_1_1 NES" class="gt_row gt_right">-2.043943</td>
<td headers="stub_1_1 pvalue" class="gt_row gt_right">5.550645e-07</td>
<td headers="stub_1_1 p.adjust" class="gt_row gt_right">2.775322e-05</td>
<td headers="stub_1_1 qvalue" class="gt_row gt_right">2.395541e-05</td>
<td headers="stub_1_1 rank" class="gt_row gt_right">976</td>
<td headers="stub_1_1 leading_edge" class="gt_row gt_left">tags=40%, list=11%, signal=37%</td>
<td headers="stub_1_1 geneID" class="gt_row gt_left">16773/18767/30953/12865/16651/29856/20692/19245/20856/80888/18642/13400/225115/22084/14081/12908/102857/13682/12862/11790/12491/19309/20411/12827/226251/13009/11459/11636/24131/13808/17930/227753/17929/16412/21393/76722/21924/13346/11472/17868/12715/12373/12955/17897/14077/50795/15464/11464/83679/17906/17189/140781/21956</td>
<td headers="stub_1_1 Count" class="gt_row gt_right">53</td>
<td headers="stub_1_1 enrichment" class="gt_row gt_left">Liver</td>
<td headers="stub_1_1 geneset" class="gt_row gt_left">msigdb</td></tr>
    <tr><th id="stub_1_2" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">2</th>
<td headers="stub_1_2 Description" class="gt_row gt_left">HALLMARK_MYC_TARGETS_V1</td>
<td headers="stub_1_2 setSize" class="gt_row gt_right">139</td>
<td headers="stub_1_2 enrichmentScore" class="gt_row gt_right">0.7028628</td>
<td headers="stub_1_2 NES" class="gt_row gt_right">1.807241</td>
<td headers="stub_1_2 pvalue" class="gt_row gt_right">3.540165e-04</td>
<td headers="stub_1_2 p.adjust" class="gt_row gt_right">8.850413e-03</td>
<td headers="stub_1_2 qvalue" class="gt_row gt_right">7.639304e-03</td>
<td headers="stub_1_2 rank" class="gt_row gt_right">8</td>
<td headers="stub_1_2 leading_edge" class="gt_row gt_left">tags=2%, list=0%, signal=2%</td>
<td headers="stub_1_2 geneID" class="gt_row gt_left">21454/230908/12567</td>
<td headers="stub_1_2 Count" class="gt_row gt_right">3</td>
<td headers="stub_1_2 enrichment" class="gt_row gt_left">Heart</td>
<td headers="stub_1_2 geneset" class="gt_row gt_left">msigdb</td></tr>
    <tr><th id="stub_1_3" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">3</th>
<td headers="stub_1_3 Description" class="gt_row gt_left">HALLMARK_COAGULATION</td>
<td headers="stub_1_3 setSize" class="gt_row gt_right">82</td>
<td headers="stub_1_3 enrichmentScore" class="gt_row gt_right">0.7367274</td>
<td headers="stub_1_3 NES" class="gt_row gt_right">1.760430</td>
<td headers="stub_1_3 pvalue" class="gt_row gt_right">1.038372e-03</td>
<td headers="stub_1_3 p.adjust" class="gt_row gt_right">1.550662e-02</td>
<td headers="stub_1_3 qvalue" class="gt_row gt_right">1.338466e-02</td>
<td headers="stub_1_3 rank" class="gt_row gt_right">796</td>
<td headers="stub_1_3 leading_edge" class="gt_row gt_left">tags=43%, list=9%, signal=39%</td>
<td headers="stub_1_3 geneID" class="gt_row gt_left">22041/12266/11806/20704/14161/99571/20701/19353/11812/18815/15360/14061/14268/14060/94175/230558/229445/14058/93721/12759/11814/12630/66901/17195/16424/15378/19733/110382/11727/19123/56373/13039/11813/58992/71753</td>
<td headers="stub_1_3 Count" class="gt_row gt_right">35</td>
<td headers="stub_1_3 enrichment" class="gt_row gt_left">Heart</td>
<td headers="stub_1_3 geneset" class="gt_row gt_left">msigdb</td></tr>
    <tr><th id="stub_1_4" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">4</th>
<td headers="stub_1_4 Description" class="gt_row gt_left">HALLMARK_OXIDATIVE_PHOSPHORYLATION</td>
<td headers="stub_1_4 setSize" class="gt_row gt_right">172</td>
<td headers="stub_1_4 enrichmentScore" class="gt_row gt_right">-0.5527898</td>
<td headers="stub_1_4 NES" class="gt_row gt_right">-1.609473</td>
<td headers="stub_1_4 pvalue" class="gt_row gt_right">1.240530e-03</td>
<td headers="stub_1_4 p.adjust" class="gt_row gt_right">1.550662e-02</td>
<td headers="stub_1_4 qvalue" class="gt_row gt_right">1.338466e-02</td>
<td headers="stub_1_4 rank" class="gt_row gt_right">1657</td>
<td headers="stub_1_4 leading_edge" class="gt_row gt_left">tags=45%, list=18%, signal=37%</td>
<td headers="stub_1_4 geneID" class="gt_row gt_left">67680/68375/59040/66445/69597/13177/67530/12864/69046/67003/27402/407785/14751/11370/214952/57423/625249/74143/76614/381511/66447/22273/27425/68349/66694/12867/17995/17448/11958/78830/66576/12858/12857/110323/68263/67460/13063/71679/11951/110842/67834/67863/20916/110826/11949/78920/15526/17449/68202/226646/66108/235339/11950/66841/12974/18674/67264/227197/170731/228033/66865/170718/13382/269951/18597/97212/22333/27273/51798/231086/18293/16832/11364/11946/66945/11947/11739/11429</td>
<td headers="stub_1_4 Count" class="gt_row gt_right">78</td>
<td headers="stub_1_4 enrichment" class="gt_row gt_left">Liver</td>
<td headers="stub_1_4 geneset" class="gt_row gt_left">msigdb</td></tr>
    <tr><th id="stub_1_5" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">5</th>
<td headers="stub_1_5 Description" class="gt_row gt_left">muscle structure development</td>
<td headers="stub_1_5 setSize" class="gt_row gt_right">342</td>
<td headers="stub_1_5 enrichmentScore" class="gt_row gt_right">-0.5905837</td>
<td headers="stub_1_5 NES" class="gt_row gt_right">-1.858266</td>
<td headers="stub_1_5 pvalue" class="gt_row gt_right">9.320537e-08</td>
<td headers="stub_1_5 p.adjust" class="gt_row gt_right">4.043249e-04</td>
<td headers="stub_1_5 qvalue" class="gt_row gt_right">3.772365e-04</td>
<td headers="stub_1_5 rank" class="gt_row gt_right">1296</td>
<td headers="stub_1_5 leading_edge" class="gt_row gt_left">tags=35%, list=14%, signal=31%</td>
<td headers="stub_1_5 geneID" class="gt_row gt_left">Flot1/Ddx39b/Mbnl1/Irx3/Smarcd1/Dmd/Spag9/Epc1/Adamts5/Adra1a/Hnrnpu/Gata6/Hif1an/Vegfa/Syne1/Heg1/Mkx/Sgcb/Rcan1/Ctnnb1/Chkb/Hopx/Sox4/Arid1a/Cav1/Lama2/Akap6/Cavin4/Fbxo40/Prkar1a/Gpcpd1/Gsk3a/Sorbs2/Akt1/Gpc1/Bvht/Dag1/Myh14/Akap13/Brd7/Lamb1/Cdh2/Norad/Dmpk/Svil/Lamc1/Epas1/Ybx3/Alpk2/Nr2c2/Qki/Sod2/Dysf/Pgm5/Igfbp5/Smyd1/Cntnap1/Pdlim5/Asb2/Hand2/Neo1/Rbm24/Egln1/Hdgfl2/Speg/Mfn2/Neurl2/Slc8a1/Lamb2/Csrp3/Plec/Rbm38/Popdc2/Acta1/Fhod3/Gja1/Trim72/Fhl2/Ankrd23/Yy1/Lmod3/Ldb3/Med1/Unc45b/Myom2/Tgfb2/Mylk3/Myoz2/Nmrk2/Itgb1/Acadm/Flnc/Tcap/Myo18b/Tnnc1/Des/Actn2/Xirp2/Ankrd1/Mir208b/Mybpc3/Casq2/Cryab/Ryr2/Slc25a4/Jph2/Lmod2/Dsp/Myl3/Ybx1/Ttn/Tnni3/Actc1/Myl2/Tpm1/Myh7/Tnnt2/Myh6/Atp2a2</td>
<td headers="stub_1_5 Count" class="gt_row gt_right">119</td>
<td headers="stub_1_5 enrichment" class="gt_row gt_left">Liver</td>
<td headers="stub_1_5 geneset" class="gt_row gt_left">bp</td></tr>
    <tr><th id="stub_1_6" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">6</th>
<td headers="stub_1_6 Description" class="gt_row gt_left">myofibril assembly</td>
<td headers="stub_1_6 setSize" class="gt_row gt_right">47</td>
<td headers="stub_1_6 enrichmentScore" class="gt_row gt_right">-0.8524028</td>
<td headers="stub_1_6 NES" class="gt_row gt_right">-2.102457</td>
<td headers="stub_1_6 pvalue" class="gt_row gt_right">1.013772e-06</td>
<td headers="stub_1_6 p.adjust" class="gt_row gt_right">7.785641e-04</td>
<td headers="stub_1_6 qvalue" class="gt_row gt_right">7.264029e-04</td>
<td headers="stub_1_6 rank" class="gt_row gt_right">449</td>
<td headers="stub_1_6 leading_edge" class="gt_row gt_left">tags=55%, list=5%, signal=53%</td>
<td headers="stub_1_6 geneID" class="gt_row gt_left">Mfn2/Neurl2/Csrp3/Plec/Acta1/Fhod3/Ankrd23/Lmod3/Ldb3/Myom2/Mylk3/Myoz2/Itgb1/Flnc/Tcap/Actn2/Mybpc3/Casq2/Lmod2/Ttn/Actc1/Myl2/Tpm1/Myh7/Tnnt2/Myh6</td>
<td headers="stub_1_6 Count" class="gt_row gt_right">26</td>
<td headers="stub_1_6 enrichment" class="gt_row gt_left">Liver</td>
<td headers="stub_1_6 geneset" class="gt_row gt_left">bp</td></tr>
    <tr><th id="stub_1_7" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">7</th>
<td headers="stub_1_7 Description" class="gt_row gt_left">striated muscle cell development</td>
<td headers="stub_1_7 setSize" class="gt_row gt_right">47</td>
<td headers="stub_1_7 enrichmentScore" class="gt_row gt_right">-0.8524028</td>
<td headers="stub_1_7 NES" class="gt_row gt_right">-2.102457</td>
<td headers="stub_1_7 pvalue" class="gt_row gt_right">1.013772e-06</td>
<td headers="stub_1_7 p.adjust" class="gt_row gt_right">7.785641e-04</td>
<td headers="stub_1_7 qvalue" class="gt_row gt_right">7.264029e-04</td>
<td headers="stub_1_7 rank" class="gt_row gt_right">449</td>
<td headers="stub_1_7 leading_edge" class="gt_row gt_left">tags=55%, list=5%, signal=53%</td>
<td headers="stub_1_7 geneID" class="gt_row gt_left">Mfn2/Neurl2/Csrp3/Plec/Acta1/Fhod3/Ankrd23/Lmod3/Ldb3/Myom2/Mylk3/Myoz2/Itgb1/Flnc/Tcap/Actn2/Mybpc3/Casq2/Lmod2/Ttn/Actc1/Myl2/Tpm1/Myh7/Tnnt2/Myh6</td>
<td headers="stub_1_7 Count" class="gt_row gt_right">26</td>
<td headers="stub_1_7 enrichment" class="gt_row gt_left">Liver</td>
<td headers="stub_1_7 geneset" class="gt_row gt_left">bp</td></tr>
    <tr><th id="stub_1_8" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">8</th>
<td headers="stub_1_8 Description" class="gt_row gt_left">regulation of muscle system process</td>
<td headers="stub_1_8 setSize" class="gt_row gt_right">129</td>
<td headers="stub_1_8 enrichmentScore" class="gt_row gt_right">-0.7144316</td>
<td headers="stub_1_8 NES" class="gt_row gt_right">-2.033616</td>
<td headers="stub_1_8 pvalue" class="gt_row gt_right">6.853786e-07</td>
<td headers="stub_1_8 p.adjust" class="gt_row gt_right">7.785641e-04</td>
<td headers="stub_1_8 qvalue" class="gt_row gt_right">7.264029e-04</td>
<td headers="stub_1_8 rank" class="gt_row gt_right">1046</td>
<td headers="stub_1_8 leading_edge" class="gt_row gt_left">tags=34%, list=12%, signal=31%</td>
<td headers="stub_1_8 geneID" class="gt_row gt_left">Fbxo32/Atp1a1/Flt1/Akap1/Tmem38a/Cav1/Atp2b1/Nppa/Akap6/Pde4d/Rock2/Gsk3a/Smtn/Cacna2d1/Dmpk/Ghrl/Ccn2/Igfbp5/Ucn/Hand2/Ucn/Trim63/Slc8a1/Abcc8/Atp1a2/Yy1/Cacna1c/Srl/Pln/Ptgs2/Tnnc1/Scn5a/Cmya5/Casq2/Ryr2/Slc25a4/Dsp/Myl3/Ttn/Tnni3/Hrc/Myh7/Tnnt2/Atp2a2/Ptgs1</td>
<td headers="stub_1_8 Count" class="gt_row gt_right">45</td>
<td headers="stub_1_8 enrichment" class="gt_row gt_left">Liver</td>
<td headers="stub_1_8 geneset" class="gt_row gt_left">bp</td></tr>
    <tr><th id="stub_1_9" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">9</th>
<td headers="stub_1_9 Description" class="gt_row gt_left">muscle contraction</td>
<td headers="stub_1_9 setSize" class="gt_row gt_right">147</td>
<td headers="stub_1_9 enrichmentScore" class="gt_row gt_right">-0.6889268</td>
<td headers="stub_1_9 NES" class="gt_row gt_right">-1.999562</td>
<td headers="stub_1_9 pvalue" class="gt_row gt_right">5.403549e-07</td>
<td headers="stub_1_9 p.adjust" class="gt_row gt_right">7.785641e-04</td>
<td headers="stub_1_9 qvalue" class="gt_row gt_right">7.264029e-04</td>
<td headers="stub_1_9 rank" class="gt_row gt_right">1022</td>
<td headers="stub_1_9 leading_edge" class="gt_row gt_left">tags=35%, list=11%, signal=31%</td>
<td headers="stub_1_9 geneID" class="gt_row gt_left">Atp1a1/Flt1/Slmap/Tmem38a/Cav1/Atp2b1/Nppa/Akap6/Pde4d/Rock2/Smtn/Myh14/Cacna2d1/Dmpk/Ghrl/Ccn2/Ucn/Ucn/Trim63/Slc8a1/Abcc9/Csrp3/Sulf2/Atp1a2/Lmod3/Cacna1c/Myom2/Gsn/Myom1/Tcap/Pln/Ptgs2/Tnnc1/Scn5a/Actn2/Mybpc3/Casq2/Ryr2/Lmod2/Dsp/Aldoa/Myl3/Ttn/Tnni3/Actc1/Myl2/Tpm1/Myh7/Tnnt2/Myh6/Atp2a2/Ptgs1</td>
<td headers="stub_1_9 Count" class="gt_row gt_right">52</td>
<td headers="stub_1_9 enrichment" class="gt_row gt_left">Liver</td>
<td headers="stub_1_9 geneset" class="gt_row gt_left">bp</td></tr>
    <tr><th id="stub_1_10" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">10</th>
<td headers="stub_1_10 Description" class="gt_row gt_left">muscle system process</td>
<td headers="stub_1_10 setSize" class="gt_row gt_right">211</td>
<td headers="stub_1_10 enrichmentScore" class="gt_row gt_right">-0.6414959</td>
<td headers="stub_1_10 NES" class="gt_row gt_right">-1.946481</td>
<td headers="stub_1_10 pvalue" class="gt_row gt_right">1.076852e-06</td>
<td headers="stub_1_10 p.adjust" class="gt_row gt_right">7.785641e-04</td>
<td headers="stub_1_10 qvalue" class="gt_row gt_right">7.264029e-04</td>
<td headers="stub_1_10 rank" class="gt_row gt_right">1022</td>
<td headers="stub_1_10 leading_edge" class="gt_row gt_left">tags=33%, list=11%, signal=30%</td>
<td headers="stub_1_10 geneID" class="gt_row gt_left">Atp1a1/Flt1/Slmap/Akap1/Tmem38a/Cav1/Atp2b1/Nppa/Akap6/Pde4d/Rock2/Gsk3a/Sorbs2/Smtn/Myh14/Akap13/Cacna2d1/Dmpk/Ghrl/Ccn2/Igfbp5/Pdlim5/Asb2/Ucn/Hand2/Sco2/Ucn/Trim63/Slc8a1/Abcc9/Csrp3/Abcc8/Sulf2/Trim72/Atp1a2/Yy1/Lmod3/Cacna1c/Srl/Myom2/Gsn/Myom1/Myoz2/Tcap/Pln/Ptgs2/Tnnc1/Scn5a/Cmya5/Actn2/Mir208b/Mybpc3/Casq2/Ryr2/Slc25a4/Lmod2/Dsp/Aldoa/Myl3/Ttn/Tnni3/Hrc/Actc1/Myl2/Tpm1/Myh7/Tnnt2/Myh6/Atp2a2/Ptgs1</td>
<td headers="stub_1_10 Count" class="gt_row gt_right">70</td>
<td headers="stub_1_10 enrichment" class="gt_row gt_left">Liver</td>
<td headers="stub_1_10 geneset" class="gt_row gt_left">bp</td></tr>
    <tr><th id="stub_1_11" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier; font-size: x-small; background-color: #E4E4E4;">11..85</th>
<td headers="stub_1_11 Description" class="gt_row gt_left" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 setSize" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 enrichmentScore" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 NES" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 pvalue" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 p.adjust" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 qvalue" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 rank" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 leading_edge" class="gt_row gt_left" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 geneID" class="gt_row gt_left" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 Count" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 enrichment" class="gt_row gt_left" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 geneset" class="gt_row gt_left" style="background-color: #E4E4E4;"></td></tr>
    <tr><th id="stub_1_12" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">86</th>
<td headers="stub_1_12 Description" class="gt_row gt_left">Plasma lipoprotein assembly</td>
<td headers="stub_1_12 setSize" class="gt_row gt_right">14</td>
<td headers="stub_1_12 enrichmentScore" class="gt_row gt_right">0.9248652</td>
<td headers="stub_1_12 NES" class="gt_row gt_right">1.799691</td>
<td headers="stub_1_12 pvalue" class="gt_row gt_right">6.220222e-04</td>
<td headers="stub_1_12 p.adjust" class="gt_row gt_right">4.683827e-02</td>
<td headers="stub_1_12 qvalue" class="gt_row gt_right">4.472013e-02</td>
<td headers="stub_1_12 rank" class="gt_row gt_right">388</td>
<td headers="stub_1_12 leading_edge" class="gt_row gt_left">tags=64%, list=4%, signal=62%</td>
<td headers="stub_1_12 geneID" class="gt_row gt_left">11816/11806/11807/11812/238055/11808/11425/18453/11814</td>
<td headers="stub_1_12 Count" class="gt_row gt_right">9</td>
<td headers="stub_1_12 enrichment" class="gt_row gt_left">Heart</td>
<td headers="stub_1_12 geneset" class="gt_row gt_left">reactome</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(df1)) {</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tidyheatmap</span>(<span class="at">df =</span> df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p.adjust <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">p.adjust =</span> <span class="sc">-</span><span class="fu">log10</span>(p.adjust)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(geneset) <span class="sc">%&gt;%</span> <span class="fu">remove_rownames</span>(), <span class="at">color_legend_n =</span> <span class="dv">1</span>, <span class="at">color_legend_min =</span> <span class="dv">0</span>, <span class="at">color_legend_max =</span> <span class="fl">1.3</span>,<span class="at">rows =</span> Description, <span class="at">columns =</span> enrichment, <span class="at">values =</span> p.adjust, <span class="at">annotation_row =</span> geneset, <span class="at">gaps_row =</span> geneset, <span class="at">gaps_col =</span> enrichment, <span class="at">legend_labels =</span> <span class="st">"-log10(p.adjust)"</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_DEGanalysis_files/figure-html/GSEA%20approach%20using%20the%20res1%20output-4.png" class="img-fluid"></p>
</div>
</div>
<p>All the significant pathways (p.adjust &lt; 0.05) are labelled in blue color.</p>
<p><strong>Conclusion: Liver-specific DEGs are enriched in mitochondrial, muscle biogenesis, respiration related processes across multiple databases whereas heart-specific DEGs are associated with immune, coagulation, MYC targets related processes.</strong></p>
</section>
</section>
<section id="main-effects-due-to-timepoint" class="level3">
<h3 class="anchored" data-anchor-id="main-effects-due-to-timepoint">Main effects due to timepoint</h3>
<section id="comparison-of-wald-versus-lrt-test-degs-main-effects-due-to-time" class="level4">
<h4 class="anchored" data-anchor-id="comparison-of-wald-versus-lrt-test-degs-main-effects-due-to-time">Comparison of Wald versus LRT test DEGs [Main effects due to time]</h4>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeqDataSetFromMatrix</span>(<span class="at">countData =</span> cts,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colData =</span> coldata,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">design =</span> <span class="sc">~</span> time) <span class="co">#not accounting for timepoint</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>res4 <span class="ot">&lt;-</span> <span class="fu">results</span>(dds, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"T12"</span>, <span class="st">"T0"</span>))</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>res4 <span class="ot">&lt;-</span> res4 <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"gene"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(log2FoldChange,padj) <span class="sc">%&gt;%</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DEG =</span> <span class="fu">case_when</span>(log2FoldChange <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"up"</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>                         log2FoldChange <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"down"</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>),</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">comparison =</span> <span class="st">"T12_vs_T0-Wald"</span>,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">enrichment =</span> <span class="fu">case_when</span>(DEG <span class="sc">==</span> <span class="st">"up"</span> <span class="sc">~</span> <span class="st">"T12"</span>,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>                                DEG <span class="sc">==</span> <span class="st">"down"</span> <span class="sc">~</span> <span class="st">"T0"</span>,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>)) </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="co">#res4 &lt;- add_gene_name(res4)</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>res4 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">count</span>(comparison, enrichment) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="co">#LRT test</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeqDataSetFromMatrix</span>(<span class="at">countData =</span> cts,</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colData =</span> coldata,</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>                              <span class="at">design =</span> <span class="sc">~</span> tissue <span class="sc">+</span> time) <span class="co">#accounting for timepoint in design</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds, <span class="at">test =</span> <span class="st">"LRT"</span>, <span class="at">full =</span> <span class="sc">~</span> tissue <span class="sc">+</span> time, <span class="at">reduced =</span> <span class="sc">~</span> tissue)</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>res5 <span class="ot">&lt;-</span> <span class="fu">results</span>(dds, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"T12"</span>, <span class="st">"T0"</span>))</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>res5 <span class="ot">&lt;-</span> res5 <span class="sc">%&gt;%</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"gene"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(log2FoldChange,padj) <span class="sc">%&gt;%</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DEG =</span> <span class="fu">case_when</span>(log2FoldChange <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"up"</span>,</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>                         log2FoldChange <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"down"</span>,</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>),</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">comparison =</span> <span class="st">"T12_vs_T0-LRT"</span>,</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">enrichment =</span> <span class="fu">case_when</span>(DEG <span class="sc">==</span> <span class="st">"up"</span> <span class="sc">~</span> <span class="st">"T12"</span>,</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>                                DEG <span class="sc">==</span> <span class="st">"down"</span> <span class="sc">~</span> <span class="st">"T0"</span>,</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>))</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a><span class="co">#res5 &lt;- add_gene_name(res5)</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>res5 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">count</span>(comparison, enrichment) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">=</span> <span class="fu">rbind_common</span>(res4,res5)</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a><span class="co">#split(res3, f = list(res3$comparison, res3$enrichment))</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a><span class="co">#UpSetR::upset()</span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a><span class="fu">plotVenn</span>(<span class="fu">map</span>(<span class="fu">split</span>(res3, <span class="at">f =</span> <span class="fu">list</span>(res3<span class="sc">$</span>comparison, res3<span class="sc">$</span>enrichment)), <span class="cf">function</span>(x) x <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene)),</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">use_venn =</span> F,</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">main_text_size =</span> <span class="dv">15</span>,</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend_text_size =</span> <span class="dv">8</span>,</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend_position =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">

<div id="uxcpurzndb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#uxcpurzndb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#uxcpurzndb thead, #uxcpurzndb tbody, #uxcpurzndb tfoot, #uxcpurzndb tr, #uxcpurzndb td, #uxcpurzndb th {
  border-style: none;
}

#uxcpurzndb p {
  margin: 0;
  padding: 0;
}

#uxcpurzndb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#uxcpurzndb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#uxcpurzndb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#uxcpurzndb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#uxcpurzndb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uxcpurzndb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uxcpurzndb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uxcpurzndb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#uxcpurzndb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#uxcpurzndb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#uxcpurzndb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#uxcpurzndb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#uxcpurzndb .gt_spanner_row {
  border-bottom-style: hidden;
}

#uxcpurzndb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#uxcpurzndb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#uxcpurzndb .gt_from_md > :first-child {
  margin-top: 0;
}

#uxcpurzndb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#uxcpurzndb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#uxcpurzndb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#uxcpurzndb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#uxcpurzndb .gt_row_group_first td {
  border-top-width: 2px;
}

#uxcpurzndb .gt_row_group_first th {
  border-top-width: 2px;
}

#uxcpurzndb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uxcpurzndb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#uxcpurzndb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#uxcpurzndb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uxcpurzndb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uxcpurzndb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#uxcpurzndb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#uxcpurzndb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#uxcpurzndb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uxcpurzndb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uxcpurzndb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uxcpurzndb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uxcpurzndb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uxcpurzndb .gt_left {
  text-align: left;
}

#uxcpurzndb .gt_center {
  text-align: center;
}

#uxcpurzndb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#uxcpurzndb .gt_font_normal {
  font-weight: normal;
}

#uxcpurzndb .gt_font_bold {
  font-weight: bold;
}

#uxcpurzndb .gt_font_italic {
  font-style: italic;
}

#uxcpurzndb .gt_super {
  font-size: 65%;
}

#uxcpurzndb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#uxcpurzndb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#uxcpurzndb .gt_indent_1 {
  text-indent: 5px;
}

#uxcpurzndb .gt_indent_2 {
  text-indent: 10px;
}

#uxcpurzndb .gt_indent_3 {
  text-indent: 15px;
}

#uxcpurzndb .gt_indent_4 {
  text-indent: 20px;
}

#uxcpurzndb .gt_indent_5 {
  text-indent: 25px;
}

#uxcpurzndb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#uxcpurzndb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="comparison">comparison</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="enrichment">enrichment</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="comparison" class="gt_row gt_left">T12_vs_T0-Wald</td>
<td headers="enrichment" class="gt_row gt_left">T12</td>
<td headers="n" class="gt_row gt_right">1</td></tr>
    <tr><td headers="comparison" class="gt_row gt_left">T12_vs_T0-Wald</td>
<td headers="enrichment" class="gt_row gt_left">non-sig</td>
<td headers="n" class="gt_row gt_right">19846</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p>DEGs obtained with Wald test [Main effects due to time]</p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">

<div id="kqzoxhnsgz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kqzoxhnsgz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kqzoxhnsgz thead, #kqzoxhnsgz tbody, #kqzoxhnsgz tfoot, #kqzoxhnsgz tr, #kqzoxhnsgz td, #kqzoxhnsgz th {
  border-style: none;
}

#kqzoxhnsgz p {
  margin: 0;
  padding: 0;
}

#kqzoxhnsgz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kqzoxhnsgz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kqzoxhnsgz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kqzoxhnsgz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kqzoxhnsgz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kqzoxhnsgz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kqzoxhnsgz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kqzoxhnsgz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kqzoxhnsgz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kqzoxhnsgz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kqzoxhnsgz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kqzoxhnsgz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kqzoxhnsgz .gt_spanner_row {
  border-bottom-style: hidden;
}

#kqzoxhnsgz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kqzoxhnsgz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kqzoxhnsgz .gt_from_md > :first-child {
  margin-top: 0;
}

#kqzoxhnsgz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kqzoxhnsgz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kqzoxhnsgz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kqzoxhnsgz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kqzoxhnsgz .gt_row_group_first td {
  border-top-width: 2px;
}

#kqzoxhnsgz .gt_row_group_first th {
  border-top-width: 2px;
}

#kqzoxhnsgz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kqzoxhnsgz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kqzoxhnsgz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kqzoxhnsgz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kqzoxhnsgz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kqzoxhnsgz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kqzoxhnsgz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kqzoxhnsgz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kqzoxhnsgz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kqzoxhnsgz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kqzoxhnsgz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kqzoxhnsgz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kqzoxhnsgz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kqzoxhnsgz .gt_left {
  text-align: left;
}

#kqzoxhnsgz .gt_center {
  text-align: center;
}

#kqzoxhnsgz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kqzoxhnsgz .gt_font_normal {
  font-weight: normal;
}

#kqzoxhnsgz .gt_font_bold {
  font-weight: bold;
}

#kqzoxhnsgz .gt_font_italic {
  font-style: italic;
}

#kqzoxhnsgz .gt_super {
  font-size: 65%;
}

#kqzoxhnsgz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kqzoxhnsgz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kqzoxhnsgz .gt_indent_1 {
  text-indent: 5px;
}

#kqzoxhnsgz .gt_indent_2 {
  text-indent: 10px;
}

#kqzoxhnsgz .gt_indent_3 {
  text-indent: 15px;
}

#kqzoxhnsgz .gt_indent_4 {
  text-indent: 20px;
}

#kqzoxhnsgz .gt_indent_5 {
  text-indent: 25px;
}

#kqzoxhnsgz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kqzoxhnsgz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="comparison">comparison</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="enrichment">enrichment</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="comparison" class="gt_row gt_left">T12_vs_T0-LRT</td>
<td headers="enrichment" class="gt_row gt_left">T0</td>
<td headers="n" class="gt_row gt_right">15</td></tr>
    <tr><td headers="comparison" class="gt_row gt_left">T12_vs_T0-LRT</td>
<td headers="enrichment" class="gt_row gt_left">T12</td>
<td headers="n" class="gt_row gt_right">8</td></tr>
    <tr><td headers="comparison" class="gt_row gt_left">T12_vs_T0-LRT</td>
<td headers="enrichment" class="gt_row gt_left">non-sig</td>
<td headers="n" class="gt_row gt_right">2462</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p>DEGs obtained with Wald test [Main effects due to time]</p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_DEGanalysis_files/figure-html/Comparison%20of%20Wald%20test%20and%20LRT%20-%20Timepoint-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">DEGs obtained with Wald test [Main effects due to time]</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>DEGs with and without accounting for tissue yields similar DEGs between Wald and LRT tests suggesting that both designs are okay to detect main effects due to timepoints.</p>
</section>
<section id="visualization-of-timepoint-specific-degs-using-deseq2" class="level4">
<h4 class="anchored" data-anchor-id="visualization-of-timepoint-specific-degs-using-deseq2">Visualization of timepoint-specific DEGs using DESeq2</h4>
<p>I am going with res4 object that uses Wald test to identify main effects due to tissue. Wald test DEGs are all represented in the LRT DEGs as determined by the Upset plot shown above.</p>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Volcano plot</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>EnhancedVolcano<span class="sc">::</span><span class="fu">EnhancedVolcano</span>(res4,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">x =</span> <span class="st">"log2FoldChange"</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y =</span> <span class="st">"padj"</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">lab =</span> res4<span class="sc">$</span>gene,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">pCutoff =</span> <span class="fl">0.01</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">FCcutoff =</span> <span class="dv">1</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">title =</span> <span class="st">"T12 vs T0 comparison [Single-factor design]"</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">subtitle =</span> <span class="st">"Differential expression analysis using DESeq2"</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">labSize =</span> <span class="fl">2.0</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>                                 )</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co">#test this code</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(<span class="fu">counts</span>(dds[res4<span class="sc">$</span>gene[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], ], <span class="at">normalize =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">rownames =</span> <span class="st">'gene'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">"sample"</span>, <span class="at">values_to =</span> <span class="st">"counts"</span>, <span class="sc">-</span>gene) <span class="sc">%&gt;%</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">as_tibble</span>(<span class="fu">colData</span>(dds), <span class="at">rownames =</span> <span class="st">"group"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(name = paste0(substr(Type, 1, 5), '_', Condition, '_', 1:3)) %&gt;%</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> counts, <span class="at">fill =</span> tissue)) <span class="sc">+</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>, <span class="at">color =</span> <span class="st">"gray30"</span>) <span class="sc">+</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> gene, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_DEGanalysis_files/figure-html/Identification%20of%20timepoint-specific%20DEGs-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Number of identified DEGs (|logFC| &gt; 1 &amp; padj &lt; 0.01)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_DEGanalysis_files/figure-html/Identification%20of%20timepoint-specific%20DEGs-2.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">tissue-specific DEGs agnostic of the sampling timepoint</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>The timepoint based DEGs do not have specific pattern because enrichment can be at any tissue and timepoint combination</p>
</section>
<section id="expression-pattern-of-top-time-specific-degs" class="level4">
<h4 class="anchored" data-anchor-id="expression-pattern-of-top-time-specific-degs">Expression pattern of top time-specific DEGs</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>significant_genes <span class="ot">&lt;-</span> res4 <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.01</span>, <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="fu">abs</span>(log2FoldChange), <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(gene)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>sig_mat <span class="ot">&lt;-</span> normalized_cts[significant_genes,]</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>col_anno <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">df =</span> coldata <span class="sc">%&gt;%</span> <span class="fu">select</span>(tissue, time),</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">col =</span> <span class="fu">list</span>(<span class="at">time =</span> <span class="fu">c</span>(<span class="st">"T0"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"T12"</span> <span class="ot">=</span> <span class="st">"blue"</span>)))</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Boxplot of the only DEG"</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>significant_genes <span class="ot">&lt;-</span> res4 <span class="sc">%&gt;%</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.01</span>, <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="fu">abs</span>(log2FoldChange), <span class="at">n =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(gene)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>boxplot_1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(significant_genes, <span class="cf">function</span>(x) {</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotCounts</span>(dds, <span class="at">gene =</span> x,</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">intgroup =</span> <span class="fu">c</span>(<span class="st">"tissue"</span>,<span class="st">"time"</span>),</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">returnData =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">paste</span>(tissue,time), <span class="at">y =</span> <span class="fu">log2</span>(count), <span class="at">fill =</span> tissue)) <span class="sc">+</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Experimental group"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Normalized counts"</span>) <span class="sc">+</span> </span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(x))</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a><span class="fu">wrap_plots</span>(boxplot_1, <span class="at">ncol =</span> <span class="dv">3</span>)                             </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_DEGanalysis_files/figure-html/Expression%20pattern%20of%20top%20time-specific%20DEGs-1.png" class="img-fluid"></p>
</div>
</div>
<p>The timepoint based DEGs do not have specific pattern because enrichment can be at any tissue and timepoint combination</p>
</section>
<section id="pathway-analysis-using-the-timepoint-specific-degs-main-effects-using-ora" class="level4">
<h4 class="anchored" data-anchor-id="pathway-analysis-using-the-timepoint-specific-degs-main-effects-using-ora">Pathway analysis using the timepoint-specific DEGs (Main effects) using ORA</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># perform pathway analysis using multiple pathway genesets</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co">#empty lists for adding in the pathway results</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>barplots_1 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gene_set)) {</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  go_results1 <span class="ot">=</span> <span class="fu">safely</span>(genORA)(res4 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(enrichment <span class="sc">==</span> <span class="st">"T12"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene),</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">geneset =</span> gene_set[[i]],</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">p_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">q_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">universe =</span> <span class="fu">rownames</span>(res4))<span class="sc">$</span>result</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results1)) {</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    go_results1<span class="sc">$</span>geneset <span class="ot">=</span> gene_set[[i]]<span class="sc">$</span>type</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    go_results1<span class="sc">$</span>enrichment <span class="ot">=</span> <span class="st">"T12"</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  go_results2 <span class="ot">=</span> <span class="fu">safely</span>(genORA)(res4 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(enrichment <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene),</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">geneset =</span> gene_set[[i]],</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>                               <span class="at">p_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>                               <span class="at">q_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>                               <span class="at">universe =</span> <span class="fu">rownames</span>(res4))<span class="sc">$</span>result</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results2)) {</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    go_results2<span class="sc">$</span>geneset <span class="ot">=</span> gene_set[[i]]<span class="sc">$</span>type</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>    go_results2<span class="sc">$</span>enrichment <span class="ot">=</span> <span class="st">"T0"</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>  df1 <span class="ot">&lt;-</span> <span class="fu">rbind_common</span>(df1, go_results1, go_results2)</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(go_results2)) {</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">plotEnrich</span>(go_results1,</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot_type =</span> <span class="st">"bar"</span>,</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n_term =</span> <span class="dv">10</span>,</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>                   <span class="at">term_metric =</span> <span class="st">"FoldEnrich"</span>,</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stats_metric =</span> <span class="st">"qvalue"</span>)</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">plotEnrich</span>(go_results2,</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot_type =</span> <span class="st">"bar"</span>,</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n_term =</span> <span class="dv">10</span>,</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>                   <span class="at">term_metric =</span> <span class="st">"FoldEnrich"</span>,</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stats_metric =</span> <span class="st">"qvalue"</span>)</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>  barplots_1[[i]] <span class="ot">&lt;-</span> p1 <span class="sc">+</span> p2</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plotEnrich</span>(go_results1, <span class="at">plot_type =</span> <span class="st">"dot"</span>)</span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Pathway enrichment stats across multiple databases and tissue conditions"</span></span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Significant pathways (labelled in blue) across timepoints when using ORA and multiple pathway databases"</span></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(df1)) {df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p.adjust <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> <span class="fu">gt_preview</span>(<span class="at">top_n =</span> <span class="dv">10</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="rumddymwsk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rumddymwsk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rumddymwsk thead, #rumddymwsk tbody, #rumddymwsk tfoot, #rumddymwsk tr, #rumddymwsk td, #rumddymwsk th {
  border-style: none;
}

#rumddymwsk p {
  margin: 0;
  padding: 0;
}

#rumddymwsk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rumddymwsk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rumddymwsk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rumddymwsk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rumddymwsk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rumddymwsk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rumddymwsk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rumddymwsk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rumddymwsk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rumddymwsk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rumddymwsk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rumddymwsk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rumddymwsk .gt_spanner_row {
  border-bottom-style: hidden;
}

#rumddymwsk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rumddymwsk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rumddymwsk .gt_from_md > :first-child {
  margin-top: 0;
}

#rumddymwsk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rumddymwsk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rumddymwsk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rumddymwsk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rumddymwsk .gt_row_group_first td {
  border-top-width: 2px;
}

#rumddymwsk .gt_row_group_first th {
  border-top-width: 2px;
}

#rumddymwsk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rumddymwsk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rumddymwsk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rumddymwsk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rumddymwsk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rumddymwsk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rumddymwsk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rumddymwsk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rumddymwsk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rumddymwsk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rumddymwsk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rumddymwsk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rumddymwsk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rumddymwsk .gt_left {
  text-align: left;
}

#rumddymwsk .gt_center {
  text-align: center;
}

#rumddymwsk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rumddymwsk .gt_font_normal {
  font-weight: normal;
}

#rumddymwsk .gt_font_bold {
  font-weight: bold;
}

#rumddymwsk .gt_font_italic {
  font-style: italic;
}

#rumddymwsk .gt_super {
  font-size: 65%;
}

#rumddymwsk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rumddymwsk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rumddymwsk .gt_indent_1 {
  text-indent: 5px;
}

#rumddymwsk .gt_indent_2 {
  text-indent: 10px;
}

#rumddymwsk .gt_indent_3 {
  text-indent: 15px;
}

#rumddymwsk .gt_indent_4 {
  text-indent: 20px;
}

#rumddymwsk .gt_indent_5 {
  text-indent: 25px;
}

#rumddymwsk .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rumddymwsk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Description">Description</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="GeneRatio">GeneRatio</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="BgRatio">BgRatio</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="pvalue">pvalue</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.adjust">p.adjust</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="qvalue">qvalue</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="geneID">geneID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Count">Count</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="FoldEnrich">FoldEnrich</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="RichFactor">RichFactor</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="geneset">geneset</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="enrichment">enrichment</th>
    </tr>
  </thead>
  <tbody class="gt_table_body"></tbody>
  
  
</table>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p.adjust <span class="sc">&lt;</span> <span class="fl">0.05</span>)) <span class="sc">&gt;=</span> <span class="dv">1</span>) {</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tidyheatmap</span>(<span class="at">df =</span> df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p.adjust <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">p.adjust =</span> <span class="sc">-</span><span class="fu">log10</span>(p.adjust)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(geneset) <span class="sc">%&gt;%</span> <span class="fu">remove_rownames</span>(), <span class="at">color_legend_n =</span> <span class="dv">1</span>, <span class="at">color_legend_min =</span> <span class="dv">0</span>, <span class="at">color_legend_max =</span> <span class="fl">1.3</span>,<span class="at">rows =</span> Description, <span class="at">columns =</span> enrichment, <span class="at">values =</span> p.adjust, <span class="at">annotation_row =</span> geneset, <span class="at">gaps_row =</span> geneset, <span class="at">gaps_col =</span> enrichment, <span class="at">legend_labels =</span> <span class="st">"-log10(p.adjust)"</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>No pathways associated with any of T0 or T12 main effect DEGs.</strong></p>
<p>Let’s see if change of approach from ORA to GSEA lead to different results.</p>
<p>ORA method is easy to conduct, but it will lose information when genes’ differences are slight. For example, if a gene is essential in some pathway but is low-expressed, it will be filtered by fold change cutoff. Unlike ORA, FCS tools do not set a threshold for differentially expressed genes. Instead, it gives each detected gene a differential expression score and then evaluates whether the scores are more positive or negative than expected by chance for each gene set.</p>
</section>
<section id="pathway-analysis-using-the-tissue-specific-degs-main-effects-using-gsea-1" class="level4">
<h4 class="anchored" data-anchor-id="pathway-analysis-using-the-tissue-specific-degs-main-effects-using-gsea-1">Pathway analysis using the tissue-specific DEGs (Main effects) using GSEA</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>rankedGenes <span class="ot">&lt;-</span> res4 <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(gene, padj, log2FoldChange) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="sc">-</span><span class="fu">log10</span>(pvalue) <span class="sc">*</span> <span class="fu">sign</span>(log2FoldChange),</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">entrez =</span> <span class="fu">transId</span>(gene, <span class="at">transTo =</span> <span class="st">"entrez"</span>, <span class="at">keepNA =</span> T, <span class="at">unique =</span> T, <span class="at">org =</span> <span class="st">"mouse"</span>)<span class="sc">$</span>entrezid) <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(rank) <span class="sc">&amp;</span> <span class="fu">is.finite</span>(rank)) <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(rank)) <span class="sc">%&gt;%</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(rank, gene)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co">#head(rankedGenes)</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>barplots_1 <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gene_set)) {</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  gsea_results1 <span class="ot">=</span> <span class="fu">safely</span>(genGSEA)(<span class="at">genelist =</span> rankedGenes,</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">p_cutoff =</span> <span class="dv">1</span>,</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">q_cutoff =</span> <span class="dv">1</span>,</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>                                <span class="at">geneset =</span> gene_set[[i]])<span class="sc">$</span>result</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(gsea_results1<span class="sc">$</span>gsea_df)) {</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    barplots_1[[i]] <span class="ot">&lt;-</span> <span class="fu">plotGSEA</span>(gsea_results1, <span class="at">plot_type =</span> <span class="st">"bar"</span>, <span class="at">colour =</span> <span class="fu">c</span>(<span class="st">"navyblue"</span>, <span class="st">"orange"</span>))</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    df1 <span class="ot">=</span> <span class="fu">rbind_common</span>(df1, gsea_results1<span class="sc">$</span>gsea_df <span class="sc">%&gt;%</span> </span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">mutate</span>(<span class="at">enrichment =</span> <span class="fu">ifelse</span>(NES <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"T12"</span>, <span class="st">"T0"</span>),</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>                                <span class="at">geneset =</span> gene_set[[i]]<span class="sc">$</span>type))</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_DEGanalysis_files/figure-html/GSEA%20approach%20using%20the%20res4%20output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="02_DEGanalysis_files/figure-html/GSEA%20approach%20using%20the%20res4%20output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="02_DEGanalysis_files/figure-html/GSEA%20approach%20using%20the%20res4%20output-3.png" class="img-fluid"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Pathway table across multiple databases and tissue conditions"</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Signficant pathways (p.adjust &lt; 0.01) identified using GSEA using multiple databases"</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(df1)) {df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p.adjust <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> <span class="fu">gt_preview</span>(<span class="at">top_n =</span> <span class="dv">10</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="ntuyvdigjm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ntuyvdigjm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ntuyvdigjm thead, #ntuyvdigjm tbody, #ntuyvdigjm tfoot, #ntuyvdigjm tr, #ntuyvdigjm td, #ntuyvdigjm th {
  border-style: none;
}

#ntuyvdigjm p {
  margin: 0;
  padding: 0;
}

#ntuyvdigjm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ntuyvdigjm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ntuyvdigjm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ntuyvdigjm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ntuyvdigjm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ntuyvdigjm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ntuyvdigjm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ntuyvdigjm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ntuyvdigjm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ntuyvdigjm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ntuyvdigjm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ntuyvdigjm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ntuyvdigjm .gt_spanner_row {
  border-bottom-style: hidden;
}

#ntuyvdigjm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ntuyvdigjm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ntuyvdigjm .gt_from_md > :first-child {
  margin-top: 0;
}

#ntuyvdigjm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ntuyvdigjm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ntuyvdigjm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ntuyvdigjm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ntuyvdigjm .gt_row_group_first td {
  border-top-width: 2px;
}

#ntuyvdigjm .gt_row_group_first th {
  border-top-width: 2px;
}

#ntuyvdigjm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ntuyvdigjm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ntuyvdigjm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ntuyvdigjm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ntuyvdigjm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ntuyvdigjm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ntuyvdigjm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ntuyvdigjm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ntuyvdigjm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ntuyvdigjm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ntuyvdigjm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ntuyvdigjm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ntuyvdigjm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ntuyvdigjm .gt_left {
  text-align: left;
}

#ntuyvdigjm .gt_center {
  text-align: center;
}

#ntuyvdigjm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ntuyvdigjm .gt_font_normal {
  font-weight: normal;
}

#ntuyvdigjm .gt_font_bold {
  font-weight: bold;
}

#ntuyvdigjm .gt_font_italic {
  font-style: italic;
}

#ntuyvdigjm .gt_super {
  font-size: 65%;
}

#ntuyvdigjm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ntuyvdigjm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ntuyvdigjm .gt_indent_1 {
  text-indent: 5px;
}

#ntuyvdigjm .gt_indent_2 {
  text-indent: 10px;
}

#ntuyvdigjm .gt_indent_3 {
  text-indent: 15px;
}

#ntuyvdigjm .gt_indent_4 {
  text-indent: 20px;
}

#ntuyvdigjm .gt_indent_5 {
  text-indent: 25px;
}

#ntuyvdigjm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ntuyvdigjm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Description">Description</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="setSize">setSize</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="enrichmentScore">enrichmentScore</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="NES">NES</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="pvalue">pvalue</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.adjust">p.adjust</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="qvalue">qvalue</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rank">rank</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="leading_edge">leading_edge</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="geneID">geneID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Count">Count</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="enrichment">enrichment</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="geneset">geneset</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><th id="stub_1_1" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">1</th>
<td headers="stub_1_1 Description" class="gt_row gt_left">HALLMARK_MYC_TARGETS_V1</td>
<td headers="stub_1_1 setSize" class="gt_row gt_right">190</td>
<td headers="stub_1_1 enrichmentScore" class="gt_row gt_right">-0.4322121</td>
<td headers="stub_1_1 NES" class="gt_row gt_right">-1.743897</td>
<td headers="stub_1_1 pvalue" class="gt_row gt_right">1.913172e-05</td>
<td headers="stub_1_1 p.adjust" class="gt_row gt_right">0.0009565862</td>
<td headers="stub_1_1 qvalue" class="gt_row gt_right">0.0008659622</td>
<td headers="stub_1_1 rank" class="gt_row gt_right">3094</td>
<td headers="stub_1_1 leading_edge" class="gt_row gt_left">tags=34%, list=16%, signal=29%</td>
<td headers="stub_1_1 geneID" class="gt_row gt_left">12330/19385/20462/21781/105148/30877/57296/18674/68092/15510/26965/56150/225363/27756/22195/52530/19899/15191/26443/14852/20823/67204/26445/22627/109801/22123/51810/53379/66445/19166/22630/66870/12034/26444/26446/12462/18263/15516/53605/19359/12465/18538/18393/17463/22384/19826/24015/16828/56351/103136/50995/15528/23918/20104/11792/16898/67115/18655/85305/12428/13877/66409/68988/70769/13681/229279/22171</td>
<td headers="stub_1_1 Count" class="gt_row gt_right">67</td>
<td headers="stub_1_1 enrichment" class="gt_row gt_left">T0</td>
<td headers="stub_1_1 geneset" class="gt_row gt_left">msigdb</td></tr>
    <tr><th id="stub_1_2" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">2</th>
<td headers="stub_1_2 Description" class="gt_row gt_left">HALLMARK_MTORC1_SIGNALING</td>
<td headers="stub_1_2 setSize" class="gt_row gt_right">190</td>
<td headers="stub_1_2 enrichmentScore" class="gt_row gt_right">-0.3783896</td>
<td headers="stub_1_2 NES" class="gt_row gt_right">-1.526733</td>
<td headers="stub_1_2 pvalue" class="gt_row gt_right">1.699814e-03</td>
<td headers="stub_1_2 p.adjust" class="gt_row gt_right">0.0424953555</td>
<td headers="stub_1_2 qvalue" class="gt_row gt_right">0.0384694797</td>
<td headers="stub_1_2 rank" class="gt_row gt_right">4074</td>
<td headers="stub_1_2 leading_edge" class="gt_row gt_left">tags=36%, list=21%, signal=29%</td>
<td headers="stub_1_2 geneID" class="gt_row gt_left">12450/11674/67089/26570/66427/17872/14190/319554/74205/17252/15982/14751/76614/18030/78925/12330/13806/19192/26941/17113/15510/68278/225363/66997/208715/104112/67204/20867/22433/19769/14149/56041/19181/20249/14227/231070/13360/22359/56637/112407/74192/14433/13198/15277/12406/13595/67895/54353/14884/26397/16828/192193/15528/18451/103733/12466/20878/67486/12317/14828/18655/11639/100678/68801/15288/12301/13121/18477/22027</td>
<td headers="stub_1_2 Count" class="gt_row gt_right">69</td>
<td headers="stub_1_2 enrichment" class="gt_row gt_left">T0</td>
<td headers="stub_1_2 geneset" class="gt_row gt_left">msigdb</td></tr>
    <tr><th id="stub_1_3" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">3</th>
<td headers="stub_1_3 Description" class="gt_row gt_left">HALLMARK_KRAS_SIGNALING_DN</td>
<td headers="stub_1_3 setSize" class="gt_row gt_right">124</td>
<td headers="stub_1_3 enrichmentScore" class="gt_row gt_right">0.5341007</td>
<td headers="stub_1_3 NES" class="gt_row gt_right">1.999033</td>
<td headers="stub_1_3 pvalue" class="gt_row gt_right">2.570755e-03</td>
<td headers="stub_1_3 p.adjust" class="gt_row gt_right">0.0428459104</td>
<td headers="stub_1_3 qvalue" class="gt_row gt_right">0.0387868242</td>
<td headers="stub_1_3 rank" class="gt_row gt_right">1158</td>
<td headers="stub_1_3 leading_edge" class="gt_row gt_left">tags=6%, list=6%, signal=6%</td>
<td headers="stub_1_3 geneID" class="gt_row gt_left">56632/73288/84036/71279/404634/66106/66972/56358</td>
<td headers="stub_1_3 Count" class="gt_row gt_right">8</td>
<td headers="stub_1_3 enrichment" class="gt_row gt_left">T12</td>
<td headers="stub_1_3 geneset" class="gt_row gt_left">msigdb</td></tr>
    <tr><th id="stub_1_4" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">4</th>
<td headers="stub_1_4 Description" class="gt_row gt_left">protein kinase C signaling</td>
<td headers="stub_1_4 setSize" class="gt_row gt_right">31</td>
<td headers="stub_1_4 enrichmentScore" class="gt_row gt_right">0.8015879</td>
<td headers="stub_1_4 NES" class="gt_row gt_right">2.309109</td>
<td headers="stub_1_4 pvalue" class="gt_row gt_right">2.805879e-08</td>
<td headers="stub_1_4 p.adjust" class="gt_row gt_right">0.0001649015</td>
<td headers="stub_1_4 qvalue" class="gt_row gt_right">0.0001615005</td>
<td headers="stub_1_4 rank" class="gt_row gt_right">898</td>
<td headers="stub_1_4 leading_edge" class="gt_row gt_left">tags=13%, list=5%, signal=12%</td>
<td headers="stub_1_4 geneID" class="gt_row gt_left">Sphk2/Slc26a6/Coro1b/Mas1</td>
<td headers="stub_1_4 Count" class="gt_row gt_right">4</td>
<td headers="stub_1_4 enrichment" class="gt_row gt_left">T12</td>
<td headers="stub_1_4 geneset" class="gt_row gt_left">bp</td></tr>
    <tr><th id="stub_1_5" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">5</th>
<td headers="stub_1_5 Description" class="gt_row gt_left">positive regulation of protein kinase C signaling</td>
<td headers="stub_1_5 setSize" class="gt_row gt_right">10</td>
<td headers="stub_1_5 enrichmentScore" class="gt_row gt_right">0.9472488</td>
<td headers="stub_1_5 NES" class="gt_row gt_right">2.054122</td>
<td headers="stub_1_5 pvalue" class="gt_row gt_right">5.126306e-07</td>
<td headers="stub_1_5 p.adjust" class="gt_row gt_right">0.0015063651</td>
<td headers="stub_1_5 qvalue" class="gt_row gt_right">0.0014752970</td>
<td headers="stub_1_5 rank" class="gt_row gt_right">1</td>
<td headers="stub_1_5 leading_edge" class="gt_row gt_left">tags=10%, list=0%, signal=10%</td>
<td headers="stub_1_5 geneID" class="gt_row gt_left">Sphk2</td>
<td headers="stub_1_5 Count" class="gt_row gt_right">1</td>
<td headers="stub_1_5 enrichment" class="gt_row gt_left">T12</td>
<td headers="stub_1_5 geneset" class="gt_row gt_left">bp</td></tr>
    <tr><th id="stub_1_6" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">6</th>
<td headers="stub_1_6 Description" class="gt_row gt_left">regulation of deacetylase activity</td>
<td headers="stub_1_6 setSize" class="gt_row gt_right">12</td>
<td headers="stub_1_6 enrichmentScore" class="gt_row gt_right">0.9211206</td>
<td headers="stub_1_6 NES" class="gt_row gt_right">2.143157</td>
<td headers="stub_1_6 pvalue" class="gt_row gt_right">3.237745e-06</td>
<td headers="stub_1_6 p.adjust" class="gt_row gt_right">0.0063427420</td>
<td headers="stub_1_6 qvalue" class="gt_row gt_right">0.0062119257</td>
<td headers="stub_1_6 rank" class="gt_row gt_right">1</td>
<td headers="stub_1_6 leading_edge" class="gt_row gt_left">tags=8%, list=0%, signal=8%</td>
<td headers="stub_1_6 geneID" class="gt_row gt_left">Sphk2</td>
<td headers="stub_1_6 Count" class="gt_row gt_right">1</td>
<td headers="stub_1_6 enrichment" class="gt_row gt_left">T12</td>
<td headers="stub_1_6 geneset" class="gt_row gt_left">bp</td></tr>
    <tr><th id="stub_1_7" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">7</th>
<td headers="stub_1_7 Description" class="gt_row gt_left">interleukin-6 production</td>
<td headers="stub_1_7 setSize" class="gt_row gt_right">123</td>
<td headers="stub_1_7 enrichmentScore" class="gt_row gt_right">0.5295227</td>
<td headers="stub_1_7 NES" class="gt_row gt_right">1.950771</td>
<td headers="stub_1_7 pvalue" class="gt_row gt_right">4.404473e-06</td>
<td headers="stub_1_7 p.adjust" class="gt_row gt_right">0.0064712723</td>
<td headers="stub_1_7 qvalue" class="gt_row gt_right">0.0063378052</td>
<td headers="stub_1_7 rank" class="gt_row gt_right">1192</td>
<td headers="stub_1_7 leading_edge" class="gt_row gt_left">tags=12%, list=6%, signal=12%</td>
<td headers="stub_1_7 geneID" class="gt_row gt_left">Sphk2/Il16/Unc93b1/Setd4/Nlrp12/Nr1h4/C1qtnf4/Syk/Irak3/Tut4/Arrb2/Il17ra/Ifih1/F2r/Lgals9/Ptpn11</td>
<td headers="stub_1_7 Count" class="gt_row gt_right">16</td>
<td headers="stub_1_7 enrichment" class="gt_row gt_left">T12</td>
<td headers="stub_1_7 geneset" class="gt_row gt_left">bp</td></tr>
    <tr><th id="stub_1_8" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">8</th>
<td headers="stub_1_8 Description" class="gt_row gt_left">diol biosynthetic process</td>
<td headers="stub_1_8 setSize" class="gt_row gt_right">17</td>
<td headers="stub_1_8 enrichmentScore" class="gt_row gt_right">0.8490865</td>
<td headers="stub_1_8 NES" class="gt_row gt_right">2.141109</td>
<td headers="stub_1_8 pvalue" class="gt_row gt_right">9.970262e-06</td>
<td headers="stub_1_8 p.adjust" class="gt_row gt_right">0.0079151943</td>
<td headers="stub_1_8 qvalue" class="gt_row gt_right">0.0077519469</td>
<td headers="stub_1_8 rank" class="gt_row gt_right">1</td>
<td headers="stub_1_8 leading_edge" class="gt_row gt_left">tags=6%, list=0%, signal=6%</td>
<td headers="stub_1_8 geneID" class="gt_row gt_left">Sphk2</td>
<td headers="stub_1_8 Count" class="gt_row gt_right">1</td>
<td headers="stub_1_8 enrichment" class="gt_row gt_left">T12</td>
<td headers="stub_1_8 geneset" class="gt_row gt_left">bp</td></tr>
    <tr><th id="stub_1_9" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">9</th>
<td headers="stub_1_9 Description" class="gt_row gt_left">positive regulation of interleukin-13 production</td>
<td headers="stub_1_9 setSize" class="gt_row gt_right">10</td>
<td headers="stub_1_9 enrichmentScore" class="gt_row gt_right">0.9083307</td>
<td headers="stub_1_9 NES" class="gt_row gt_right">1.969727</td>
<td headers="stub_1_9 pvalue" class="gt_row gt_right">1.077447e-05</td>
<td headers="stub_1_9 p.adjust" class="gt_row gt_right">0.0079151943</td>
<td headers="stub_1_9 qvalue" class="gt_row gt_right">0.0077519469</td>
<td headers="stub_1_9 rank" class="gt_row gt_right">1</td>
<td headers="stub_1_9 leading_edge" class="gt_row gt_left">tags=10%, list=0%, signal=10%</td>
<td headers="stub_1_9 geneID" class="gt_row gt_left">Sphk2</td>
<td headers="stub_1_9 Count" class="gt_row gt_right">1</td>
<td headers="stub_1_9 enrichment" class="gt_row gt_left">T12</td>
<td headers="stub_1_9 geneset" class="gt_row gt_left">bp</td></tr>
    <tr><th id="stub_1_10" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">10</th>
<td headers="stub_1_10 Description" class="gt_row gt_left">sphingosine biosynthetic process</td>
<td headers="stub_1_10 setSize" class="gt_row gt_right">10</td>
<td headers="stub_1_10 enrichmentScore" class="gt_row gt_right">0.9082171</td>
<td headers="stub_1_10 NES" class="gt_row gt_right">1.969481</td>
<td headers="stub_1_10 pvalue" class="gt_row gt_right">1.077447e-05</td>
<td headers="stub_1_10 p.adjust" class="gt_row gt_right">0.0079151943</td>
<td headers="stub_1_10 qvalue" class="gt_row gt_right">0.0077519469</td>
<td headers="stub_1_10 rank" class="gt_row gt_right">1</td>
<td headers="stub_1_10 leading_edge" class="gt_row gt_left">tags=10%, list=0%, signal=10%</td>
<td headers="stub_1_10 geneID" class="gt_row gt_left">Sphk2</td>
<td headers="stub_1_10 Count" class="gt_row gt_right">1</td>
<td headers="stub_1_10 enrichment" class="gt_row gt_left">T12</td>
<td headers="stub_1_10 geneset" class="gt_row gt_left">bp</td></tr>
    <tr><th id="stub_1_11" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier; font-size: x-small; background-color: #E4E4E4;">11..56</th>
<td headers="stub_1_11 Description" class="gt_row gt_left" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 setSize" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 enrichmentScore" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 NES" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 pvalue" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 p.adjust" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 qvalue" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 rank" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 leading_edge" class="gt_row gt_left" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 geneID" class="gt_row gt_left" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 Count" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 enrichment" class="gt_row gt_left" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 geneset" class="gt_row gt_left" style="background-color: #E4E4E4;"></td></tr>
    <tr><th id="stub_1_12" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">57</th>
<td headers="stub_1_12 Description" class="gt_row gt_left">HSP90 chaperone cycle for steroid hormone receptors (SHR) in the presence of ligand</td>
<td headers="stub_1_12 setSize" class="gt_row gt_right">45</td>
<td headers="stub_1_12 enrichmentScore" class="gt_row gt_right">-0.6491595</td>
<td headers="stub_1_12 NES" class="gt_row gt_right">-2.083221</td>
<td headers="stub_1_12 pvalue" class="gt_row gt_right">1.457932e-05</td>
<td headers="stub_1_12 p.adjust" class="gt_row gt_right">0.0146667943</td>
<td headers="stub_1_12 qvalue" class="gt_row gt_right">0.0145486251</td>
<td headers="stub_1_12 rank" class="gt_row gt_right">2360</td>
<td headers="stub_1_12 leading_edge" class="gt_row gt_left">tags=35%, list=12%, signal=31%</td>
<td headers="stub_1_12 geneID" class="gt_row gt_left">20867/22143/13191/18667/14815/15482/15516/15511/15481/56444/69654/56351/227613/22146/22151/15519</td>
<td headers="stub_1_12 Count" class="gt_row gt_right">16</td>
<td headers="stub_1_12 enrichment" class="gt_row gt_left">T0</td>
<td headers="stub_1_12 geneset" class="gt_row gt_left">reactome</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(df1)) {</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tidyheatmap</span>(<span class="at">df =</span> df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p.adjust <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">p.adjust =</span> <span class="sc">-</span><span class="fu">log10</span>(p.adjust)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(geneset) <span class="sc">%&gt;%</span> <span class="fu">remove_rownames</span>(), <span class="at">color_legend_n =</span> <span class="dv">1</span>, <span class="at">color_legend_min =</span> <span class="dv">0</span>, <span class="at">color_legend_max =</span> <span class="fl">1.3</span>,<span class="at">rows =</span> Description, <span class="at">columns =</span> enrichment, <span class="at">values =</span> p.adjust, <span class="at">annotation_row =</span> geneset, <span class="at">gaps_row =</span> geneset, <span class="at">gaps_col =</span> enrichment, <span class="at">legend_labels =</span> <span class="st">"-log10(p.adjust)"</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_DEGanalysis_files/figure-html/GSEA%20approach%20using%20the%20res4%20output-4.png" class="img-fluid"></p>
</div>
</div>
<p>All the significant pathways (p.adjust &lt; 0.01) are labelled in blue color. To beautify the output and the plots, I resorted to a stricter cutoff for pathways i.e.&nbsp;p.adjust &lt; 0.01 instead of p.adjust &lt; 0.05</p>
<p><strong>Conclusion: T0-enriched DEGs fell into MYC targets, MTORC1 signaling pathways when using multiple pathway databases (KEGG, GO-BP, MSigDB hallmark and Reactome) when using GSEA approach. GSEA approach also confirmed the findings from the ORA approach. In addition, T12 associated pathways belong to chromatin remodeling, histone modification, KRAS and other pathway terms. The statistically robust approach GSEA is able to identify more pathways compared to ORA which is surprising.</strong></p>
</section>
</section>
<section id="interaction-effects" class="level3">
<h3 class="anchored" data-anchor-id="interaction-effects">Interaction effects</h3>
<section id="comparison-of-wald-versus-lrt-test---interaction-effects" class="level4">
<h4 class="anchored" data-anchor-id="comparison-of-wald-versus-lrt-test---interaction-effects">Comparison of Wald versus LRT test - interaction effects</h4>
<p><strong>DEGs can be defined genes passing the threshold: abs(logFC) &gt; 1 &amp; padj &lt; 0.01</strong></p>
<p>This is useful to detect interaction between tissue and timepoint.</p>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeqDataSetFromMatrix</span>(<span class="at">countData =</span> cts,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colData =</span> coldata,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">design =</span> <span class="sc">~</span> tissue <span class="sc">*</span> time) <span class="co">#interaction term</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co">#vd &lt;- VisualizeDesign(sampleData = coldata,</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a> <span class="co">#                     designFormula = ~ tissue * time)</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co">#print(vd$plotlist) #can visualize the model matrix and the various coefficients</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>res6 <span class="ot">&lt;-</span> <span class="fu">results</span>(dds, <span class="at">name =</span> <span class="st">"tissueLiver.timeT12"</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>res6 <span class="ot">&lt;-</span> res6 <span class="sc">%&gt;%</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"gene"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(log2FoldChange,padj) <span class="sc">%&gt;%</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DEG =</span> <span class="fu">case_when</span>(log2FoldChange <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"up"</span>,</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>                         log2FoldChange <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"down"</span>,</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>),</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">comparison =</span> <span class="st">"Interaction-Wald"</span>,</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">enrichment =</span> <span class="fu">case_when</span>(DEG <span class="sc">==</span> <span class="st">"up"</span> <span class="sc">~</span> <span class="st">"Heart"</span>,</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>                                DEG <span class="sc">==</span> <span class="st">"down"</span> <span class="sc">~</span> <span class="st">"Liver"</span>,</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>)) </span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="co">#res6 &lt;- add_gene_name(res6)</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>res6 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">count</span>(comparison, enrichment) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="co">#LRT test</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeqDataSetFromMatrix</span>(<span class="at">countData =</span> cts,</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colData =</span> coldata,</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>                              <span class="at">design =</span> <span class="sc">~</span> tissue <span class="sc">*</span> time) <span class="co">#accounting for timepoint in design</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds, <span class="at">test =</span> <span class="st">"LRT"</span>, <span class="at">full =</span> <span class="sc">~</span> tissue <span class="sc">*</span> time, <span class="at">reduced =</span> <span class="sc">~</span> tissue <span class="sc">+</span> time)</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>res7 <span class="ot">&lt;-</span> <span class="fu">results</span>(dds, <span class="at">name =</span> <span class="st">"tissueLiver.timeT12"</span>)</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>res7 <span class="ot">&lt;-</span> res7 <span class="sc">%&gt;%</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"gene"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(log2FoldChange,padj) <span class="sc">%&gt;%</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DEG =</span> <span class="fu">case_when</span>(log2FoldChange <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"up"</span>,</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>                         log2FoldChange <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"down"</span>,</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>),</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">comparison =</span> <span class="st">"Interaction-LRT"</span>,</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">enrichment =</span> <span class="fu">case_when</span>(DEG <span class="sc">==</span> <span class="st">"up"</span> <span class="sc">~</span> <span class="st">"Heart"</span>,</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>                                DEG <span class="sc">==</span> <span class="st">"down"</span> <span class="sc">~</span> <span class="st">"Liver"</span>,</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>)) </span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a><span class="co">#res7 &lt;- add_gene_name(res7)</span></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>res7 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">count</span>(comparison, enrichment) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>res8 <span class="ot">=</span> <span class="fu">rbind_common</span>(res6,res7)</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a><span class="co">#split(res3, f = list(res3$comparison, res3$enrichment))</span></span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a><span class="co">#UpSetR::upset()</span></span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a><span class="fu">plotVenn</span>(<span class="fu">map</span>(<span class="fu">split</span>(res8, <span class="at">f =</span> <span class="fu">list</span>(res8<span class="sc">$</span>comparison, res8<span class="sc">$</span>enrichment)), <span class="cf">function</span>(x) x <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene)),</span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>         <span class="at">use_venn =</span> F,</span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>         <span class="at">main_text_size =</span> <span class="dv">15</span>,</span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend_text_size =</span> <span class="dv">8</span>,</span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend_position =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">

<div id="koemkdehim" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#koemkdehim table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#koemkdehim thead, #koemkdehim tbody, #koemkdehim tfoot, #koemkdehim tr, #koemkdehim td, #koemkdehim th {
  border-style: none;
}

#koemkdehim p {
  margin: 0;
  padding: 0;
}

#koemkdehim .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#koemkdehim .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#koemkdehim .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#koemkdehim .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#koemkdehim .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#koemkdehim .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#koemkdehim .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#koemkdehim .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#koemkdehim .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#koemkdehim .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#koemkdehim .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#koemkdehim .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#koemkdehim .gt_spanner_row {
  border-bottom-style: hidden;
}

#koemkdehim .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#koemkdehim .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#koemkdehim .gt_from_md > :first-child {
  margin-top: 0;
}

#koemkdehim .gt_from_md > :last-child {
  margin-bottom: 0;
}

#koemkdehim .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#koemkdehim .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#koemkdehim .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#koemkdehim .gt_row_group_first td {
  border-top-width: 2px;
}

#koemkdehim .gt_row_group_first th {
  border-top-width: 2px;
}

#koemkdehim .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#koemkdehim .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#koemkdehim .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#koemkdehim .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#koemkdehim .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#koemkdehim .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#koemkdehim .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#koemkdehim .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#koemkdehim .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#koemkdehim .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#koemkdehim .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#koemkdehim .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#koemkdehim .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#koemkdehim .gt_left {
  text-align: left;
}

#koemkdehim .gt_center {
  text-align: center;
}

#koemkdehim .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#koemkdehim .gt_font_normal {
  font-weight: normal;
}

#koemkdehim .gt_font_bold {
  font-weight: bold;
}

#koemkdehim .gt_font_italic {
  font-style: italic;
}

#koemkdehim .gt_super {
  font-size: 65%;
}

#koemkdehim .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#koemkdehim .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#koemkdehim .gt_indent_1 {
  text-indent: 5px;
}

#koemkdehim .gt_indent_2 {
  text-indent: 10px;
}

#koemkdehim .gt_indent_3 {
  text-indent: 15px;
}

#koemkdehim .gt_indent_4 {
  text-indent: 20px;
}

#koemkdehim .gt_indent_5 {
  text-indent: 25px;
}

#koemkdehim .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#koemkdehim div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="comparison">comparison</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="enrichment">enrichment</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="comparison" class="gt_row gt_left">Interaction-Wald</td>
<td headers="enrichment" class="gt_row gt_left">non-sig</td>
<td headers="n" class="gt_row gt_right">19848</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p>DEGs obtained with Wald test <a href="#main-effects-due-to-tissue">Main effects due to tissue</a></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">

<div id="yitgzsdhgj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yitgzsdhgj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yitgzsdhgj thead, #yitgzsdhgj tbody, #yitgzsdhgj tfoot, #yitgzsdhgj tr, #yitgzsdhgj td, #yitgzsdhgj th {
  border-style: none;
}

#yitgzsdhgj p {
  margin: 0;
  padding: 0;
}

#yitgzsdhgj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yitgzsdhgj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yitgzsdhgj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yitgzsdhgj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yitgzsdhgj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yitgzsdhgj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yitgzsdhgj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yitgzsdhgj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yitgzsdhgj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yitgzsdhgj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yitgzsdhgj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yitgzsdhgj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yitgzsdhgj .gt_spanner_row {
  border-bottom-style: hidden;
}

#yitgzsdhgj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yitgzsdhgj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yitgzsdhgj .gt_from_md > :first-child {
  margin-top: 0;
}

#yitgzsdhgj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yitgzsdhgj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yitgzsdhgj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yitgzsdhgj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yitgzsdhgj .gt_row_group_first td {
  border-top-width: 2px;
}

#yitgzsdhgj .gt_row_group_first th {
  border-top-width: 2px;
}

#yitgzsdhgj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yitgzsdhgj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yitgzsdhgj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yitgzsdhgj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yitgzsdhgj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yitgzsdhgj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yitgzsdhgj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yitgzsdhgj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yitgzsdhgj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yitgzsdhgj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yitgzsdhgj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yitgzsdhgj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yitgzsdhgj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yitgzsdhgj .gt_left {
  text-align: left;
}

#yitgzsdhgj .gt_center {
  text-align: center;
}

#yitgzsdhgj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yitgzsdhgj .gt_font_normal {
  font-weight: normal;
}

#yitgzsdhgj .gt_font_bold {
  font-weight: bold;
}

#yitgzsdhgj .gt_font_italic {
  font-style: italic;
}

#yitgzsdhgj .gt_super {
  font-size: 65%;
}

#yitgzsdhgj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yitgzsdhgj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yitgzsdhgj .gt_indent_1 {
  text-indent: 5px;
}

#yitgzsdhgj .gt_indent_2 {
  text-indent: 10px;
}

#yitgzsdhgj .gt_indent_3 {
  text-indent: 15px;
}

#yitgzsdhgj .gt_indent_4 {
  text-indent: 20px;
}

#yitgzsdhgj .gt_indent_5 {
  text-indent: 25px;
}

#yitgzsdhgj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#yitgzsdhgj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="comparison">comparison</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="enrichment">enrichment</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="comparison" class="gt_row gt_left">Interaction-LRT</td>
<td headers="enrichment" class="gt_row gt_left">non-sig</td>
<td headers="n" class="gt_row gt_right">19848</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p>DEGs obtained with Wald test <a href="#main-effects-due-to-tissue">Main effects due to tissue</a></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_DEGanalysis_files/figure-html/Comparison%20of%20Wald%20test%20and%20LRT%20-%20interaction%20effects-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">DEGs obtained with Wald test <a href="#main-effects-due-to-tissue">Main effects due to tissue</a></figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p><strong>No DEGs were identified using the interaction design.</strong></p>
</section>
<section id="visualization-of-interaction-specific-degs-using-deseq2" class="level4">
<h4 class="anchored" data-anchor-id="visualization-of-interaction-specific-degs-using-deseq2">Visualization of interaction-specific DEGs using DESeq2</h4>
<p>I am going with res6 object that uses Wald test to identify main effects due to tissue. Wald test DEGs are all represented in the LRT DEGs as determined by the previous Upset plot</p>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Volcano plot</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>EnhancedVolcano<span class="sc">::</span><span class="fu">EnhancedVolcano</span>(res6,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">x =</span> <span class="st">"log2FoldChange"</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y =</span> <span class="st">"padj"</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">lab =</span> res6<span class="sc">$</span>gene,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">pCutoff =</span> <span class="fl">0.01</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">FCcutoff =</span> <span class="dv">1</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">title =</span> <span class="st">"comparison [Interaction effect]"</span>,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">subtitle =</span> <span class="st">"Differential expression analysis using DESeq2"</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">labSize =</span> <span class="fl">2.0</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>                                 )</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co">#test this code</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(<span class="fu">counts</span>(dds[res6<span class="sc">$</span>gene[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], ], <span class="at">normalize =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">rownames =</span> <span class="st">'gene'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">"sample"</span>, <span class="at">values_to =</span> <span class="st">"counts"</span>, <span class="sc">-</span>gene) <span class="sc">%&gt;%</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">as_tibble</span>(<span class="fu">colData</span>(dds), <span class="at">rownames =</span> <span class="st">"group"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(name = paste0(substr(Type, 1, 5), '_', Condition, '_', 1:3)) %&gt;%</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> counts, <span class="at">fill =</span> tissue)) <span class="sc">+</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>, <span class="at">color =</span> <span class="st">"gray30"</span>) <span class="sc">+</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> gene, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_DEGanalysis_files/figure-html/Identification%20of%20interaction-specific%20DEGs-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Number of identified DEGs (|logFC| &gt; 1 &amp; padj &lt; 0.01)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_DEGanalysis_files/figure-html/Identification%20of%20interaction-specific%20DEGs-2.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">tissue-specific DEGs agnostic of the sampling timepoint</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>The timepoint based DEGs do not have specific pattern because enrichment can be at any tissue and timepoint combination</p>
</section>
<section id="expression-pattern-of-top-interaction-specific-degs" class="level4">
<h4 class="anchored" data-anchor-id="expression-pattern-of-top-interaction-specific-degs">Expression pattern of top interaction-specific DEGs</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>significant_genes <span class="ot">&lt;-</span> res6 <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.01</span>, <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="fu">abs</span>(log2FoldChange), <span class="at">n =</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(gene)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>sig_mat <span class="ot">&lt;-</span> normalized_cts[significant_genes,]</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>col_anno <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">df =</span> coldata <span class="sc">%&gt;%</span> <span class="fu">select</span>(tissue, time),</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">col =</span> <span class="fu">list</span>(<span class="at">time =</span> <span class="fu">c</span>(<span class="st">"T0"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"T12"</span> <span class="ot">=</span> <span class="st">"blue"</span>)))</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Heatmap of top 50 DEGs sorted by |logFC| (|logFC| &gt; 1 &amp; padj &lt; 0.01)"</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Boxplot of top 12 DEGs"</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="fu">Heatmap</span>(<span class="fu">t</span>(<span class="fu">scale</span>(<span class="fu">t</span>(sig_mat))),</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">top_annotation =</span> col_anno,</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">show_row_names =</span> T,</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">"Scaled normalized</span><span class="sc">\n</span><span class="st">expression"</span>,</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">row_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">6</span>),</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">column_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">7</span>)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_DEGanalysis_files/figure-html/Expression%20pattern%20of%20top%20interaction-specific%20DEGs-1.png" class="img-fluid"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>significant_genes <span class="ot">&lt;-</span> res6 <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.01</span>, <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="fu">abs</span>(log2FoldChange), <span class="at">n =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(gene)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>boxplot_1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(significant_genes, <span class="cf">function</span>(x) {</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotCounts</span>(dds, <span class="at">gene =</span> x,</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">intgroup =</span> <span class="fu">c</span>(<span class="st">"tissue"</span>,<span class="st">"time"</span>),</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">returnData =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">paste</span>(tissue,time), <span class="at">y =</span> <span class="fu">log2</span>(count), <span class="at">fill =</span> tissue)) <span class="sc">+</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Experimental group"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Normalized counts"</span>) <span class="sc">+</span> </span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(x))</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(boxplot_1) <span class="sc">&gt;=</span> <span class="dv">1</span>) { <span class="fu">wrap_plots</span>(boxplot_1)}                             </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="paired-contrast-analysis---difference-between-liver-and-heart-at-each-timepoint" class="level2">
<h2 class="anchored" data-anchor-id="paired-contrast-analysis---difference-between-liver-and-heart-at-each-timepoint">Paired contrast analysis - Difference between Liver and Heart at each timepoint</h2>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>coldata<span class="sc">$</span>group <span class="ot">=</span> <span class="fu">paste0</span>(coldata<span class="sc">$</span>tissue, <span class="st">"_"</span>, coldata<span class="sc">$</span>time)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeqDataSetFromMatrix</span>(<span class="at">countData =</span> cts,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colData =</span> coldata,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">design =</span> <span class="sc">~</span> group)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Comparison between Heart and Liver at time T0</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>res9 <span class="ot">&lt;-</span> <span class="fu">results</span>(dds, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"group"</span>, <span class="st">"Heart_T0"</span>, <span class="st">"Liver_T0"</span>))</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>res9 <span class="ot">&lt;-</span> res9 <span class="sc">%&gt;%</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"gene"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(log2FoldChange,padj) <span class="sc">%&gt;%</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DEG =</span> <span class="fu">case_when</span>(log2FoldChange <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"up"</span>,</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>                         log2FoldChange <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"down"</span>,</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>),</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">comparison =</span> <span class="st">"Heart_vs_Liver-Time0-LRT"</span>,</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">enrichment =</span> <span class="fu">case_when</span>(DEG <span class="sc">==</span> <span class="st">"up"</span> <span class="sc">~</span> <span class="st">"Heart_T0"</span>,</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>                                DEG <span class="sc">==</span> <span class="st">"down"</span> <span class="sc">~</span> <span class="st">"Liver_T0"</span>,</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>))</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>res9 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">count</span>(comparison, enrichment) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Comparison between Heart and Liver at time T12</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>res10 <span class="ot">&lt;-</span> <span class="fu">results</span>(dds, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"group"</span>, <span class="st">"Heart_T12"</span>, <span class="st">"Liver_T12"</span>))</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>res10 <span class="ot">&lt;-</span> res10 <span class="sc">%&gt;%</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"gene"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(log2FoldChange,padj) <span class="sc">%&gt;%</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DEG =</span> <span class="fu">case_when</span>(log2FoldChange <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"up"</span>,</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>                         log2FoldChange <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"down"</span>,</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>),</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">comparison =</span> <span class="st">"Heart_vs_Liver-Time12-LRT"</span>,</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">enrichment =</span> <span class="fu">case_when</span>(DEG <span class="sc">==</span> <span class="st">"up"</span> <span class="sc">~</span> <span class="st">"Heart_T12"</span>,</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>                                DEG <span class="sc">==</span> <span class="st">"down"</span> <span class="sc">~</span> <span class="st">"Liver_T12"</span>,</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>))</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>res10 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">count</span>(comparison, enrichment) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">=</span> <span class="fu">rbind_common</span>(res9,res10)</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a><span class="fu">plotVenn</span>(<span class="fu">map</span>(<span class="fu">split</span>(res3, <span class="at">f =</span> <span class="fu">list</span>(res3<span class="sc">$</span>comparison, res3<span class="sc">$</span>enrichment)), <span class="cf">function</span>(x) x <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene)),</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">use_venn =</span> F,</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">main_text_size =</span> <span class="dv">15</span>,</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend_text_size =</span> <span class="dv">8</span>,</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend_position =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">

<div id="grnamzwnjt" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#grnamzwnjt table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#grnamzwnjt thead, #grnamzwnjt tbody, #grnamzwnjt tfoot, #grnamzwnjt tr, #grnamzwnjt td, #grnamzwnjt th {
  border-style: none;
}

#grnamzwnjt p {
  margin: 0;
  padding: 0;
}

#grnamzwnjt .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#grnamzwnjt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#grnamzwnjt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#grnamzwnjt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#grnamzwnjt .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#grnamzwnjt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#grnamzwnjt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#grnamzwnjt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#grnamzwnjt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#grnamzwnjt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#grnamzwnjt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#grnamzwnjt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#grnamzwnjt .gt_spanner_row {
  border-bottom-style: hidden;
}

#grnamzwnjt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#grnamzwnjt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#grnamzwnjt .gt_from_md > :first-child {
  margin-top: 0;
}

#grnamzwnjt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#grnamzwnjt .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#grnamzwnjt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#grnamzwnjt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#grnamzwnjt .gt_row_group_first td {
  border-top-width: 2px;
}

#grnamzwnjt .gt_row_group_first th {
  border-top-width: 2px;
}

#grnamzwnjt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#grnamzwnjt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#grnamzwnjt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#grnamzwnjt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#grnamzwnjt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#grnamzwnjt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#grnamzwnjt .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#grnamzwnjt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#grnamzwnjt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#grnamzwnjt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#grnamzwnjt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#grnamzwnjt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#grnamzwnjt .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#grnamzwnjt .gt_left {
  text-align: left;
}

#grnamzwnjt .gt_center {
  text-align: center;
}

#grnamzwnjt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#grnamzwnjt .gt_font_normal {
  font-weight: normal;
}

#grnamzwnjt .gt_font_bold {
  font-weight: bold;
}

#grnamzwnjt .gt_font_italic {
  font-style: italic;
}

#grnamzwnjt .gt_super {
  font-size: 65%;
}

#grnamzwnjt .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#grnamzwnjt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#grnamzwnjt .gt_indent_1 {
  text-indent: 5px;
}

#grnamzwnjt .gt_indent_2 {
  text-indent: 10px;
}

#grnamzwnjt .gt_indent_3 {
  text-indent: 15px;
}

#grnamzwnjt .gt_indent_4 {
  text-indent: 20px;
}

#grnamzwnjt .gt_indent_5 {
  text-indent: 25px;
}

#grnamzwnjt .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#grnamzwnjt div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="comparison">comparison</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="enrichment">enrichment</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="comparison" class="gt_row gt_left">Heart_vs_Liver-Time0-LRT</td>
<td headers="enrichment" class="gt_row gt_left">Heart_T0</td>
<td headers="n" class="gt_row gt_right">357</td></tr>
    <tr><td headers="comparison" class="gt_row gt_left">Heart_vs_Liver-Time0-LRT</td>
<td headers="enrichment" class="gt_row gt_left">Liver_T0</td>
<td headers="n" class="gt_row gt_right">328</td></tr>
    <tr><td headers="comparison" class="gt_row gt_left">Heart_vs_Liver-Time0-LRT</td>
<td headers="enrichment" class="gt_row gt_left">non-sig</td>
<td headers="n" class="gt_row gt_right">19163</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p>Number of identified DEGs (|logFC| &gt; 1 &amp; padj &lt; 0.01) by comparing Heart versus Liver at time T0</p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">

<div id="ujiljhfvua" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ujiljhfvua table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ujiljhfvua thead, #ujiljhfvua tbody, #ujiljhfvua tfoot, #ujiljhfvua tr, #ujiljhfvua td, #ujiljhfvua th {
  border-style: none;
}

#ujiljhfvua p {
  margin: 0;
  padding: 0;
}

#ujiljhfvua .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ujiljhfvua .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ujiljhfvua .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ujiljhfvua .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ujiljhfvua .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ujiljhfvua .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ujiljhfvua .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ujiljhfvua .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ujiljhfvua .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ujiljhfvua .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ujiljhfvua .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ujiljhfvua .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ujiljhfvua .gt_spanner_row {
  border-bottom-style: hidden;
}

#ujiljhfvua .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ujiljhfvua .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ujiljhfvua .gt_from_md > :first-child {
  margin-top: 0;
}

#ujiljhfvua .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ujiljhfvua .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ujiljhfvua .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ujiljhfvua .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ujiljhfvua .gt_row_group_first td {
  border-top-width: 2px;
}

#ujiljhfvua .gt_row_group_first th {
  border-top-width: 2px;
}

#ujiljhfvua .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ujiljhfvua .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ujiljhfvua .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ujiljhfvua .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ujiljhfvua .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ujiljhfvua .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ujiljhfvua .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ujiljhfvua .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ujiljhfvua .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ujiljhfvua .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ujiljhfvua .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ujiljhfvua .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ujiljhfvua .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ujiljhfvua .gt_left {
  text-align: left;
}

#ujiljhfvua .gt_center {
  text-align: center;
}

#ujiljhfvua .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ujiljhfvua .gt_font_normal {
  font-weight: normal;
}

#ujiljhfvua .gt_font_bold {
  font-weight: bold;
}

#ujiljhfvua .gt_font_italic {
  font-style: italic;
}

#ujiljhfvua .gt_super {
  font-size: 65%;
}

#ujiljhfvua .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ujiljhfvua .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ujiljhfvua .gt_indent_1 {
  text-indent: 5px;
}

#ujiljhfvua .gt_indent_2 {
  text-indent: 10px;
}

#ujiljhfvua .gt_indent_3 {
  text-indent: 15px;
}

#ujiljhfvua .gt_indent_4 {
  text-indent: 20px;
}

#ujiljhfvua .gt_indent_5 {
  text-indent: 25px;
}

#ujiljhfvua .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ujiljhfvua div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="comparison">comparison</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="enrichment">enrichment</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="comparison" class="gt_row gt_left">Heart_vs_Liver-Time12-LRT</td>
<td headers="enrichment" class="gt_row gt_left">Heart_T12</td>
<td headers="n" class="gt_row gt_right">387</td></tr>
    <tr><td headers="comparison" class="gt_row gt_left">Heart_vs_Liver-Time12-LRT</td>
<td headers="enrichment" class="gt_row gt_left">Liver_T12</td>
<td headers="n" class="gt_row gt_right">332</td></tr>
    <tr><td headers="comparison" class="gt_row gt_left">Heart_vs_Liver-Time12-LRT</td>
<td headers="enrichment" class="gt_row gt_left">non-sig</td>
<td headers="n" class="gt_row gt_right">3574</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p>Number of identified DEGs (|logFC| &gt; 1 &amp; padj &lt; 0.01) by comparing Heart versus Liver at time T0</p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_DEGanalysis_files/figure-html/Identification%20of%20DEGs%20between%20Liver%20and%20Heart%20for%20every%20timepoint-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Number of identified DEGs (|logFC| &gt; 1 &amp; padj &lt; 0.01) by comparing Heart versus Liver at time T0</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<section id="pathway-analysis-for-tissue-enriched-degs-for-timepoint-t0" class="level4">
<h4 class="anchored" data-anchor-id="pathway-analysis-for-tissue-enriched-degs-for-timepoint-t0">Pathway analysis for tissue-enriched DEGs for timepoint T0</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># perform pathway analysis using multiple pathway genesets</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co">#empty lists for adding in the pathway results</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>barplots_1 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gene_set)) {</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  go_results1 <span class="ot">=</span> <span class="fu">safely</span>(genORA)(res9 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(enrichment <span class="sc">==</span> <span class="st">"Heart"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene),</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">geneset =</span> gene_set[[i]],</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">p_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">q_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">universe =</span> <span class="fu">rownames</span>(res9))<span class="sc">$</span>result</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results1)) {</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    go_results1<span class="sc">$</span>geneset <span class="ot">=</span> gene_set[[i]]<span class="sc">$</span>type</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    go_results1<span class="sc">$</span>enrichment <span class="ot">=</span> <span class="st">"Heart"</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  go_results2 <span class="ot">=</span> <span class="fu">safely</span>(genORA)(res9 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(enrichment <span class="sc">==</span> <span class="st">"Liver"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene),</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">geneset =</span> gene_set[[i]],</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>                               <span class="at">p_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>                               <span class="at">q_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>                               <span class="at">universe =</span> <span class="fu">rownames</span>(res9))<span class="sc">$</span>result</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results2)) {</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>    go_results2<span class="sc">$</span>geneset <span class="ot">=</span> gene_set[[i]]<span class="sc">$</span>type</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>    go_results2<span class="sc">$</span>enrichment <span class="ot">=</span> <span class="st">"Liver"</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>  df1 <span class="ot">&lt;-</span> <span class="fu">rbind_common</span>(df1, go_results1, go_results2)</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(go_results2)) {</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">plotEnrich</span>(go_results1,</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot_type =</span> <span class="st">"bar"</span>,</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n_term =</span> <span class="dv">10</span>,</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>                   <span class="at">term_metric =</span> <span class="st">"FoldEnrich"</span>,</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stats_metric =</span> <span class="st">"qvalue"</span>)</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">plotEnrich</span>(go_results2,</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot_type =</span> <span class="st">"bar"</span>,</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n_term =</span> <span class="dv">10</span>,</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>                   <span class="at">term_metric =</span> <span class="st">"FoldEnrich"</span>,</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stats_metric =</span> <span class="st">"qvalue"</span>)</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>  barplots_1[[i]] <span class="ot">&lt;-</span> p1 <span class="sc">+</span> p2</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Pathway enrichment stats across multiple databases and tissue conditions"</span></span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Significant pathways (labelled in blue) across timepoints when using ORA and multiple pathway databases"</span></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(df1)) { df1 <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="sc">%&gt;%</span> <span class="fu">gt_preview</span>(<span class="at">top_n =</span> <span class="dv">10</span>) }</span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(df1)) {</span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tidyheatmap</span>(<span class="at">df =</span> df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p.adjust <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">p.adjust =</span> <span class="sc">-</span><span class="fu">log10</span>(p.adjust)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(geneset) <span class="sc">%&gt;%</span> <span class="fu">remove_rownames</span>(), <span class="at">color_legend_n =</span> <span class="dv">1</span>, <span class="at">color_legend_min =</span> <span class="dv">0</span>, <span class="at">color_legend_max =</span> <span class="fl">1.3</span>,<span class="at">rows =</span> Description, <span class="at">columns =</span> enrichment, <span class="at">values =</span> p.adjust, <span class="at">annotation_row =</span> geneset, <span class="at">gaps_row =</span> geneset, <span class="at">gaps_col =</span> enrichment</span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>No pathways significant for Heart and Liver DEGs for timepoint T0.</p>
</section>
<section id="pathway-analysis-for-tissue-enriched-degs-for-timepoint-t12" class="level4">
<h4 class="anchored" data-anchor-id="pathway-analysis-for-tissue-enriched-degs-for-timepoint-t12">Pathway analysis for tissue-enriched DEGs for timepoint T12</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># perform pathway analysis using multiple pathway genesets</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co">#empty lists for adding in the pathway results</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>barplots_1 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gene_set)) {</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  go_results1 <span class="ot">=</span> <span class="fu">safely</span>(genORA)(res10 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(enrichment <span class="sc">==</span> <span class="st">"Heart"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene),</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">geneset =</span> gene_set[[i]],</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">p_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">q_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">universe =</span> <span class="fu">rownames</span>(res10))<span class="sc">$</span>result</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results1)) {</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    go_results1<span class="sc">$</span>geneset <span class="ot">=</span> gene_set[[i]]<span class="sc">$</span>type</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    go_results1<span class="sc">$</span>enrichment <span class="ot">=</span> <span class="st">"Heart"</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  go_results2 <span class="ot">=</span> <span class="fu">safely</span>(genORA)(res10 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(enrichment <span class="sc">==</span> <span class="st">"Liver"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene),</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">geneset =</span> gene_set[[i]],</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>                               <span class="at">p_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>                               <span class="at">q_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>                               <span class="at">universe =</span> <span class="fu">rownames</span>(res10))<span class="sc">$</span>result</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results2)) {</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>    go_results2<span class="sc">$</span>geneset <span class="ot">=</span> gene_set[[i]]<span class="sc">$</span>type</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>    go_results2<span class="sc">$</span>enrichment <span class="ot">=</span> <span class="st">"Liver"</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>  df1 <span class="ot">&lt;-</span> <span class="fu">rbind_common</span>(df1, go_results1, go_results2)</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(go_results2)) {</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">plotEnrich</span>(go_results1,</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot_type =</span> <span class="st">"bar"</span>,</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n_term =</span> <span class="dv">10</span>,</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>                   <span class="at">term_metric =</span> <span class="st">"FoldEnrich"</span>,</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stats_metric =</span> <span class="st">"qvalue"</span>)</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">plotEnrich</span>(go_results2,</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot_type =</span> <span class="st">"bar"</span>,</span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n_term =</span> <span class="dv">10</span>,</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>                   <span class="at">term_metric =</span> <span class="st">"FoldEnrich"</span>,</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stats_metric =</span> <span class="st">"qvalue"</span>)</span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>  barplots_1[[i]] <span class="ot">&lt;-</span> p1 <span class="sc">+</span> p2</span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Pathway enrichment stats across multiple databases and tissue conditions"</span></span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Significant pathways (labelled in blue) across timepoints when using ORA and multiple pathway databases"</span></span>
<span id="cb37-51"><a href="#cb37-51" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(df1)) { df1 <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="sc">%&gt;%</span> <span class="fu">gt_preview</span>(<span class="at">top_n =</span> <span class="dv">10</span>) }</span>
<span id="cb37-52"><a href="#cb37-52" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(df1)) {</span>
<span id="cb37-53"><a href="#cb37-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tidyheatmap</span>(<span class="at">df =</span> df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p.adjust <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">p.adjust =</span> <span class="sc">-</span><span class="fu">log10</span>(p.adjust)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(geneset) <span class="sc">%&gt;%</span> <span class="fu">remove_rownames</span>(), <span class="at">color_legend_n =</span> <span class="dv">1</span>, <span class="at">color_legend_min =</span> <span class="dv">0</span>, <span class="at">color_legend_max =</span> <span class="fl">1.3</span>,<span class="at">rows =</span> Description, <span class="at">columns =</span> enrichment, <span class="at">values =</span> p.adjust, <span class="at">annotation_row =</span> geneset, <span class="at">gaps_row =</span> geneset, <span class="at">gaps_col =</span> enrichment</span>
<span id="cb37-54"><a href="#cb37-54" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb37-55"><a href="#cb37-55" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>No pathways significant for Heart and Liver DEGs for timepoint t12.</p>
</section>
</section>
<section id="heirarchical-clustering-of-all-the-degs" class="level2">
<h2 class="anchored" data-anchor-id="heirarchical-clustering-of-all-the-degs">Heirarchical clustering of all the DEGs</h2>
<p>Main effect DEGs are in res1 (tissue), res4 (Timepoint) objects whereas interaction specific DEGs are in res6 objects. res9 and res10 objects contain DEGs between Heart and Liver comparison for timepoints T0 and T12 respectively.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>significant_genes <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(res1 <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene), res4 <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene), res6 <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene), res9 <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene), res10 <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene)))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>sig_mat <span class="ot">&lt;-</span> normalized_cts[significant_genes,]</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>col_anno <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">df =</span> coldata <span class="sc">%&gt;%</span> <span class="fu">select</span>(tissue, time),</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">col =</span> <span class="fu">list</span>(<span class="at">tissue =</span> <span class="fu">c</span>(<span class="st">"Liver"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Heart"</span> <span class="ot">=</span> <span class="st">"blue"</span>)))</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Heatmap of top 50 DEGs sorted by |logFC| (|logFC| &gt; 1 &amp; padj &lt; 0.01)"</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Boxplot of top 12 DEGs"</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="fu">Heatmap</span>(<span class="fu">t</span>(<span class="fu">scale</span>(<span class="fu">t</span>(sig_mat))),</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">top_annotation =</span> col_anno,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">show_row_names =</span> F,</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">cluster_rows =</span> T,</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">cluster_columns =</span> T,</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">column_km =</span> <span class="dv">2</span>,</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">row_km =</span> <span class="dv">2</span>,</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">row_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">6</span>),</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">column_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">7</span>),</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">"Scaled normalized</span><span class="sc">\n</span><span class="st">expression"</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_DEGanalysis_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid"></p>
</div>
</div>
<p>From the heatmap, we see that clustering of samples based on the tissue then the timepoint. tissue effects drive major source of variation compared to the timepoint. I roughly divided the DEGs obtained from various comparisons into 4 clusters - Cluster 1 and 2 are associated with genes/markers active in either tissue irrespective of the timepoint.</p>
</section>
<section id="plot-the-expression-pattern-of-the-degs-obtained-from-all-the-above-comparisons" class="level2">
<h2 class="anchored" data-anchor-id="plot-the-expression-pattern-of-the-degs-obtained-from-all-the-above-comparisons">Plot the expression pattern of the DEGs obtained from all the above comparisons</h2>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>ma <span class="ot">=</span> <span class="fu">assay</span>(<span class="fu">vst</span>(dds))[significant_genes,]</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>coldata1 <span class="ot">=</span> coldata <span class="sc">%&gt;%</span> <span class="fu">column_to_rownames</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">paste0</span>(tissue,<span class="st">"_"</span>, time),</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">group =</span> <span class="fu">factor</span>(group))</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">degPatterns</span>(ma, </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">metadata =</span> coldata1, </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">time =</span> <span class="st">"group"</span>, <span class="at">plot =</span> T)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>clusters<span class="sc">$</span>df <span class="sc">%&gt;%</span> <span class="fu">gt_preview</span>(<span class="at">top_n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02_DEGanalysis_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Grouping all the DEGs into clusters based on expression pattern trends</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">

<div id="cpkpfjruee" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#cpkpfjruee table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cpkpfjruee thead, #cpkpfjruee tbody, #cpkpfjruee tfoot, #cpkpfjruee tr, #cpkpfjruee td, #cpkpfjruee th {
  border-style: none;
}

#cpkpfjruee p {
  margin: 0;
  padding: 0;
}

#cpkpfjruee .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cpkpfjruee .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cpkpfjruee .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cpkpfjruee .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cpkpfjruee .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cpkpfjruee .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cpkpfjruee .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cpkpfjruee .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cpkpfjruee .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cpkpfjruee .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cpkpfjruee .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cpkpfjruee .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cpkpfjruee .gt_spanner_row {
  border-bottom-style: hidden;
}

#cpkpfjruee .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cpkpfjruee .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cpkpfjruee .gt_from_md > :first-child {
  margin-top: 0;
}

#cpkpfjruee .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cpkpfjruee .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cpkpfjruee .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#cpkpfjruee .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cpkpfjruee .gt_row_group_first td {
  border-top-width: 2px;
}

#cpkpfjruee .gt_row_group_first th {
  border-top-width: 2px;
}

#cpkpfjruee .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cpkpfjruee .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cpkpfjruee .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cpkpfjruee .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cpkpfjruee .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cpkpfjruee .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cpkpfjruee .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cpkpfjruee .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cpkpfjruee .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cpkpfjruee .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cpkpfjruee .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cpkpfjruee .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cpkpfjruee .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cpkpfjruee .gt_left {
  text-align: left;
}

#cpkpfjruee .gt_center {
  text-align: center;
}

#cpkpfjruee .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cpkpfjruee .gt_font_normal {
  font-weight: normal;
}

#cpkpfjruee .gt_font_bold {
  font-weight: bold;
}

#cpkpfjruee .gt_font_italic {
  font-style: italic;
}

#cpkpfjruee .gt_super {
  font-size: 65%;
}

#cpkpfjruee .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cpkpfjruee .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cpkpfjruee .gt_indent_1 {
  text-indent: 5px;
}

#cpkpfjruee .gt_indent_2 {
  text-indent: 10px;
}

#cpkpfjruee .gt_indent_3 {
  text-indent: 15px;
}

#cpkpfjruee .gt_indent_4 {
  text-indent: 20px;
}

#cpkpfjruee .gt_indent_5 {
  text-indent: 25px;
}

#cpkpfjruee .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#cpkpfjruee div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="a::stub"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="genes">genes</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="cluster">cluster</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><th id="stub_1_1" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">1</th>
<td headers="stub_1_1 genes" class="gt_row gt_left">Apoh</td>
<td headers="stub_1_1 cluster" class="gt_row gt_right">1</td></tr>
    <tr><th id="stub_1_2" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">2</th>
<td headers="stub_1_2 genes" class="gt_row gt_left">Itgb2l</td>
<td headers="stub_1_2 cluster" class="gt_row gt_right">2</td></tr>
    <tr><th id="stub_1_3" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">3</th>
<td headers="stub_1_3 genes" class="gt_row gt_left">Dlat</td>
<td headers="stub_1_3 cluster" class="gt_row gt_right">3</td></tr>
    <tr><th id="stub_1_4" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">4</th>
<td headers="stub_1_4 genes" class="gt_row gt_left">Comt</td>
<td headers="stub_1_4 cluster" class="gt_row gt_right">2</td></tr>
    <tr><th id="stub_1_5" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">5</th>
<td headers="stub_1_5 genes" class="gt_row gt_left">Ndufa9</td>
<td headers="stub_1_5 cluster" class="gt_row gt_right">4</td></tr>
    <tr><th id="stub_1_6" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">6</th>
<td headers="stub_1_6 genes" class="gt_row gt_left">Raf1</td>
<td headers="stub_1_6 cluster" class="gt_row gt_right">4</td></tr>
    <tr><th id="stub_1_7" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">7</th>
<td headers="stub_1_7 genes" class="gt_row gt_left">Tom1l2</td>
<td headers="stub_1_7 cluster" class="gt_row gt_right">1</td></tr>
    <tr><th id="stub_1_8" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">8</th>
<td headers="stub_1_8 genes" class="gt_row gt_left">Atp5pb</td>
<td headers="stub_1_8 cluster" class="gt_row gt_right">4</td></tr>
    <tr><th id="stub_1_9" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">9</th>
<td headers="stub_1_9 genes" class="gt_row gt_left">Hk2</td>
<td headers="stub_1_9 cluster" class="gt_row gt_right">4</td></tr>
    <tr><th id="stub_1_10" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">10</th>
<td headers="stub_1_10 genes" class="gt_row gt_left">Myo18a</td>
<td headers="stub_1_10 cluster" class="gt_row gt_right">3</td></tr>
    <tr><th id="stub_1_11" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier; font-size: x-small; background-color: #E4E4E4;">11..1830</th>
<td headers="stub_1_11 genes" class="gt_row gt_left" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_11 cluster" class="gt_row gt_right" style="background-color: #E4E4E4;"></td></tr>
    <tr><th id="stub_1_12" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">1831</th>
<td headers="stub_1_12 genes" class="gt_row gt_left">Gm30455</td>
<td headers="stub_1_12 cluster" class="gt_row gt_right">1</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p>Grouping all the DEGs into clusters based on expression pattern trends</p>
</div>
</div>
</div>
</div>
<p>The output is the list of genes along with cluster IDs that facilitate filtering of genes with a particular expression pattern trend.</p>
<section id="pathway-analysis-of-various-clusters-obtained-from-the-above-analysis" class="level3">
<h3 class="anchored" data-anchor-id="pathway-analysis-of-various-clusters-obtained-from-the-above-analysis">Pathway analysis of various clusters obtained from the above analysis</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>hg_gs <span class="ot">=</span> geneset<span class="sc">::</span><span class="fu">getMsigdb</span>(<span class="at">org =</span> <span class="st">"human"</span>, <span class="at">category =</span> <span class="st">"H"</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">unique</span>(clusters<span class="sc">$</span>df<span class="sc">$</span>cluster), <span class="cf">function</span>(x) {</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  go_results1 <span class="ot">=</span> <span class="fu">safely</span>(genORA)(clusters<span class="sc">$</span>df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(cluster <span class="sc">==</span> x) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(genes),</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">geneset =</span> hg_gs,</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>                               <span class="co">#p_cutoff = 1, #to retrieve the whole output</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>                               <span class="co">#q_cutoff = 1, #to retrieve the whole output</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">universe =</span> clusters<span class="sc">$</span>df <span class="sc">%&gt;%</span> <span class="fu">pull</span>(genes))<span class="sc">$</span>result</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="fu">list_rbind</span>(df1, <span class="at">names_to =</span> <span class="st">"cluster"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                   cluster                                 ID
HALLMARK_XENOBIOTIC_METABOLISM           1     HALLMARK_XENOBIOTIC_METABOLISM
HALLMARK_COAGULATION                     1               HALLMARK_COAGULATION
HALLMARK_MYOGENESIS                      4                HALLMARK_MYOGENESIS
HALLMARK_OXIDATIVE_PHOSPHORYLATION       4 HALLMARK_OXIDATIVE_PHOSPHORYLATION
                                                          Description GeneRatio
HALLMARK_XENOBIOTIC_METABOLISM         HALLMARK_XENOBIOTIC_METABOLISM 0.2123894
HALLMARK_COAGULATION                             HALLMARK_COAGULATION 0.1681416
HALLMARK_MYOGENESIS                               HALLMARK_MYOGENESIS 0.2076503
HALLMARK_OXIDATIVE_PHOSPHORYLATION HALLMARK_OXIDATIVE_PHOSPHORYLATION 0.1693989
                                   BgRatio       pvalue     p.adjust
HALLMARK_XENOBIOTIC_METABOLISM      48/476 2.519132e-05 0.0007557395
HALLMARK_COAGULATION                36/476 8.037623e-05 0.0012056434
HALLMARK_MYOGENESIS                 57/476 4.091375e-06 0.0001350154
HALLMARK_OXIDATIVE_PHOSPHORYLATION  49/476 1.831873e-04 0.0030225904
                                         qvalue
HALLMARK_XENOBIOTIC_METABOLISM     0.0007159637
HALLMARK_COAGULATION               0.0011421885
HALLMARK_MYOGENESIS                0.0001205879
HALLMARK_OXIDATIVE_PHOSPHORYLATION 0.0026996023
                                                                                                                                                                                                                                                 geneID
HALLMARK_XENOBIOTIC_METABOLISM                                                                               Ddt/Gnmt/Apoe/Pgrmc1/Igfbp4/Hnf4a/Igf1/Acox1/Fetub/Cyb5a/Mbl2/Abcc2/Cyp2e1/Asl/Gsta3/Tdo2/Angptl3/Aldh2/Hsd17b2/Aqp9/Cdo1/Acsm1/Fabp1/Fbp1
HALLMARK_COAGULATION                                                                                                                              Rac1/Tmprss6/Hnf4a/F12/Rnase4/Clu/Rgn/Proc/Mbl2/Fn1/F13b/Hmgcs2/Ctso/C8b/Proz/Apoa1/C8a/Apoc1/Cfi/Ang
HALLMARK_MYOGENESIS                Mybpc3/Tsc2/Cd36/Myl2/Acsl1/Mb/Slc6a8/Smtn/Ckmt2/Myom1/Svil/Ablim1/Speg/Des/Tnnt2/Ak1/Crat/Gsn/Schip1/Casq2/Sspn/Ckm/Csrp3/Cox6a2/Col4a2/Acta1/Cryab/Pygm/Pfkm/Pde4dip/Hrc/Hspb8/Actn2/Myl3/Ptp4a3/Eno3/Actc1/Cox7a1
HALLMARK_OXIDATIVE_PHOSPHORYLATION                       Ndufa9/Atp5pb/Etfb/Dlst/Cs/Slc25a11/Pdk4/Mdh1/Dld/Sdha/Sucla2/Aco2/Ndufa5/Hspa9/Ndufb8/Atp5f1b/Atp5f1a/Atp5f1c/Ndufs1/Idh3b/Mfn2/Ldhb/Pdha1/Slc25a4/Idh3a/Etfa/Atp5pd/Hadhb/Slc25a3/Acadm/Cycs
                                   Count FoldEnrich RichFactor
HALLMARK_XENOBIOTIC_METABOLISM        24   2.106195  0.5000000
HALLMARK_COAGULATION                  19   2.223206  0.5277778
HALLMARK_MYOGENESIS                   38   1.734062  0.6666667
HALLMARK_OXIDATIVE_PHOSPHORYLATION    31   1.645589  0.6326531</code></pre>
</div>
</div>
<p>Cluster 1 (genes active in liver irrespective of timepoint) genes are associated with HALLMARK_XENOBIOTIC_METABOLISM &amp; HALLMARK_COAGULATION pathways. Cluster 4 (genes active in heart irrespective of timepoint) genes are associated with HALLMARK_MYOGENESIS &amp; HALLMARK_OXIDATIVE_PHOSPHORYLATION pathways.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.2.3 (2023-03-15)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur ... 10.16

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] grid      stats4    stats     graphics  grDevices utils     datasets 
[8] methods   base     

other attached packages:
 [1] fstcore_0.9.18              DEGreport_1.34.0           
 [3] UpSetR_1.4.0                ExploreModelMatrix_1.10.0  
 [5] RColorBrewer_1.1-3          patchwork_1.1.2            
 [7] tidyheatmaps_0.2.1          ComplexHeatmap_2.14.0      
 [9] gt_0.11.1                   knitr_1.42                 
[11] strex_2.0.1                 eatTools_0.7.7             
[13] genekitr_1.2.8              DESeq2_1.38.3              
[15] SummarizedExperiment_1.28.0 Biobase_2.58.0             
[17] MatrixGenerics_1.10.0       matrixStats_0.63.0         
[19] GenomicRanges_1.50.2        GenomeInfoDb_1.34.9        
[21] IRanges_2.32.0              S4Vectors_0.36.2           
[23] BiocGenerics_0.44.0         lubridate_1.9.2            
[25] forcats_1.0.0               stringr_1.5.0              
[27] dplyr_1.1.4                 purrr_1.0.1                
[29] readr_2.1.4                 tidyr_1.3.0                
[31] tibble_3.2.1                ggplot2_3.4.2              
[33] tidyverse_2.0.0             tximport_1.26.1            

loaded via a namespace (and not attached):
  [1] rtracklayer_1.58.0          fst_0.9.8                  
  [3] bit64_4.0.5                 ggvenn_0.1.10              
  [5] DelayedArray_0.24.0         data.table_1.14.8          
  [7] KEGGREST_1.38.0             RCurl_1.98-1.12            
  [9] doParallel_1.0.17           generics_0.1.3             
 [11] lambda.r_1.2.4              callr_3.7.3                
 [13] cowplot_1.1.1               usethis_2.1.6              
 [15] RSQLite_2.3.1               shadowtext_0.1.2           
 [17] europepmc_0.4.3             bit_4.0.5                  
 [19] tzdb_0.3.0                  enrichplot_1.18.4          
 [21] xml2_1.3.6                  httpuv_1.6.11              
 [23] viridis_0.6.3               xfun_0.39                  
 [25] hms_1.1.3                   evaluate_0.20              
 [27] promises_1.2.0.1            fansi_1.0.4                
 [29] restfulr_0.0.15             progress_1.2.2             
 [31] igraph_1.4.2                DBI_1.1.3                  
 [33] geneplotter_1.76.0          htmlwidgets_1.6.4          
 [35] futile.logger_1.4.3         reshape_0.8.9              
 [37] ellipsis_0.3.2              backports_1.4.1            
 [39] annotate_1.76.0             vctrs_0.6.5                
 [41] remotes_2.4.2               cachem_1.0.8               
 [43] withr_2.5.0                 ggforce_0.4.1              
 [45] triebeard_0.4.1             HDO.db_0.99.1              
 [47] checkmate_2.3.2             vroom_1.6.3                
 [49] GenomicAlignments_1.34.1    treeio_1.22.0              
 [51] prettyunits_1.1.1           mnormt_2.1.1               
 [53] cluster_2.1.4               DOSE_3.24.2                
 [55] ape_5.7-1                   lazyeval_0.2.2             
 [57] crayon_1.5.2                labeling_0.4.2             
 [59] edgeR_3.40.2                pkgconfig_2.0.3            
 [61] tweenr_2.0.2                nlme_3.1-162               
 [63] pkgload_1.3.2               devtools_2.4.5             
 [65] rlang_1.1.4                 lifecycle_1.0.3            
 [67] miniUI_0.1.1.1              downloader_0.4             
 [69] EnhancedVolcano_1.16.0      polyclip_1.10-4            
 [71] Matrix_1.5-4.1              aplot_0.1.10               
 [73] urltools_1.7.3              Rhdf5lib_1.20.0            
 [75] pheatmap_1.0.12             GlobalOptions_0.1.2        
 [77] processx_3.8.1              png_0.1-8                  
 [79] viridisLite_0.4.2           rjson_0.2.21               
 [81] bitops_1.0-7                geneset_0.2.7              
 [83] shinydashboard_0.7.2        gson_0.1.0                 
 [85] ConsensusClusterPlus_1.62.0 rhdf5filters_1.10.1        
 [87] Biostrings_2.66.0           blob_1.2.4                 
 [89] shape_1.4.6                 rintrojs_0.3.4             
 [91] qvalue_2.30.0               gridGraphics_0.5-1         
 [93] scales_1.3.0                memoise_2.0.1              
 [95] magrittr_2.0.3              plyr_1.8.8                 
 [97] zlibbioc_1.44.0             compiler_4.2.3             
 [99] scatterpie_0.1.9            BiocIO_1.8.0               
[101] clue_0.3-64                 Rsamtools_2.14.0           
[103] cli_3.6.3                   XVector_0.38.0             
[105] urlchecker_1.0.1            ps_1.7.5                   
[107] formatR_1.14                mgcv_1.8-42                
[109] MASS_7.3-59                 tidyselect_1.2.1           
[111] stringi_1.7.12              yaml_2.3.7                 
[113] GOSemSim_2.24.0             locfit_1.5-9.7             
[115] ggrepel_0.9.3               sass_0.4.9                 
[117] fastmatch_1.1-3             tools_4.2.3                
[119] timechange_0.2.0            parallel_4.2.3             
[121] circlize_0.4.15             rstudioapi_0.14            
[123] foreach_1.5.2               logging_0.10-108           
[125] gridExtra_2.3               farver_2.1.1               
[127] ComplexUpset_1.3.3          ggraph_2.1.0               
[129] digest_0.6.31               shiny_1.7.4                
[131] Rcpp_1.0.10                 broom_1.0.4                
[133] later_1.3.1                 httr_1.4.5                 
[135] ggdendro_0.2.0              AnnotationDbi_1.60.2       
[137] psych_2.3.9                 colorspace_2.1-0           
[139] XML_3.99-0.14               fs_1.6.4                   
[141] splines_4.2.3               yulab.utils_0.0.6          
[143] tidytree_0.4.2              graphlayouts_1.0.0         
[145] ggplotify_0.1.0             sessioninfo_1.2.2          
[147] xtable_1.8-4                futile.options_1.0.1       
[149] jsonlite_1.8.4              ggtree_3.6.2               
[151] tidygraph_1.2.3             ggfun_0.0.9                
[153] R6_2.5.1                    profvis_0.3.8              
[155] pillar_1.9.0                htmltools_0.5.8.1          
[157] mime_0.12                   glue_1.8.0                 
[159] fastmap_1.1.1               clusterProfiler_4.6.2      
[161] DT_0.27                     BiocParallel_1.32.6        
[163] codetools_0.2-19            fgsea_1.24.0               
[165] pkgbuild_1.4.0              utf8_1.2.3                 
[167] lattice_0.21-8              zip_2.3.0                  
[169] GO.db_3.16.0                shinyjs_2.1.0              
[171] openxlsx_4.2.5.2            limma_3.54.2               
[173] rmarkdown_2.21              munsell_0.5.0              
[175] GetoptLong_1.0.5            rhdf5_2.42.1               
[177] GenomeInfoDbData_1.2.9      iterators_1.0.14           
[179] reshape2_1.4.4              gtable_0.3.3               </code></pre>
</div>
</div>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb44" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "DGEanalysis_assignment_BiostateAI"</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 4</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="co">    eval: true</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="co">    warning: false</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="co">    message: false</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-height: 7</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-width: 7</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-format: png</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-dpi: 300</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="co">  pdf: </span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 4</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="co">    eval: true</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="co">    warning: false</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a><span class="co">    message: false</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-height: 7</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-width: 7</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-format: png</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-dpi: 300</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a><span class="fu">## Loading the required libraries</span></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Loading the required libraries}</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tximport)</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#for data wrangling</span></span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DESeq2) <span class="co">#for DEG analysis</span></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(genekitr) <span class="co">#for pathway analysis</span></span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co">#for data import</span></span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(eatTools) <span class="co">#for rbind functions</span></span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(strex) <span class="co">#for string related functions</span></span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr) <span class="co">#for beautiful tables</span></span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt) <span class="co">#for customized table layouts</span></span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ComplexHeatmap) <span class="co">#for beautiful heatmaps</span></span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyheatmaps) <span class="co">#for heatmap generation from dataframe</span></span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork) <span class="co">#for adding multiple figures to a plot</span></span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer) <span class="co">#for color schemas</span></span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="co">#for plotting</span></span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ExploreModelMatrix) <span class="co">#to explore complicated design in the DESeq2 formula</span></span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(UpSetR) <span class="co">#for upset plots</span></span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DEGreport) <span class="co">#for clustering of genes into groups based on expression pattern</span></span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Creation of tx2gene file from the GTF file}</span></span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a>gtf <span class="ot">&lt;-</span> rtracklayer<span class="sc">::</span><span class="fu">import</span>(<span class="st">"~/Documents/BiostateAI/data/fastqs/gencode.vM35.basic.annotation.gtf"</span>)</span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a>gtf_df<span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(gtf)</span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a><span class="co">#head(gtf_df)</span></span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a><span class="co"># this file is used to import the salmon output to summarize the counts from </span></span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a><span class="co"># transcript level to gene level</span></span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a>tx2gene<span class="ot">&lt;-</span> gtf_df <span class="sc">%&gt;%</span></span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"transcript"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(transcript_id, gene_id)</span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true" tabindex="-1"></a><span class="co"># this file is used to map the ENSEMBL gene id to gene symbols in the DESeq2 results</span></span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a>gene_name_map<span class="ot">&lt;-</span> gtf_df <span class="sc">%&gt;%</span> </span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"gene"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(gene_id, gene_name) </span>
<span id="cb44-74"><a href="#cb44-74" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-75"><a href="#cb44-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Loading all the Kallisto output tsv files}</span></span>
<span id="cb44-78"><a href="#cb44-78" aria-hidden="true" tabindex="-1"></a>files<span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">"~/Documents/BiostateAI/results/output/kallisto/"</span>, <span class="at">pattern =</span> <span class="st">".tsv"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>, </span>
<span id="cb44-79"><a href="#cb44-79" aria-hidden="true" tabindex="-1"></a>                   <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-80"><a href="#cb44-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-81"><a href="#cb44-81" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(files) <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_split</span>(files, <span class="at">pattern =</span> <span class="st">"/"</span>, <span class="at">simplify =</span> <span class="cn">TRUE</span>)[,<span class="dv">10</span>]</span>
<span id="cb44-82"><a href="#cb44-82" aria-hidden="true" tabindex="-1"></a>txi.kallisto.tsv <span class="ot">&lt;-</span> <span class="fu">tximport</span>(files, <span class="at">type =</span> <span class="st">"kallisto"</span>, <span class="at">tx2gene =</span> tx2gene, <span class="at">ignoreAfterBar =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-83"><a href="#cb44-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-84"><a href="#cb44-84" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(txi.kallisto.tsv<span class="sc">$</span>counts)</span>
<span id="cb44-85"><a href="#cb44-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-86"><a href="#cb44-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-87"><a href="#cb44-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-88"><a href="#cb44-88" aria-hidden="true" tabindex="-1"></a><span class="fu">### Function to add gene names [Didnt use it though] </span></span>
<span id="cb44-89"><a href="#cb44-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-90"><a href="#cb44-90" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Add gene name to the DESeq2 output}</span></span>
<span id="cb44-91"><a href="#cb44-91" aria-hidden="true" tabindex="-1"></a>add_gene_name<span class="ot">&lt;-</span> <span class="cf">function</span>(res){</span>
<span id="cb44-92"><a href="#cb44-92" aria-hidden="true" tabindex="-1"></a>  df<span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(res) <span class="sc">%&gt;%</span></span>
<span id="cb44-93"><a href="#cb44-93" aria-hidden="true" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"gene_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-94"><a href="#cb44-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">gene =</span> <span class="fu">transId</span>(gene_id, <span class="at">transTo =</span> <span class="st">"symbol"</span>, <span class="at">unique =</span> T, <span class="at">keepNA =</span> T)<span class="sc">$</span>symbol) <span class="sc">%&gt;%</span></span>
<span id="cb44-95"><a href="#cb44-95" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>(gene) <span class="sc">%&gt;%</span></span>
<span id="cb44-96"><a href="#cb44-96" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(padj, <span class="fu">abs</span>(log2FoldChange))</span>
<span id="cb44-97"><a href="#cb44-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb44-98"><a href="#cb44-98" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-99"><a href="#cb44-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-100"><a href="#cb44-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-101"><a href="#cb44-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-102"><a href="#cb44-102" aria-hidden="true" tabindex="-1"></a><span class="fu">### Importing the counts matrix</span></span>
<span id="cb44-103"><a href="#cb44-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-104"><a href="#cb44-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-105"><a href="#cb44-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Importing the counts and conversion to a DESeq object}</span></span>
<span id="cb44-106"><a href="#cb44-106" aria-hidden="true" tabindex="-1"></a><span class="co">#loading the length-scaled counts tsv file</span></span>
<span id="cb44-107"><a href="#cb44-107" aria-hidden="true" tabindex="-1"></a>cts <span class="ot">&lt;-</span> txi.kallisto.tsv<span class="sc">$</span>counts</span>
<span id="cb44-108"><a href="#cb44-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-109"><a href="#cb44-109" aria-hidden="true" tabindex="-1"></a><span class="co">#converting NA into 0 and round off the counts</span></span>
<span id="cb44-110"><a href="#cb44-110" aria-hidden="true" tabindex="-1"></a>cts[<span class="fu">is.na</span>(cts)] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb44-111"><a href="#cb44-111" aria-hidden="true" tabindex="-1"></a>cts <span class="ot">&lt;-</span> cts <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric, <span class="fu">list</span>(round)) <span class="sc">%&gt;%</span> </span>
<span id="cb44-112"><a href="#cb44-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"gene"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-113"><a href="#cb44-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gene1 =</span> <span class="fu">transId</span>(gene, <span class="at">transTo =</span> <span class="st">"symbol"</span>, <span class="at">org =</span> <span class="st">"mouse"</span>, <span class="at">unique =</span> T, <span class="at">keepNA =</span> T)<span class="sc">$</span>symbol) <span class="sc">%&gt;%</span></span>
<span id="cb44-114"><a href="#cb44-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gene) <span class="sc">%&gt;%</span> </span>
<span id="cb44-115"><a href="#cb44-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gene1, <span class="fu">everything</span>())</span>
<span id="cb44-116"><a href="#cb44-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-117"><a href="#cb44-117" aria-hidden="true" tabindex="-1"></a>cts <span class="ot">&lt;-</span> cts <span class="sc">%&gt;%</span></span>
<span id="cb44-118"><a href="#cb44-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>gene1 <span class="sc">%in%</span> cts<span class="sc">$</span>gene1[<span class="fu">duplicated</span>(cts<span class="sc">$</span>gene1)]) <span class="sc">%&gt;%</span></span>
<span id="cb44-119"><a href="#cb44-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"gene1"</span>)</span>
<span id="cb44-120"><a href="#cb44-120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-121"><a href="#cb44-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-122"><a href="#cb44-122" aria-hidden="true" tabindex="-1"></a><span class="fu">### Loading the metadata file</span></span>
<span id="cb44-123"><a href="#cb44-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-124"><a href="#cb44-124" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Import metadata file}</span></span>
<span id="cb44-125"><a href="#cb44-125" aria-hidden="true" tabindex="-1"></a>coldata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb44-126"><a href="#cb44-126" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb44-127"><a href="#cb44-127" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sample =</span> <span class="fu">c</span>(<span class="st">"Liver_ZT0_REP1"</span>,<span class="st">"Liver_ZT0_REP2"</span>,<span class="st">"Liver_ZT12_REP1"</span>,</span>
<span id="cb44-128"><a href="#cb44-128" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Liver_ZT12_REP2"</span>,<span class="st">"Heart_ZT0_REP1"</span>,</span>
<span id="cb44-129"><a href="#cb44-129" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Heart_ZT0_REP2"</span>,<span class="st">"Heart_ZT12_REP1"</span>,<span class="st">"Heart_ZT12_REP2"</span>),</span>
<span id="cb44-130"><a href="#cb44-130" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fastq_1 =</span> <span class="fu">c</span>(<span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT0_1_R1.fastq.gz"</span>,</span>
<span id="cb44-131"><a href="#cb44-131" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT0_2_R1.fastq.gz"</span>,</span>
<span id="cb44-132"><a href="#cb44-132" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT12_1_R1.fastq.gz"</span>,</span>
<span id="cb44-133"><a href="#cb44-133" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT12_2_R1.fastq.gz"</span>,</span>
<span id="cb44-134"><a href="#cb44-134" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT0_1_R1.fastq.gz"</span>,</span>
<span id="cb44-135"><a href="#cb44-135" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT0_2_R1.fastq.gz"</span>,</span>
<span id="cb44-136"><a href="#cb44-136" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT12_1_R1.fastq.gz"</span>,</span>
<span id="cb44-137"><a href="#cb44-137" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT12_2_R1.fastq.gz"</span>),</span>
<span id="cb44-138"><a href="#cb44-138" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fastq_2 =</span> <span class="fu">c</span>(<span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT0_1_R2.fastq.gz"</span>,</span>
<span id="cb44-139"><a href="#cb44-139" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT0_2_R2.fastq.gz"</span>,</span>
<span id="cb44-140"><a href="#cb44-140" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT12_1_R2.fastq.gz"</span>,</span>
<span id="cb44-141"><a href="#cb44-141" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Liver_ZT12_2_R2.fastq.gz"</span>,</span>
<span id="cb44-142"><a href="#cb44-142" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT0_1_R2.fastq.gz"</span>,</span>
<span id="cb44-143"><a href="#cb44-143" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT0_2_R2.fastq.gz"</span>,</span>
<span id="cb44-144"><a href="#cb44-144" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT12_1_R2.fastq.gz"</span>,</span>
<span id="cb44-145"><a href="#cb44-145" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"/Users/adityamiyer/Documents/BiostateAI/data/fastqs/Heart_ZT12_2_R2.fastq.gz"</span>),</span>
<span id="cb44-146"><a href="#cb44-146" aria-hidden="true" tabindex="-1"></a>                 <span class="at">strandedness =</span> <span class="fu">c</span>(<span class="st">"forward"</span>,</span>
<span id="cb44-147"><a href="#cb44-147" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"forward"</span>,<span class="st">"forward"</span>,<span class="st">"forward"</span>,<span class="st">"forward"</span>,</span>
<span id="cb44-148"><a href="#cb44-148" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"forward"</span>,<span class="st">"forward"</span>,<span class="st">"forward"</span>),</span>
<span id="cb44-149"><a href="#cb44-149" aria-hidden="true" tabindex="-1"></a>                         <span class="at">time =</span> <span class="fu">c</span>(<span class="st">"T0"</span>,</span>
<span id="cb44-150"><a href="#cb44-150" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"T0"</span>,<span class="st">"T12"</span>,<span class="st">"T12"</span>,<span class="st">"T0"</span>,<span class="st">"T0"</span>,<span class="st">"T12"</span>,<span class="st">"T12"</span>),</span>
<span id="cb44-151"><a href="#cb44-151" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tissue =</span> <span class="fu">c</span>(<span class="st">"Liver"</span>,</span>
<span id="cb44-152"><a href="#cb44-152" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Liver"</span>,<span class="st">"Liver"</span>,<span class="st">"Liver"</span>,<span class="st">"Heart"</span>,<span class="st">"Heart"</span>,</span>
<span id="cb44-153"><a href="#cb44-153" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Heart"</span>,<span class="st">"Heart"</span>)</span>
<span id="cb44-154"><a href="#cb44-154" aria-hidden="true" tabindex="-1"></a>           )</span>
<span id="cb44-155"><a href="#cb44-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-156"><a href="#cb44-156" aria-hidden="true" tabindex="-1"></a><span class="co">#coldata &lt;- coldata %&gt;% filter(time %in% c("T0", "T12"))</span></span>
<span id="cb44-157"><a href="#cb44-157" aria-hidden="true" tabindex="-1"></a>coldata<span class="sc">$</span>time <span class="ot">&lt;-</span> <span class="fu">factor</span>(coldata<span class="sc">$</span>time, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"T0"</span>, <span class="st">"T12"</span>))</span>
<span id="cb44-158"><a href="#cb44-158" aria-hidden="true" tabindex="-1"></a>coldata<span class="sc">$</span>tissue <span class="ot">&lt;-</span> <span class="fu">factor</span>(coldata<span class="sc">$</span>tissue, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Heart"</span>, <span class="st">"Liver"</span>))</span>
<span id="cb44-159"><a href="#cb44-159" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-160"><a href="#cb44-160" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb44-161"><a href="#cb44-161" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb44-162"><a href="#cb44-162" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Metadata file"</span></span>
<span id="cb44-163"><a href="#cb44-163" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Sample counts for tissue and timepoint combinations"</span></span>
<span id="cb44-164"><a href="#cb44-164" aria-hidden="true" tabindex="-1"></a>coldata <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb44-165"><a href="#cb44-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-166"><a href="#cb44-166" aria-hidden="true" tabindex="-1"></a>coldata <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">count</span>(tissue,time) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb44-167"><a href="#cb44-167" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-168"><a href="#cb44-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-169"><a href="#cb44-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-170"><a href="#cb44-170" aria-hidden="true" tabindex="-1"></a><span class="fu">## Creation and exploration of dds object</span></span>
<span id="cb44-171"><a href="#cb44-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-172"><a href="#cb44-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Conversion to a DESeq object}</span></span>
<span id="cb44-173"><a href="#cb44-173" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb44-174"><a href="#cb44-174" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb44-175"><a href="#cb44-175" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "p-value histogram without prefiltering of counts"</span></span>
<span id="cb44-176"><a href="#cb44-176" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Genes with high p-values do seem to have lower gene expression"</span></span>
<span id="cb44-177"><a href="#cb44-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-178"><a href="#cb44-178" aria-hidden="true" tabindex="-1"></a><span class="co">#creation of dds object without prefiltering</span></span>
<span id="cb44-179"><a href="#cb44-179" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeqDataSetFromMatrix</span>(<span class="at">countData =</span> cts,</span>
<span id="cb44-180"><a href="#cb44-180" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colData =</span> coldata,</span>
<span id="cb44-181"><a href="#cb44-181" aria-hidden="true" tabindex="-1"></a>                              <span class="at">design =</span> <span class="sc">~</span> tissue) <span class="co">#paired design tissue + time if need to adjust for confounders (time in this case)</span></span>
<span id="cb44-182"><a href="#cb44-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-183"><a href="#cb44-183" aria-hidden="true" tabindex="-1"></a>vd <span class="ot">&lt;-</span> <span class="fu">VisualizeDesign</span>(<span class="at">sampleData =</span> coldata,</span>
<span id="cb44-184"><a href="#cb44-184" aria-hidden="true" tabindex="-1"></a>                      <span class="at">designFormula =</span> <span class="sc">~</span> tissue)</span>
<span id="cb44-185"><a href="#cb44-185" aria-hidden="true" tabindex="-1"></a><span class="co">#print(vd$plotlist) #can visualize the model matrix and the various coefficients</span></span>
<span id="cb44-186"><a href="#cb44-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-187"><a href="#cb44-187" aria-hidden="true" tabindex="-1"></a>dds<span class="sc">$</span>tissue <span class="ot">&lt;-</span> <span class="fu">relevel</span>(dds<span class="sc">$</span>tissue, <span class="at">ref =</span> <span class="st">"Heart"</span>)</span>
<span id="cb44-188"><a href="#cb44-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-189"><a href="#cb44-189" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds) <span class="co">#Main effects for tissue #Expression affected by tissue not correcting for  the timepoint effects</span></span>
<span id="cb44-190"><a href="#cb44-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-191"><a href="#cb44-191" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">results</span>(dds, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"tissue"</span>, <span class="st">"Heart"</span>, <span class="st">"Liver"</span>))</span>
<span id="cb44-192"><a href="#cb44-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-193"><a href="#cb44-193" aria-hidden="true" tabindex="-1"></a>res <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-194"><a href="#cb44-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(padj) <span class="sc">%&gt;%</span></span>
<span id="cb44-195"><a href="#cb44-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pvalue)) <span class="sc">+</span></span>
<span id="cb44-196"><a href="#cb44-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">bins =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb44-197"><a href="#cb44-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"p-value histogram without prefiltering of counts"</span>)</span>
<span id="cb44-198"><a href="#cb44-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-199"><a href="#cb44-199" aria-hidden="true" tabindex="-1"></a>res <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-200"><a href="#cb44-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"gene_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-201"><a href="#cb44-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pvalue)) <span class="sc">%&gt;%</span></span>
<span id="cb44-202"><a href="#cb44-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pvalue_bin =</span> <span class="fu">if_else</span>(pvalue <span class="sc">&gt;</span> <span class="fl">0.75</span>, <span class="st">"high"</span>, <span class="st">"low"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-203"><a href="#cb44-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pvalue_bin, <span class="at">y =</span> <span class="fu">log2</span>(baseMean))) <span class="sc">+</span> </span>
<span id="cb44-204"><a href="#cb44-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb44-205"><a href="#cb44-205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-206"><a href="#cb44-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-207"><a href="#cb44-207" aria-hidden="true" tabindex="-1"></a>p-value histogram distribution looks bimodal. High expressing count genes fall into low p-value bin which is great. Let's look at the pattern after prefiltering of the counts.</span>
<span id="cb44-208"><a href="#cb44-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-209"><a href="#cb44-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Prefiltering of counts using the dds object}</span></span>
<span id="cb44-210"><a href="#cb44-210" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> dds[<span class="fu">rowSums</span>(<span class="fu">counts</span>(dds) <span class="sc">&gt;</span> <span class="dv">10</span>,)] <span class="co">#opted out after the visualization</span></span>
<span id="cb44-211"><a href="#cb44-211" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds)</span>
<span id="cb44-212"><a href="#cb44-212" aria-hidden="true" tabindex="-1"></a><span class="co">#resultsNames(dds)</span></span>
<span id="cb44-213"><a href="#cb44-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-214"><a href="#cb44-214" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">results</span>(dds, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"tissue"</span>, <span class="st">"Heart"</span>, <span class="st">"Liver"</span>)) <span class="co">#FALSE is Heart, Liver is TRUE and is in the denominator</span></span>
<span id="cb44-215"><a href="#cb44-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-216"><a href="#cb44-216" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb44-217"><a href="#cb44-217" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb44-218"><a href="#cb44-218" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "p-value histogram after prefiltering of counts"</span></span>
<span id="cb44-219"><a href="#cb44-219" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Genes with high p-values do seem to have lower gene expression"</span></span>
<span id="cb44-220"><a href="#cb44-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-221"><a href="#cb44-221" aria-hidden="true" tabindex="-1"></a>res <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-222"><a href="#cb44-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(padj) <span class="sc">%&gt;%</span></span>
<span id="cb44-223"><a href="#cb44-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pvalue)) <span class="sc">+</span></span>
<span id="cb44-224"><a href="#cb44-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">bins =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb44-225"><a href="#cb44-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"p-value histogram after prefiltering of counts"</span>)</span>
<span id="cb44-226"><a href="#cb44-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-227"><a href="#cb44-227" aria-hidden="true" tabindex="-1"></a>res <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-228"><a href="#cb44-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"gene_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-229"><a href="#cb44-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pvalue)) <span class="sc">%&gt;%</span></span>
<span id="cb44-230"><a href="#cb44-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pvalue_bin =</span> <span class="fu">if_else</span>(pvalue <span class="sc">&gt;</span> <span class="fl">0.75</span>, <span class="st">"high"</span>, <span class="st">"low"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-231"><a href="#cb44-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pvalue_bin, <span class="at">y =</span> <span class="fu">log2</span>(baseMean))) <span class="sc">+</span> </span>
<span id="cb44-232"><a href="#cb44-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb44-233"><a href="#cb44-233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-234"><a href="#cb44-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-235"><a href="#cb44-235" aria-hidden="true" tabindex="-1"></a>Various contrasts can be identified using **resultNames(dds)** function</span>
<span id="cb44-236"><a href="#cb44-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-237"><a href="#cb44-237" aria-hidden="true" tabindex="-1"></a>The p-value histogram after prefiltering of counts is not looking good. Therefore, I haven't done prefiltering. Supposedly, DESeq2 takes care of the low counts while identifying DEGs. Refer this link <span class="ot">&lt;http://varianceexplained.org/statistics/interpreting-pvalue-histogram/&gt;</span> for more info on p-value histograms and their interpretations.</span>
<span id="cb44-238"><a href="#cb44-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-239"><a href="#cb44-239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r creating a dds object without prefiltering again}</span></span>
<span id="cb44-240"><a href="#cb44-240" aria-hidden="true" tabindex="-1"></a><span class="co">#creation of dds object without prefiltering</span></span>
<span id="cb44-241"><a href="#cb44-241" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeqDataSetFromMatrix</span>(<span class="at">countData =</span> cts,</span>
<span id="cb44-242"><a href="#cb44-242" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colData =</span> coldata,</span>
<span id="cb44-243"><a href="#cb44-243" aria-hidden="true" tabindex="-1"></a>                              <span class="at">design =</span> <span class="sc">~</span> tissue) <span class="co">#paired design tissue + time if need to adjust for confounders (time in this case)</span></span>
<span id="cb44-244"><a href="#cb44-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-245"><a href="#cb44-245" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds)</span>
<span id="cb44-246"><a href="#cb44-246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-247"><a href="#cb44-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-248"><a href="#cb44-248" aria-hidden="true" tabindex="-1"></a><span class="fu">### PCA plot</span></span>
<span id="cb44-249"><a href="#cb44-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-250"><a href="#cb44-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r PCA plot}</span></span>
<span id="cb44-251"><a href="#cb44-251" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb44-252"><a href="#cb44-252" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb44-253"><a href="#cb44-253" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "PCA when colored by tissue and timepoint"</span></span>
<span id="cb44-254"><a href="#cb44-254" aria-hidden="true" tabindex="-1"></a>vstcounts <span class="ot">&lt;-</span> <span class="fu">vst</span>(dds, <span class="at">blind =</span> T)</span>
<span id="cb44-255"><a href="#cb44-255" aria-hidden="true" tabindex="-1"></a>normalized_cts <span class="ot">&lt;-</span> <span class="fu">assay</span>(vstcounts) <span class="sc">%&gt;%</span> <span class="fu">as.matrix</span>()</span>
<span id="cb44-256"><a href="#cb44-256" aria-hidden="true" tabindex="-1"></a>pca_prcomp <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(<span class="fu">t</span>(normalized_cts), <span class="at">center =</span> T, <span class="at">scale =</span> F)</span>
<span id="cb44-257"><a href="#cb44-257" aria-hidden="true" tabindex="-1"></a><span class="co">#names(pca_prcomp)</span></span>
<span id="cb44-258"><a href="#cb44-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-259"><a href="#cb44-259" aria-hidden="true" tabindex="-1"></a>PC1_and_PC2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">PC1 =</span> pca_prcomp<span class="sc">$</span>x[,<span class="dv">1</span>],</span>
<span id="cb44-260"><a href="#cb44-260" aria-hidden="true" tabindex="-1"></a>                          <span class="at">PC2 =</span> pca_prcomp<span class="sc">$</span>x[,<span class="dv">2</span>],</span>
<span id="cb44-261"><a href="#cb44-261" aria-hidden="true" tabindex="-1"></a>                          <span class="at">type =</span> <span class="fu">rownames</span>(pca_prcomp<span class="sc">$</span>x))</span>
<span id="cb44-262"><a href="#cb44-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-263"><a href="#cb44-263" aria-hidden="true" tabindex="-1"></a><span class="co">#using the complete normalized matrix</span></span>
<span id="cb44-264"><a href="#cb44-264" aria-hidden="true" tabindex="-1"></a><span class="co">#ggplot(PC1_and_PC2, aes(x = PC1, y = PC2, col=type)) +</span></span>
<span id="cb44-265"><a href="#cb44-265" aria-hidden="true" tabindex="-1"></a> <span class="co"># geom_point() +</span></span>
<span id="cb44-266"><a href="#cb44-266" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_text(aes(label = type), hjust = 0, vjust = 0) +</span></span>
<span id="cb44-267"><a href="#cb44-267" aria-hidden="true" tabindex="-1"></a>  <span class="co">#coord_fixed()</span></span>
<span id="cb44-268"><a href="#cb44-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-269"><a href="#cb44-269" aria-hidden="true" tabindex="-1"></a><span class="co">#using variable features</span></span>
<span id="cb44-270"><a href="#cb44-270" aria-hidden="true" tabindex="-1"></a><span class="fu">plotPCA</span>(vstcounts, <span class="at">intgroup =</span> <span class="fu">c</span>(<span class="st">"tissue"</span>,<span class="st">"time"</span>))</span>
<span id="cb44-271"><a href="#cb44-271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-272"><a href="#cb44-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-273"><a href="#cb44-273" aria-hidden="true" tabindex="-1"></a>Tissue differences contribute to bulk of variance in PC1. </span>
<span id="cb44-274"><a href="#cb44-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-275"><a href="#cb44-275" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sample correlation heatmap using vst counts</span></span>
<span id="cb44-276"><a href="#cb44-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-277"><a href="#cb44-277" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Sample correlation heatmap using vst counts}</span></span>
<span id="cb44-278"><a href="#cb44-278" aria-hidden="true" tabindex="-1"></a>sampleCor <span class="ot">&lt;-</span> <span class="fu">cor</span>(normalized_cts)</span>
<span id="cb44-279"><a href="#cb44-279" aria-hidden="true" tabindex="-1"></a>sampleDist <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">cor</span>(normalized_cts))</span>
<span id="cb44-280"><a href="#cb44-280" aria-hidden="true" tabindex="-1"></a>sampleDistMatrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(sampleDist)</span>
<span id="cb44-281"><a href="#cb44-281" aria-hidden="true" tabindex="-1"></a>blueColours <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="dv">9</span>, <span class="st">"Blues"</span>)</span>
<span id="cb44-282"><a href="#cb44-282" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">rev</span>(blueColours))(<span class="dv">255</span>)</span>
<span id="cb44-283"><a href="#cb44-283" aria-hidden="true" tabindex="-1"></a>annotation_row <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb44-284"><a href="#cb44-284" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Group =</span> <span class="fu">str_before_first</span>(<span class="fu">colnames</span>(sampleDistMatrix), <span class="st">"_"</span>)</span>
<span id="cb44-285"><a href="#cb44-285" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb44-286"><a href="#cb44-286" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(annotation_row) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(sampleDistMatrix)</span>
<span id="cb44-287"><a href="#cb44-287" aria-hidden="true" tabindex="-1"></a><span class="fu">pheatmap</span>(sampleDistMatrix,</span>
<span id="cb44-288"><a href="#cb44-288" aria-hidden="true" tabindex="-1"></a>                   <span class="at">clustering_distance_cols =</span> sampleDist, </span>
<span id="cb44-289"><a href="#cb44-289" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> colors,</span>
<span id="cb44-290"><a href="#cb44-290" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fontsize_row =</span> <span class="dv">6</span>,</span>
<span id="cb44-291"><a href="#cb44-291" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fontsize_col =</span> <span class="dv">8</span>,</span>
<span id="cb44-292"><a href="#cb44-292" aria-hidden="true" tabindex="-1"></a>                   <span class="at">annotation_row =</span> annotation_row,</span>
<span id="cb44-293"><a href="#cb44-293" aria-hidden="true" tabindex="-1"></a>                   <span class="at">cutree_rows =</span> <span class="dv">4</span></span>
<span id="cb44-294"><a href="#cb44-294" aria-hidden="true" tabindex="-1"></a>                   )</span>
<span id="cb44-295"><a href="#cb44-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-296"><a href="#cb44-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-297"><a href="#cb44-297" aria-hidden="true" tabindex="-1"></a>All the timepoint and tissue replicates cluster in 4 groups corresponding to Liver, Heart and T0,12 combinations.</span>
<span id="cb44-298"><a href="#cb44-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-299"><a href="#cb44-299" aria-hidden="true" tabindex="-1"></a><span class="fu">## Differential gene expression analysis</span></span>
<span id="cb44-300"><a href="#cb44-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-301"><a href="#cb44-301" aria-hidden="true" tabindex="-1"></a><span class="fu">### Main effects due to tissue</span></span>
<span id="cb44-302"><a href="#cb44-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-303"><a href="#cb44-303" aria-hidden="true" tabindex="-1"></a>Here, I am identifying tissue-specific (Heart versus Liver) DEGs. These DEGs would be Heart- or Liver-enriched.</span>
<span id="cb44-304"><a href="#cb44-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-305"><a href="#cb44-305" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Comparison of Wald versus LRT test DEGs [Main effects due to tissue]</span></span>
<span id="cb44-306"><a href="#cb44-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-307"><a href="#cb44-307" aria-hidden="true" tabindex="-1"></a>**DEGs can be defined genes passing the threshold: abs(logFC) \&gt; 1 &amp; padj \&lt; 0.01**</span>
<span id="cb44-308"><a href="#cb44-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-309"><a href="#cb44-309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Comparison of Wald test and LRT - tissue}</span></span>
<span id="cb44-310"><a href="#cb44-310" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb44-311"><a href="#cb44-311" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb44-312"><a href="#cb44-312" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "DEGs obtained with Wald test [Main effects due to tissue]"</span></span>
<span id="cb44-313"><a href="#cb44-313" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "DEGs obtained with paired design and with using LRT [Main effects due to tissue]"</span></span>
<span id="cb44-314"><a href="#cb44-314" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Upset plot showing the common DEGs between comparisons and enrichment directionality [Main effects due to tissue]"</span></span>
<span id="cb44-315"><a href="#cb44-315" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeqDataSetFromMatrix</span>(<span class="at">countData =</span> cts,</span>
<span id="cb44-316"><a href="#cb44-316" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colData =</span> coldata,</span>
<span id="cb44-317"><a href="#cb44-317" aria-hidden="true" tabindex="-1"></a>                              <span class="at">design =</span> <span class="sc">~</span> tissue) <span class="co">#not accounting for timepoint</span></span>
<span id="cb44-318"><a href="#cb44-318" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds)</span>
<span id="cb44-319"><a href="#cb44-319" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">results</span>(dds, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"tissue"</span>, <span class="st">"Heart"</span>, <span class="st">"Liver"</span>))</span>
<span id="cb44-320"><a href="#cb44-320" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> res1 <span class="sc">%&gt;%</span></span>
<span id="cb44-321"><a href="#cb44-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-322"><a href="#cb44-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"gene"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-323"><a href="#cb44-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(log2FoldChange,padj) <span class="sc">%&gt;%</span></span>
<span id="cb44-324"><a href="#cb44-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DEG =</span> <span class="fu">case_when</span>(log2FoldChange <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"up"</span>,</span>
<span id="cb44-325"><a href="#cb44-325" aria-hidden="true" tabindex="-1"></a>                         log2FoldChange <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"down"</span>,</span>
<span id="cb44-326"><a href="#cb44-326" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>),</span>
<span id="cb44-327"><a href="#cb44-327" aria-hidden="true" tabindex="-1"></a>         <span class="at">comparison =</span> <span class="st">"Heart_vs_Liver-Wald"</span>,</span>
<span id="cb44-328"><a href="#cb44-328" aria-hidden="true" tabindex="-1"></a>         <span class="at">enrichment =</span> <span class="fu">case_when</span>(DEG <span class="sc">==</span> <span class="st">"up"</span> <span class="sc">~</span> <span class="st">"Heart"</span>,</span>
<span id="cb44-329"><a href="#cb44-329" aria-hidden="true" tabindex="-1"></a>                                DEG <span class="sc">==</span> <span class="st">"down"</span> <span class="sc">~</span> <span class="st">"Liver"</span>,</span>
<span id="cb44-330"><a href="#cb44-330" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>))</span>
<span id="cb44-331"><a href="#cb44-331" aria-hidden="true" tabindex="-1"></a><span class="co">#res1 &lt;- add_gene_name(res1)</span></span>
<span id="cb44-332"><a href="#cb44-332" aria-hidden="true" tabindex="-1"></a>res1 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">count</span>(comparison, enrichment) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb44-333"><a href="#cb44-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-334"><a href="#cb44-334" aria-hidden="true" tabindex="-1"></a><span class="co">#LRT test</span></span>
<span id="cb44-335"><a href="#cb44-335" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeqDataSetFromMatrix</span>(<span class="at">countData =</span> cts,</span>
<span id="cb44-336"><a href="#cb44-336" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colData =</span> coldata,</span>
<span id="cb44-337"><a href="#cb44-337" aria-hidden="true" tabindex="-1"></a>                              <span class="at">design =</span> <span class="sc">~</span> tissue <span class="sc">+</span> time) <span class="co">#accounting for timepoint in design</span></span>
<span id="cb44-338"><a href="#cb44-338" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds, <span class="at">test =</span> <span class="st">"LRT"</span>, <span class="at">full =</span> <span class="sc">~</span> tissue <span class="sc">+</span> time, <span class="at">reduced =</span> <span class="sc">~</span> time)</span>
<span id="cb44-339"><a href="#cb44-339" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">results</span>(dds, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"tissue"</span>, <span class="st">"Heart"</span>, <span class="st">"Liver"</span>))</span>
<span id="cb44-340"><a href="#cb44-340" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> res2 <span class="sc">%&gt;%</span></span>
<span id="cb44-341"><a href="#cb44-341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-342"><a href="#cb44-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"gene"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-343"><a href="#cb44-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(log2FoldChange,padj) <span class="sc">%&gt;%</span></span>
<span id="cb44-344"><a href="#cb44-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DEG =</span> <span class="fu">case_when</span>(log2FoldChange <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"up"</span>,</span>
<span id="cb44-345"><a href="#cb44-345" aria-hidden="true" tabindex="-1"></a>                         log2FoldChange <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"down"</span>,</span>
<span id="cb44-346"><a href="#cb44-346" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>),</span>
<span id="cb44-347"><a href="#cb44-347" aria-hidden="true" tabindex="-1"></a>         <span class="at">comparison =</span> <span class="st">"Heart_vs_Liver-LRT"</span>,</span>
<span id="cb44-348"><a href="#cb44-348" aria-hidden="true" tabindex="-1"></a>         <span class="at">enrichment =</span> <span class="fu">case_when</span>(DEG <span class="sc">==</span> <span class="st">"up"</span> <span class="sc">~</span> <span class="st">"Heart"</span>,</span>
<span id="cb44-349"><a href="#cb44-349" aria-hidden="true" tabindex="-1"></a>                                DEG <span class="sc">==</span> <span class="st">"down"</span> <span class="sc">~</span> <span class="st">"Liver"</span>,</span>
<span id="cb44-350"><a href="#cb44-350" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>)) </span>
<span id="cb44-351"><a href="#cb44-351" aria-hidden="true" tabindex="-1"></a><span class="co">#res2 &lt;- add_gene_name(res2)</span></span>
<span id="cb44-352"><a href="#cb44-352" aria-hidden="true" tabindex="-1"></a>res2 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">count</span>(comparison, enrichment) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb44-353"><a href="#cb44-353" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">=</span> <span class="fu">rbind_common</span>(res1,res2)</span>
<span id="cb44-354"><a href="#cb44-354" aria-hidden="true" tabindex="-1"></a><span class="co">#split(res3, f = list(res3$comparison, res3$enrichment))</span></span>
<span id="cb44-355"><a href="#cb44-355" aria-hidden="true" tabindex="-1"></a><span class="co">#UpSetR::upset()</span></span>
<span id="cb44-356"><a href="#cb44-356" aria-hidden="true" tabindex="-1"></a><span class="fu">plotVenn</span>(<span class="fu">map</span>(<span class="fu">split</span>(res3, <span class="at">f =</span> <span class="fu">list</span>(res3<span class="sc">$</span>comparison, res3<span class="sc">$</span>enrichment)), <span class="cf">function</span>(x) x <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene)),</span>
<span id="cb44-357"><a href="#cb44-357" aria-hidden="true" tabindex="-1"></a>         <span class="at">use_venn =</span> F,</span>
<span id="cb44-358"><a href="#cb44-358" aria-hidden="true" tabindex="-1"></a>         <span class="at">main_text_size =</span> <span class="dv">15</span>,</span>
<span id="cb44-359"><a href="#cb44-359" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend_text_size =</span> <span class="dv">8</span>,</span>
<span id="cb44-360"><a href="#cb44-360" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend_position =</span> <span class="st">"left"</span>)</span>
<span id="cb44-361"><a href="#cb44-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-362"><a href="#cb44-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-363"><a href="#cb44-363" aria-hidden="true" tabindex="-1"></a>DEGs with and without accounting for timepoint yields similar DEGs between Wald and LRT tests suggesting that both designs are okay to detect main effects due to tissue.</span>
<span id="cb44-364"><a href="#cb44-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-365"><a href="#cb44-365" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualization of tissue-specific DEGs using DESeq2</span></span>
<span id="cb44-366"><a href="#cb44-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-367"><a href="#cb44-367" aria-hidden="true" tabindex="-1"></a>I am going with res1 object that uses Wald test to identify main effects due to tissue.</span>
<span id="cb44-368"><a href="#cb44-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-369"><a href="#cb44-369" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Identification of tissue-specific DEGs}</span></span>
<span id="cb44-370"><a href="#cb44-370" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb44-371"><a href="#cb44-371" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb44-372"><a href="#cb44-372" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Number of identified DEGs (|logFC| &gt; 1 &amp; padj &lt; 0.01)"</span></span>
<span id="cb44-373"><a href="#cb44-373" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Tissue-specific DEGs agnostic of the sampling timepoint"</span></span>
<span id="cb44-374"><a href="#cb44-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-375"><a href="#cb44-375" aria-hidden="true" tabindex="-1"></a><span class="co">#Volcano plot</span></span>
<span id="cb44-376"><a href="#cb44-376" aria-hidden="true" tabindex="-1"></a>EnhancedVolcano<span class="sc">::</span><span class="fu">EnhancedVolcano</span>(res1,</span>
<span id="cb44-377"><a href="#cb44-377" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">x =</span> <span class="st">"log2FoldChange"</span>,</span>
<span id="cb44-378"><a href="#cb44-378" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y =</span> <span class="st">"padj"</span>,</span>
<span id="cb44-379"><a href="#cb44-379" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">lab =</span> res1<span class="sc">$</span>gene,</span>
<span id="cb44-380"><a href="#cb44-380" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">pCutoff =</span> <span class="fl">0.01</span>,</span>
<span id="cb44-381"><a href="#cb44-381" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">FCcutoff =</span> <span class="dv">1</span>,</span>
<span id="cb44-382"><a href="#cb44-382" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">title =</span> <span class="st">"Heart vs Liver comparison [Single-factor design]"</span>,</span>
<span id="cb44-383"><a href="#cb44-383" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">subtitle =</span> <span class="st">"Differential expression analysis using DESeq2"</span>,</span>
<span id="cb44-384"><a href="#cb44-384" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">labSize =</span> <span class="fl">2.0</span></span>
<span id="cb44-385"><a href="#cb44-385" aria-hidden="true" tabindex="-1"></a>                                 )</span>
<span id="cb44-386"><a href="#cb44-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-387"><a href="#cb44-387" aria-hidden="true" tabindex="-1"></a><span class="co">#test this code</span></span>
<span id="cb44-388"><a href="#cb44-388" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(<span class="fu">counts</span>(dds[res1<span class="sc">$</span>gene[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], ], <span class="at">normalize =</span> <span class="cn">TRUE</span>),</span>
<span id="cb44-389"><a href="#cb44-389" aria-hidden="true" tabindex="-1"></a>          <span class="at">rownames =</span> <span class="st">'gene'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-390"><a href="#cb44-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">"sample"</span>, <span class="at">values_to =</span> <span class="st">"counts"</span>, <span class="sc">-</span>gene) <span class="sc">%&gt;%</span></span>
<span id="cb44-391"><a href="#cb44-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">as_tibble</span>(<span class="fu">colData</span>(dds), <span class="at">rownames =</span> <span class="st">"group"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-392"><a href="#cb44-392" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(name = paste0(substr(Type, 1, 5), '_', Condition, '_', 1:3)) %&gt;%</span></span>
<span id="cb44-393"><a href="#cb44-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> counts, <span class="at">fill =</span> tissue)) <span class="sc">+</span></span>
<span id="cb44-394"><a href="#cb44-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>, <span class="at">color =</span> <span class="st">"gray30"</span>) <span class="sc">+</span></span>
<span id="cb44-395"><a href="#cb44-395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> gene, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb44-396"><a href="#cb44-396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb44-397"><a href="#cb44-397" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb44-398"><a href="#cb44-398" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb44-399"><a href="#cb44-399" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb44-400"><a href="#cb44-400" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))</span>
<span id="cb44-401"><a href="#cb44-401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-402"><a href="#cb44-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-403"><a href="#cb44-403" aria-hidden="true" tabindex="-1"></a>The tissue based DEGs do not have specific pattern because enrichment can be at any tissue and timepoint combination</span>
<span id="cb44-404"><a href="#cb44-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-405"><a href="#cb44-405" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Expression pattern of top tissue-specific DEGs</span></span>
<span id="cb44-406"><a href="#cb44-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-407"><a href="#cb44-407" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Expression pattern of top tissue-specific DEGs}</span></span>
<span id="cb44-408"><a href="#cb44-408" aria-hidden="true" tabindex="-1"></a>significant_genes <span class="ot">&lt;-</span> res1 <span class="sc">%&gt;%</span></span>
<span id="cb44-409"><a href="#cb44-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-410"><a href="#cb44-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.01</span>, <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-411"><a href="#cb44-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="fu">abs</span>(log2FoldChange), <span class="at">n =</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-412"><a href="#cb44-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(gene)</span>
<span id="cb44-413"><a href="#cb44-413" aria-hidden="true" tabindex="-1"></a>sig_mat <span class="ot">&lt;-</span> normalized_cts[significant_genes,]</span>
<span id="cb44-414"><a href="#cb44-414" aria-hidden="true" tabindex="-1"></a>col_anno <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">df =</span> coldata <span class="sc">%&gt;%</span> <span class="fu">select</span>(tissue, time),</span>
<span id="cb44-415"><a href="#cb44-415" aria-hidden="true" tabindex="-1"></a>                             <span class="at">col =</span> <span class="fu">list</span>(<span class="at">tissue =</span> <span class="fu">c</span>(<span class="st">"Liver"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Heart"</span> <span class="ot">=</span> <span class="st">"blue"</span>)))</span>
<span id="cb44-416"><a href="#cb44-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-417"><a href="#cb44-417" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb44-418"><a href="#cb44-418" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb44-419"><a href="#cb44-419" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Heatmap of top 50 DEGs sorted by |logFC| (|logFC| &gt; 1 &amp; padj &lt; 0.01)"</span></span>
<span id="cb44-420"><a href="#cb44-420" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Boxplot of top 12 DEGs"</span></span>
<span id="cb44-421"><a href="#cb44-421" aria-hidden="true" tabindex="-1"></a><span class="fu">Heatmap</span>(<span class="fu">t</span>(<span class="fu">scale</span>(<span class="fu">t</span>(sig_mat))),</span>
<span id="cb44-422"><a href="#cb44-422" aria-hidden="true" tabindex="-1"></a>        <span class="at">top_annotation =</span> col_anno,</span>
<span id="cb44-423"><a href="#cb44-423" aria-hidden="true" tabindex="-1"></a>        <span class="at">show_row_names =</span> T,</span>
<span id="cb44-424"><a href="#cb44-424" aria-hidden="true" tabindex="-1"></a>        <span class="at">cluster_rows =</span> T,</span>
<span id="cb44-425"><a href="#cb44-425" aria-hidden="true" tabindex="-1"></a>        <span class="at">cluster_columns =</span> F,</span>
<span id="cb44-426"><a href="#cb44-426" aria-hidden="true" tabindex="-1"></a>        <span class="at">row_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">6</span>),</span>
<span id="cb44-427"><a href="#cb44-427" aria-hidden="true" tabindex="-1"></a>        <span class="at">column_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">7</span>),</span>
<span id="cb44-428"><a href="#cb44-428" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">"Scaled normalized</span><span class="sc">\n</span><span class="st">expression"</span></span>
<span id="cb44-429"><a href="#cb44-429" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb44-430"><a href="#cb44-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-431"><a href="#cb44-431" aria-hidden="true" tabindex="-1"></a>significant_genes <span class="ot">&lt;-</span> res1 <span class="sc">%&gt;%</span></span>
<span id="cb44-432"><a href="#cb44-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-433"><a href="#cb44-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.01</span>, <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-434"><a href="#cb44-434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="fu">abs</span>(log2FoldChange), <span class="at">n =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-435"><a href="#cb44-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(gene)</span>
<span id="cb44-436"><a href="#cb44-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-437"><a href="#cb44-437" aria-hidden="true" tabindex="-1"></a>boxplot_1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(significant_genes, <span class="cf">function</span>(x) {</span>
<span id="cb44-438"><a href="#cb44-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotCounts</span>(dds, <span class="at">gene =</span> x,</span>
<span id="cb44-439"><a href="#cb44-439" aria-hidden="true" tabindex="-1"></a>             <span class="at">intgroup =</span> <span class="fu">c</span>(<span class="st">"tissue"</span>,<span class="st">"time"</span>),</span>
<span id="cb44-440"><a href="#cb44-440" aria-hidden="true" tabindex="-1"></a>             <span class="at">returnData =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb44-441"><a href="#cb44-441" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">paste</span>(tissue,time), <span class="at">y =</span> <span class="fu">log2</span>(count), <span class="at">fill =</span> tissue)) <span class="sc">+</span></span>
<span id="cb44-442"><a href="#cb44-442" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb44-443"><a href="#cb44-443" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Experimental group"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Normalized counts"</span>) <span class="sc">+</span> </span>
<span id="cb44-444"><a href="#cb44-444" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb44-445"><a href="#cb44-445" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(x))</span>
<span id="cb44-446"><a href="#cb44-446" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb44-447"><a href="#cb44-447" aria-hidden="true" tabindex="-1"></a><span class="fu">wrap_plots</span>(boxplot_1, <span class="at">ncol =</span> <span class="dv">3</span>)                             </span>
<span id="cb44-448"><a href="#cb44-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-449"><a href="#cb44-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-450"><a href="#cb44-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-451"><a href="#cb44-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-452"><a href="#cb44-452" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Pathway analysis using the tissue-specific DEGs (Main effects) using ORA</span></span>
<span id="cb44-453"><a href="#cb44-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-456"><a href="#cb44-456" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-457"><a href="#cb44-457" aria-hidden="true" tabindex="-1"></a><span class="co"># perform pathway analysis using multiple pathway genesets</span></span>
<span id="cb44-458"><a href="#cb44-458" aria-hidden="true" tabindex="-1"></a>msigdb_gs <span class="ot">&lt;-</span> geneset<span class="sc">::</span><span class="fu">getMsigdb</span>(<span class="at">org =</span> <span class="st">"mouse"</span>, <span class="at">category =</span> <span class="st">"H"</span>)</span>
<span id="cb44-459"><a href="#cb44-459" aria-hidden="true" tabindex="-1"></a>go_gs <span class="ot">&lt;-</span> geneset<span class="sc">::</span><span class="fu">getGO</span>(<span class="at">org =</span> <span class="st">"mouse"</span>, <span class="at">ont =</span> <span class="st">"bp"</span>)</span>
<span id="cb44-460"><a href="#cb44-460" aria-hidden="true" tabindex="-1"></a>kegg_gs <span class="ot">&lt;-</span> geneset<span class="sc">::</span><span class="fu">getKEGG</span>(<span class="at">org =</span> <span class="st">"mus"</span>, <span class="at">category =</span> <span class="st">"pathway"</span>)</span>
<span id="cb44-461"><a href="#cb44-461" aria-hidden="true" tabindex="-1"></a>react_gs <span class="ot">&lt;-</span> geneset<span class="sc">::</span><span class="fu">getReactome</span>(<span class="at">org =</span> <span class="st">"mouse"</span>)</span>
<span id="cb44-462"><a href="#cb44-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-463"><a href="#cb44-463" aria-hidden="true" tabindex="-1"></a>gene_set <span class="ot">=</span> <span class="fu">list</span>(msigdb_gs, go_gs, kegg_gs, react_gs)</span>
<span id="cb44-464"><a href="#cb44-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-465"><a href="#cb44-465" aria-hidden="true" tabindex="-1"></a><span class="co">#empty lists for adding in the pathway results</span></span>
<span id="cb44-466"><a href="#cb44-466" aria-hidden="true" tabindex="-1"></a>barplots_1 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb44-467"><a href="#cb44-467" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb44-468"><a href="#cb44-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-469"><a href="#cb44-469" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gene_set)) {</span>
<span id="cb44-470"><a href="#cb44-470" aria-hidden="true" tabindex="-1"></a>  go_results1 <span class="ot">=</span> <span class="fu">safely</span>(genORA)(res1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(enrichment <span class="sc">==</span> <span class="st">"Heart"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene),</span>
<span id="cb44-471"><a href="#cb44-471" aria-hidden="true" tabindex="-1"></a>                               <span class="at">geneset =</span> gene_set[[i]],</span>
<span id="cb44-472"><a href="#cb44-472" aria-hidden="true" tabindex="-1"></a>                               <span class="at">p_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb44-473"><a href="#cb44-473" aria-hidden="true" tabindex="-1"></a>                               <span class="at">q_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb44-474"><a href="#cb44-474" aria-hidden="true" tabindex="-1"></a>                               <span class="at">universe =</span> <span class="fu">rownames</span>(res1))<span class="sc">$</span>result</span>
<span id="cb44-475"><a href="#cb44-475" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-476"><a href="#cb44-476" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results1)) {</span>
<span id="cb44-477"><a href="#cb44-477" aria-hidden="true" tabindex="-1"></a>    go_results1<span class="sc">$</span>geneset <span class="ot">=</span> gene_set[[i]]<span class="sc">$</span>type</span>
<span id="cb44-478"><a href="#cb44-478" aria-hidden="true" tabindex="-1"></a>    go_results1<span class="sc">$</span>enrichment <span class="ot">=</span> <span class="st">"Heart"</span></span>
<span id="cb44-479"><a href="#cb44-479" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-480"><a href="#cb44-480" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-481"><a href="#cb44-481" aria-hidden="true" tabindex="-1"></a>  go_results2 <span class="ot">=</span> <span class="fu">safely</span>(genORA)(res1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(enrichment <span class="sc">==</span> <span class="st">"Liver"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene),</span>
<span id="cb44-482"><a href="#cb44-482" aria-hidden="true" tabindex="-1"></a>                               <span class="at">geneset =</span> gene_set[[i]],</span>
<span id="cb44-483"><a href="#cb44-483" aria-hidden="true" tabindex="-1"></a>                               <span class="at">p_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb44-484"><a href="#cb44-484" aria-hidden="true" tabindex="-1"></a>                               <span class="at">q_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb44-485"><a href="#cb44-485" aria-hidden="true" tabindex="-1"></a>                               <span class="at">universe =</span> <span class="fu">rownames</span>(res1))<span class="sc">$</span>result</span>
<span id="cb44-486"><a href="#cb44-486" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-487"><a href="#cb44-487" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results2)) {</span>
<span id="cb44-488"><a href="#cb44-488" aria-hidden="true" tabindex="-1"></a>    go_results2<span class="sc">$</span>geneset <span class="ot">=</span> gene_set[[i]]<span class="sc">$</span>type</span>
<span id="cb44-489"><a href="#cb44-489" aria-hidden="true" tabindex="-1"></a>    go_results2<span class="sc">$</span>enrichment <span class="ot">=</span> <span class="st">"Liver"</span></span>
<span id="cb44-490"><a href="#cb44-490" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-491"><a href="#cb44-491" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-492"><a href="#cb44-492" aria-hidden="true" tabindex="-1"></a>  df1 <span class="ot">&lt;-</span> <span class="fu">rbind_common</span>(df1, go_results1, go_results2)</span>
<span id="cb44-493"><a href="#cb44-493" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-494"><a href="#cb44-494" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(go_results2)) {</span>
<span id="cb44-495"><a href="#cb44-495" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">plotEnrich</span>(go_results1,</span>
<span id="cb44-496"><a href="#cb44-496" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot_type =</span> <span class="st">"bar"</span>,</span>
<span id="cb44-497"><a href="#cb44-497" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n_term =</span> <span class="dv">10</span>,</span>
<span id="cb44-498"><a href="#cb44-498" aria-hidden="true" tabindex="-1"></a>                   <span class="at">term_metric =</span> <span class="st">"FoldEnrich"</span>,</span>
<span id="cb44-499"><a href="#cb44-499" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stats_metric =</span> <span class="st">"qvalue"</span>)</span>
<span id="cb44-500"><a href="#cb44-500" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">plotEnrich</span>(go_results2,</span>
<span id="cb44-501"><a href="#cb44-501" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot_type =</span> <span class="st">"bar"</span>,</span>
<span id="cb44-502"><a href="#cb44-502" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n_term =</span> <span class="dv">10</span>,</span>
<span id="cb44-503"><a href="#cb44-503" aria-hidden="true" tabindex="-1"></a>                   <span class="at">term_metric =</span> <span class="st">"FoldEnrich"</span>,</span>
<span id="cb44-504"><a href="#cb44-504" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stats_metric =</span> <span class="st">"qvalue"</span>)</span>
<span id="cb44-505"><a href="#cb44-505" aria-hidden="true" tabindex="-1"></a>  barplots_1[[i]] <span class="ot">&lt;-</span> p1 <span class="sc">+</span> p2</span>
<span id="cb44-506"><a href="#cb44-506" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-507"><a href="#cb44-507" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-508"><a href="#cb44-508" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-509"><a href="#cb44-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-510"><a href="#cb44-510" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb44-511"><a href="#cb44-511" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb44-512"><a href="#cb44-512" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Pathway profile across multiple databases and tissue conditions"</span></span>
<span id="cb44-513"><a href="#cb44-513" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(df1)) {df1 <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="sc">%&gt;%</span> <span class="fu">gt_preview</span>(<span class="at">top_n =</span> <span class="dv">10</span>)}</span>
<span id="cb44-514"><a href="#cb44-514" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(df1)) {</span>
<span id="cb44-515"><a href="#cb44-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tidyheatmap</span>(<span class="at">df =</span> df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p.adjust <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">p.adjust =</span> <span class="sc">-</span><span class="fu">log10</span>(p.adjust)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(geneset) <span class="sc">%&gt;%</span> <span class="fu">remove_rownames</span>(), <span class="at">color_legend_n =</span> <span class="dv">1</span>, <span class="at">color_legend_min =</span> <span class="dv">0</span>, <span class="at">color_legend_max =</span> <span class="fl">1.3</span>,<span class="at">rows =</span> Description, <span class="at">columns =</span> enrichment, <span class="at">values =</span> p.adjust, <span class="at">annotation_row =</span> geneset, <span class="at">gaps_row =</span> geneset, <span class="at">gaps_col =</span> enrichment</span>
<span id="cb44-516"><a href="#cb44-516" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb44-517"><a href="#cb44-517" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-518"><a href="#cb44-518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-519"><a href="#cb44-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-520"><a href="#cb44-520" aria-hidden="true" tabindex="-1"></a>**None of the tissue-enriched DEGs fall into significant pathways across multiple pathway databases (KEGG, GO-BP, MSigDB hallmark and Reactome) when using ORA approach along with the universe argument**</span>
<span id="cb44-521"><a href="#cb44-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-522"><a href="#cb44-522" aria-hidden="true" tabindex="-1"></a>Let's see if change of approach from ORA to GSEA lead to better results.</span>
<span id="cb44-523"><a href="#cb44-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-524"><a href="#cb44-524" aria-hidden="true" tabindex="-1"></a>ORA method is easy to conduct, but it will lose information when genes’ differences are slight. For example, if a gene is essential in some pathway but is low-expressed, it will be filtered by fold change cutoff. Unlike ORA, FCS tools do not set a threshold for differentially expressed genes. Instead, it gives each detected gene a differential expression score and then evaluates whether the scores are more positive or negative than expected by chance for each gene set.</span>
<span id="cb44-525"><a href="#cb44-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-526"><a href="#cb44-526" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Pathway analysis using the tissue-specific DEGs (Main effects) using GSEA</span></span>
<span id="cb44-527"><a href="#cb44-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-528"><a href="#cb44-528" aria-hidden="true" tabindex="-1"></a><span class="in">```{r GSEA approach using the res1 output}</span></span>
<span id="cb44-529"><a href="#cb44-529" aria-hidden="true" tabindex="-1"></a>rankedGenes <span class="ot">&lt;-</span> res1 <span class="sc">%&gt;%</span></span>
<span id="cb44-530"><a href="#cb44-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(gene, padj, log2FoldChange) <span class="sc">%&gt;%</span></span>
<span id="cb44-531"><a href="#cb44-531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="sc">-</span><span class="fu">log10</span>(pvalue) <span class="sc">*</span> <span class="fu">sign</span>(log2FoldChange),</span>
<span id="cb44-532"><a href="#cb44-532" aria-hidden="true" tabindex="-1"></a>         <span class="at">entrez =</span> <span class="fu">transId</span>(gene, <span class="at">transTo =</span> <span class="st">"entrez"</span>, <span class="at">keepNA =</span> T, <span class="at">unique =</span> T, <span class="at">org =</span> <span class="st">"mouse"</span>)<span class="sc">$</span>entrezid) <span class="sc">%&gt;%</span></span>
<span id="cb44-533"><a href="#cb44-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(rank) <span class="sc">&amp;</span> <span class="fu">is.finite</span>(rank)) <span class="sc">%&gt;%</span></span>
<span id="cb44-534"><a href="#cb44-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(rank)) <span class="sc">%&gt;%</span></span>
<span id="cb44-535"><a href="#cb44-535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(rank, gene)</span>
<span id="cb44-536"><a href="#cb44-536" aria-hidden="true" tabindex="-1"></a><span class="co">#head(rankedGenes)</span></span>
<span id="cb44-537"><a href="#cb44-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-538"><a href="#cb44-538" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb44-539"><a href="#cb44-539" aria-hidden="true" tabindex="-1"></a>barplots_1 <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb44-540"><a href="#cb44-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-541"><a href="#cb44-541" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gene_set)) {</span>
<span id="cb44-542"><a href="#cb44-542" aria-hidden="true" tabindex="-1"></a>  gsea_results1 <span class="ot">=</span> <span class="fu">safely</span>(genGSEA)(<span class="at">genelist =</span> rankedGenes,</span>
<span id="cb44-543"><a href="#cb44-543" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">p_cutoff =</span> <span class="dv">1</span>,</span>
<span id="cb44-544"><a href="#cb44-544" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">q_cutoff =</span> <span class="dv">1</span>,</span>
<span id="cb44-545"><a href="#cb44-545" aria-hidden="true" tabindex="-1"></a>                                <span class="at">geneset =</span> gene_set[[i]])<span class="sc">$</span>result</span>
<span id="cb44-546"><a href="#cb44-546" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-547"><a href="#cb44-547" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(gsea_results1<span class="sc">$</span>gsea_df)) {</span>
<span id="cb44-548"><a href="#cb44-548" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-549"><a href="#cb44-549" aria-hidden="true" tabindex="-1"></a>    barplots_1[[i]] <span class="ot">&lt;-</span> <span class="fu">plotGSEA</span>(gsea_results1, <span class="at">plot_type =</span> <span class="st">"bar"</span>, <span class="at">colour =</span> <span class="fu">c</span>(<span class="st">"navyblue"</span>, <span class="st">"orange"</span>))</span>
<span id="cb44-550"><a href="#cb44-550" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-551"><a href="#cb44-551" aria-hidden="true" tabindex="-1"></a>    df1 <span class="ot">=</span> <span class="fu">rbind_common</span>(df1, gsea_results1<span class="sc">$</span>gsea_df <span class="sc">%&gt;%</span> </span>
<span id="cb44-552"><a href="#cb44-552" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">mutate</span>(<span class="at">enrichment =</span> <span class="fu">ifelse</span>(NES <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"Heart"</span>, <span class="st">"Liver"</span>),</span>
<span id="cb44-553"><a href="#cb44-553" aria-hidden="true" tabindex="-1"></a>                                <span class="at">geneset =</span> gene_set[[i]]<span class="sc">$</span>type))</span>
<span id="cb44-554"><a href="#cb44-554" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-555"><a href="#cb44-555" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-556"><a href="#cb44-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-557"><a href="#cb44-557" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb44-558"><a href="#cb44-558" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb44-559"><a href="#cb44-559" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Pathway table across multiple databases and tissue conditions"</span></span>
<span id="cb44-560"><a href="#cb44-560" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Signficant pathways (p.adjust &lt; 0.05) identified using GSEA using multiple databases"</span></span>
<span id="cb44-561"><a href="#cb44-561" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(df1)) {df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p.adjust <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> <span class="fu">gt_preview</span>(<span class="at">top_n =</span> <span class="dv">10</span>)}</span>
<span id="cb44-562"><a href="#cb44-562" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(df1)) {</span>
<span id="cb44-563"><a href="#cb44-563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tidyheatmap</span>(<span class="at">df =</span> df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p.adjust <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">p.adjust =</span> <span class="sc">-</span><span class="fu">log10</span>(p.adjust)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(geneset) <span class="sc">%&gt;%</span> <span class="fu">remove_rownames</span>(), <span class="at">color_legend_n =</span> <span class="dv">1</span>, <span class="at">color_legend_min =</span> <span class="dv">0</span>, <span class="at">color_legend_max =</span> <span class="fl">1.3</span>,<span class="at">rows =</span> Description, <span class="at">columns =</span> enrichment, <span class="at">values =</span> p.adjust, <span class="at">annotation_row =</span> geneset, <span class="at">gaps_row =</span> geneset, <span class="at">gaps_col =</span> enrichment, <span class="at">legend_labels =</span> <span class="st">"-log10(p.adjust)"</span></span>
<span id="cb44-564"><a href="#cb44-564" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb44-565"><a href="#cb44-565" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-566"><a href="#cb44-566" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-567"><a href="#cb44-567" aria-hidden="true" tabindex="-1"></a>All the significant pathways (p.adjust &lt; 0.05) are labelled in blue color. </span>
<span id="cb44-568"><a href="#cb44-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-569"><a href="#cb44-569" aria-hidden="true" tabindex="-1"></a>**Conclusion: Liver-specific DEGs are enriched in mitochondrial, muscle biogenesis, respiration related processes across multiple databases whereas heart-specific DEGs are associated with immune, coagulation, MYC targets related processes.**</span>
<span id="cb44-570"><a href="#cb44-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-571"><a href="#cb44-571" aria-hidden="true" tabindex="-1"></a><span class="fu">### Main effects due to timepoint</span></span>
<span id="cb44-572"><a href="#cb44-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-573"><a href="#cb44-573" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Comparison of Wald versus LRT test DEGs \[Main effects due to time\]</span></span>
<span id="cb44-574"><a href="#cb44-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-575"><a href="#cb44-575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Comparison of Wald test and LRT - Timepoint}</span></span>
<span id="cb44-576"><a href="#cb44-576" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb44-577"><a href="#cb44-577" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb44-578"><a href="#cb44-578" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "DEGs obtained with Wald test [Main effects due to time]"</span></span>
<span id="cb44-579"><a href="#cb44-579" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "DEGs obtained with paired design and with using LRT [Main effects due to time]"</span></span>
<span id="cb44-580"><a href="#cb44-580" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Upset plot showing the common DEGs between comparisons and enrichment directionality [Main effects due to time]"</span></span>
<span id="cb44-581"><a href="#cb44-581" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeqDataSetFromMatrix</span>(<span class="at">countData =</span> cts,</span>
<span id="cb44-582"><a href="#cb44-582" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colData =</span> coldata,</span>
<span id="cb44-583"><a href="#cb44-583" aria-hidden="true" tabindex="-1"></a>                              <span class="at">design =</span> <span class="sc">~</span> time) <span class="co">#not accounting for timepoint</span></span>
<span id="cb44-584"><a href="#cb44-584" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds)</span>
<span id="cb44-585"><a href="#cb44-585" aria-hidden="true" tabindex="-1"></a>res4 <span class="ot">&lt;-</span> <span class="fu">results</span>(dds, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"T12"</span>, <span class="st">"T0"</span>))</span>
<span id="cb44-586"><a href="#cb44-586" aria-hidden="true" tabindex="-1"></a>res4 <span class="ot">&lt;-</span> res4 <span class="sc">%&gt;%</span></span>
<span id="cb44-587"><a href="#cb44-587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-588"><a href="#cb44-588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"gene"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-589"><a href="#cb44-589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(log2FoldChange,padj) <span class="sc">%&gt;%</span></span>
<span id="cb44-590"><a href="#cb44-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DEG =</span> <span class="fu">case_when</span>(log2FoldChange <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"up"</span>,</span>
<span id="cb44-591"><a href="#cb44-591" aria-hidden="true" tabindex="-1"></a>                         log2FoldChange <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"down"</span>,</span>
<span id="cb44-592"><a href="#cb44-592" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>),</span>
<span id="cb44-593"><a href="#cb44-593" aria-hidden="true" tabindex="-1"></a>         <span class="at">comparison =</span> <span class="st">"T12_vs_T0-Wald"</span>,</span>
<span id="cb44-594"><a href="#cb44-594" aria-hidden="true" tabindex="-1"></a>         <span class="at">enrichment =</span> <span class="fu">case_when</span>(DEG <span class="sc">==</span> <span class="st">"up"</span> <span class="sc">~</span> <span class="st">"T12"</span>,</span>
<span id="cb44-595"><a href="#cb44-595" aria-hidden="true" tabindex="-1"></a>                                DEG <span class="sc">==</span> <span class="st">"down"</span> <span class="sc">~</span> <span class="st">"T0"</span>,</span>
<span id="cb44-596"><a href="#cb44-596" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>)) </span>
<span id="cb44-597"><a href="#cb44-597" aria-hidden="true" tabindex="-1"></a><span class="co">#res4 &lt;- add_gene_name(res4)</span></span>
<span id="cb44-598"><a href="#cb44-598" aria-hidden="true" tabindex="-1"></a>res4 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">count</span>(comparison, enrichment) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb44-599"><a href="#cb44-599" aria-hidden="true" tabindex="-1"></a><span class="co">#LRT test</span></span>
<span id="cb44-600"><a href="#cb44-600" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeqDataSetFromMatrix</span>(<span class="at">countData =</span> cts,</span>
<span id="cb44-601"><a href="#cb44-601" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colData =</span> coldata,</span>
<span id="cb44-602"><a href="#cb44-602" aria-hidden="true" tabindex="-1"></a>                              <span class="at">design =</span> <span class="sc">~</span> tissue <span class="sc">+</span> time) <span class="co">#accounting for timepoint in design</span></span>
<span id="cb44-603"><a href="#cb44-603" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds, <span class="at">test =</span> <span class="st">"LRT"</span>, <span class="at">full =</span> <span class="sc">~</span> tissue <span class="sc">+</span> time, <span class="at">reduced =</span> <span class="sc">~</span> tissue)</span>
<span id="cb44-604"><a href="#cb44-604" aria-hidden="true" tabindex="-1"></a>res5 <span class="ot">&lt;-</span> <span class="fu">results</span>(dds, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"T12"</span>, <span class="st">"T0"</span>))</span>
<span id="cb44-605"><a href="#cb44-605" aria-hidden="true" tabindex="-1"></a>res5 <span class="ot">&lt;-</span> res5 <span class="sc">%&gt;%</span></span>
<span id="cb44-606"><a href="#cb44-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-607"><a href="#cb44-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"gene"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-608"><a href="#cb44-608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(log2FoldChange,padj) <span class="sc">%&gt;%</span></span>
<span id="cb44-609"><a href="#cb44-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DEG =</span> <span class="fu">case_when</span>(log2FoldChange <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"up"</span>,</span>
<span id="cb44-610"><a href="#cb44-610" aria-hidden="true" tabindex="-1"></a>                         log2FoldChange <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"down"</span>,</span>
<span id="cb44-611"><a href="#cb44-611" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>),</span>
<span id="cb44-612"><a href="#cb44-612" aria-hidden="true" tabindex="-1"></a>         <span class="at">comparison =</span> <span class="st">"T12_vs_T0-LRT"</span>,</span>
<span id="cb44-613"><a href="#cb44-613" aria-hidden="true" tabindex="-1"></a>         <span class="at">enrichment =</span> <span class="fu">case_when</span>(DEG <span class="sc">==</span> <span class="st">"up"</span> <span class="sc">~</span> <span class="st">"T12"</span>,</span>
<span id="cb44-614"><a href="#cb44-614" aria-hidden="true" tabindex="-1"></a>                                DEG <span class="sc">==</span> <span class="st">"down"</span> <span class="sc">~</span> <span class="st">"T0"</span>,</span>
<span id="cb44-615"><a href="#cb44-615" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>))</span>
<span id="cb44-616"><a href="#cb44-616" aria-hidden="true" tabindex="-1"></a><span class="co">#res5 &lt;- add_gene_name(res5)</span></span>
<span id="cb44-617"><a href="#cb44-617" aria-hidden="true" tabindex="-1"></a>res5 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">count</span>(comparison, enrichment) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb44-618"><a href="#cb44-618" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">=</span> <span class="fu">rbind_common</span>(res4,res5)</span>
<span id="cb44-619"><a href="#cb44-619" aria-hidden="true" tabindex="-1"></a><span class="co">#split(res3, f = list(res3$comparison, res3$enrichment))</span></span>
<span id="cb44-620"><a href="#cb44-620" aria-hidden="true" tabindex="-1"></a><span class="co">#UpSetR::upset()</span></span>
<span id="cb44-621"><a href="#cb44-621" aria-hidden="true" tabindex="-1"></a><span class="fu">plotVenn</span>(<span class="fu">map</span>(<span class="fu">split</span>(res3, <span class="at">f =</span> <span class="fu">list</span>(res3<span class="sc">$</span>comparison, res3<span class="sc">$</span>enrichment)), <span class="cf">function</span>(x) x <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene)),</span>
<span id="cb44-622"><a href="#cb44-622" aria-hidden="true" tabindex="-1"></a>         <span class="at">use_venn =</span> F,</span>
<span id="cb44-623"><a href="#cb44-623" aria-hidden="true" tabindex="-1"></a>         <span class="at">main_text_size =</span> <span class="dv">15</span>,</span>
<span id="cb44-624"><a href="#cb44-624" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend_text_size =</span> <span class="dv">8</span>,</span>
<span id="cb44-625"><a href="#cb44-625" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend_position =</span> <span class="st">"left"</span>)</span>
<span id="cb44-626"><a href="#cb44-626" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-627"><a href="#cb44-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-628"><a href="#cb44-628" aria-hidden="true" tabindex="-1"></a>DEGs with and without accounting for tissue yields similar DEGs between Wald and LRT tests suggesting that both designs are okay to detect main effects due to timepoints.</span>
<span id="cb44-629"><a href="#cb44-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-630"><a href="#cb44-630" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualization of timepoint-specific DEGs using DESeq2</span></span>
<span id="cb44-631"><a href="#cb44-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-632"><a href="#cb44-632" aria-hidden="true" tabindex="-1"></a>I am going with res4 object that uses Wald test to identify main effects due to tissue. Wald test DEGs are all represented in the LRT DEGs as determined by the Upset plot shown above.</span>
<span id="cb44-633"><a href="#cb44-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-634"><a href="#cb44-634" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Identification of timepoint-specific DEGs}</span></span>
<span id="cb44-635"><a href="#cb44-635" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb44-636"><a href="#cb44-636" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb44-637"><a href="#cb44-637" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Number of identified DEGs (|logFC| &gt; 1 &amp; padj &lt; 0.01)"</span></span>
<span id="cb44-638"><a href="#cb44-638" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "tissue-specific DEGs agnostic of the sampling timepoint"</span></span>
<span id="cb44-639"><a href="#cb44-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-640"><a href="#cb44-640" aria-hidden="true" tabindex="-1"></a><span class="co">#Volcano plot</span></span>
<span id="cb44-641"><a href="#cb44-641" aria-hidden="true" tabindex="-1"></a>EnhancedVolcano<span class="sc">::</span><span class="fu">EnhancedVolcano</span>(res4,</span>
<span id="cb44-642"><a href="#cb44-642" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">x =</span> <span class="st">"log2FoldChange"</span>,</span>
<span id="cb44-643"><a href="#cb44-643" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y =</span> <span class="st">"padj"</span>,</span>
<span id="cb44-644"><a href="#cb44-644" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">lab =</span> res4<span class="sc">$</span>gene,</span>
<span id="cb44-645"><a href="#cb44-645" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">pCutoff =</span> <span class="fl">0.01</span>,</span>
<span id="cb44-646"><a href="#cb44-646" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">FCcutoff =</span> <span class="dv">1</span>,</span>
<span id="cb44-647"><a href="#cb44-647" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">title =</span> <span class="st">"T12 vs T0 comparison [Single-factor design]"</span>,</span>
<span id="cb44-648"><a href="#cb44-648" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">subtitle =</span> <span class="st">"Differential expression analysis using DESeq2"</span>,</span>
<span id="cb44-649"><a href="#cb44-649" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">labSize =</span> <span class="fl">2.0</span></span>
<span id="cb44-650"><a href="#cb44-650" aria-hidden="true" tabindex="-1"></a>                                 )</span>
<span id="cb44-651"><a href="#cb44-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-652"><a href="#cb44-652" aria-hidden="true" tabindex="-1"></a><span class="co">#test this code</span></span>
<span id="cb44-653"><a href="#cb44-653" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(<span class="fu">counts</span>(dds[res4<span class="sc">$</span>gene[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], ], <span class="at">normalize =</span> <span class="cn">TRUE</span>),</span>
<span id="cb44-654"><a href="#cb44-654" aria-hidden="true" tabindex="-1"></a>          <span class="at">rownames =</span> <span class="st">'gene'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-655"><a href="#cb44-655" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">"sample"</span>, <span class="at">values_to =</span> <span class="st">"counts"</span>, <span class="sc">-</span>gene) <span class="sc">%&gt;%</span></span>
<span id="cb44-656"><a href="#cb44-656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">as_tibble</span>(<span class="fu">colData</span>(dds), <span class="at">rownames =</span> <span class="st">"group"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-657"><a href="#cb44-657" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(name = paste0(substr(Type, 1, 5), '_', Condition, '_', 1:3)) %&gt;%</span></span>
<span id="cb44-658"><a href="#cb44-658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> counts, <span class="at">fill =</span> tissue)) <span class="sc">+</span></span>
<span id="cb44-659"><a href="#cb44-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>, <span class="at">color =</span> <span class="st">"gray30"</span>) <span class="sc">+</span></span>
<span id="cb44-660"><a href="#cb44-660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> gene, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb44-661"><a href="#cb44-661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb44-662"><a href="#cb44-662" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb44-663"><a href="#cb44-663" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb44-664"><a href="#cb44-664" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb44-665"><a href="#cb44-665" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))</span>
<span id="cb44-666"><a href="#cb44-666" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-667"><a href="#cb44-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-668"><a href="#cb44-668" aria-hidden="true" tabindex="-1"></a>The timepoint based DEGs do not have specific pattern because enrichment can be at any tissue and timepoint combination</span>
<span id="cb44-669"><a href="#cb44-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-670"><a href="#cb44-670" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Expression pattern of top time-specific DEGs</span></span>
<span id="cb44-671"><a href="#cb44-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-672"><a href="#cb44-672" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Expression pattern of top time-specific DEGs}</span></span>
<span id="cb44-673"><a href="#cb44-673" aria-hidden="true" tabindex="-1"></a>significant_genes <span class="ot">&lt;-</span> res4 <span class="sc">%&gt;%</span></span>
<span id="cb44-674"><a href="#cb44-674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-675"><a href="#cb44-675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.01</span>, <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-676"><a href="#cb44-676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="fu">abs</span>(log2FoldChange), <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-677"><a href="#cb44-677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(gene)</span>
<span id="cb44-678"><a href="#cb44-678" aria-hidden="true" tabindex="-1"></a>sig_mat <span class="ot">&lt;-</span> normalized_cts[significant_genes,]</span>
<span id="cb44-679"><a href="#cb44-679" aria-hidden="true" tabindex="-1"></a>col_anno <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">df =</span> coldata <span class="sc">%&gt;%</span> <span class="fu">select</span>(tissue, time),</span>
<span id="cb44-680"><a href="#cb44-680" aria-hidden="true" tabindex="-1"></a>                             <span class="at">col =</span> <span class="fu">list</span>(<span class="at">time =</span> <span class="fu">c</span>(<span class="st">"T0"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"T12"</span> <span class="ot">=</span> <span class="st">"blue"</span>)))</span>
<span id="cb44-681"><a href="#cb44-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-682"><a href="#cb44-682" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb44-683"><a href="#cb44-683" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb44-684"><a href="#cb44-684" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Boxplot of the only DEG"</span></span>
<span id="cb44-685"><a href="#cb44-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-686"><a href="#cb44-686" aria-hidden="true" tabindex="-1"></a>significant_genes <span class="ot">&lt;-</span> res4 <span class="sc">%&gt;%</span></span>
<span id="cb44-687"><a href="#cb44-687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-688"><a href="#cb44-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.01</span>, <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-689"><a href="#cb44-689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="fu">abs</span>(log2FoldChange), <span class="at">n =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-690"><a href="#cb44-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(gene)</span>
<span id="cb44-691"><a href="#cb44-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-692"><a href="#cb44-692" aria-hidden="true" tabindex="-1"></a>boxplot_1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(significant_genes, <span class="cf">function</span>(x) {</span>
<span id="cb44-693"><a href="#cb44-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotCounts</span>(dds, <span class="at">gene =</span> x,</span>
<span id="cb44-694"><a href="#cb44-694" aria-hidden="true" tabindex="-1"></a>             <span class="at">intgroup =</span> <span class="fu">c</span>(<span class="st">"tissue"</span>,<span class="st">"time"</span>),</span>
<span id="cb44-695"><a href="#cb44-695" aria-hidden="true" tabindex="-1"></a>             <span class="at">returnData =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb44-696"><a href="#cb44-696" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">paste</span>(tissue,time), <span class="at">y =</span> <span class="fu">log2</span>(count), <span class="at">fill =</span> tissue)) <span class="sc">+</span></span>
<span id="cb44-697"><a href="#cb44-697" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb44-698"><a href="#cb44-698" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Experimental group"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Normalized counts"</span>) <span class="sc">+</span> </span>
<span id="cb44-699"><a href="#cb44-699" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb44-700"><a href="#cb44-700" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(x))</span>
<span id="cb44-701"><a href="#cb44-701" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb44-702"><a href="#cb44-702" aria-hidden="true" tabindex="-1"></a><span class="fu">wrap_plots</span>(boxplot_1, <span class="at">ncol =</span> <span class="dv">3</span>)                             </span>
<span id="cb44-703"><a href="#cb44-703" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-704"><a href="#cb44-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-705"><a href="#cb44-705" aria-hidden="true" tabindex="-1"></a>The timepoint based DEGs do not have specific pattern because enrichment can be at any tissue and timepoint combination</span>
<span id="cb44-706"><a href="#cb44-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-707"><a href="#cb44-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-708"><a href="#cb44-708" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Pathway analysis using the timepoint-specific DEGs (Main effects) using ORA</span></span>
<span id="cb44-709"><a href="#cb44-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-712"><a href="#cb44-712" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-713"><a href="#cb44-713" aria-hidden="true" tabindex="-1"></a><span class="co"># perform pathway analysis using multiple pathway genesets</span></span>
<span id="cb44-714"><a href="#cb44-714" aria-hidden="true" tabindex="-1"></a><span class="co">#empty lists for adding in the pathway results</span></span>
<span id="cb44-715"><a href="#cb44-715" aria-hidden="true" tabindex="-1"></a>barplots_1 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb44-716"><a href="#cb44-716" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb44-717"><a href="#cb44-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-718"><a href="#cb44-718" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gene_set)) {</span>
<span id="cb44-719"><a href="#cb44-719" aria-hidden="true" tabindex="-1"></a>  go_results1 <span class="ot">=</span> <span class="fu">safely</span>(genORA)(res4 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(enrichment <span class="sc">==</span> <span class="st">"T12"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene),</span>
<span id="cb44-720"><a href="#cb44-720" aria-hidden="true" tabindex="-1"></a>                               <span class="at">geneset =</span> gene_set[[i]],</span>
<span id="cb44-721"><a href="#cb44-721" aria-hidden="true" tabindex="-1"></a>                               <span class="at">p_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb44-722"><a href="#cb44-722" aria-hidden="true" tabindex="-1"></a>                               <span class="at">q_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb44-723"><a href="#cb44-723" aria-hidden="true" tabindex="-1"></a>                               <span class="at">universe =</span> <span class="fu">rownames</span>(res4))<span class="sc">$</span>result</span>
<span id="cb44-724"><a href="#cb44-724" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-725"><a href="#cb44-725" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results1)) {</span>
<span id="cb44-726"><a href="#cb44-726" aria-hidden="true" tabindex="-1"></a>    go_results1<span class="sc">$</span>geneset <span class="ot">=</span> gene_set[[i]]<span class="sc">$</span>type</span>
<span id="cb44-727"><a href="#cb44-727" aria-hidden="true" tabindex="-1"></a>    go_results1<span class="sc">$</span>enrichment <span class="ot">=</span> <span class="st">"T12"</span></span>
<span id="cb44-728"><a href="#cb44-728" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-729"><a href="#cb44-729" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-730"><a href="#cb44-730" aria-hidden="true" tabindex="-1"></a>  go_results2 <span class="ot">=</span> <span class="fu">safely</span>(genORA)(res4 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(enrichment <span class="sc">==</span> <span class="st">"T0"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene),</span>
<span id="cb44-731"><a href="#cb44-731" aria-hidden="true" tabindex="-1"></a>                               <span class="at">geneset =</span> gene_set[[i]],</span>
<span id="cb44-732"><a href="#cb44-732" aria-hidden="true" tabindex="-1"></a>                               <span class="at">p_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb44-733"><a href="#cb44-733" aria-hidden="true" tabindex="-1"></a>                               <span class="at">q_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb44-734"><a href="#cb44-734" aria-hidden="true" tabindex="-1"></a>                               <span class="at">universe =</span> <span class="fu">rownames</span>(res4))<span class="sc">$</span>result</span>
<span id="cb44-735"><a href="#cb44-735" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-736"><a href="#cb44-736" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results2)) {</span>
<span id="cb44-737"><a href="#cb44-737" aria-hidden="true" tabindex="-1"></a>    go_results2<span class="sc">$</span>geneset <span class="ot">=</span> gene_set[[i]]<span class="sc">$</span>type</span>
<span id="cb44-738"><a href="#cb44-738" aria-hidden="true" tabindex="-1"></a>    go_results2<span class="sc">$</span>enrichment <span class="ot">=</span> <span class="st">"T0"</span></span>
<span id="cb44-739"><a href="#cb44-739" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-740"><a href="#cb44-740" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-741"><a href="#cb44-741" aria-hidden="true" tabindex="-1"></a>  df1 <span class="ot">&lt;-</span> <span class="fu">rbind_common</span>(df1, go_results1, go_results2)</span>
<span id="cb44-742"><a href="#cb44-742" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-743"><a href="#cb44-743" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(go_results2)) {</span>
<span id="cb44-744"><a href="#cb44-744" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">plotEnrich</span>(go_results1,</span>
<span id="cb44-745"><a href="#cb44-745" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot_type =</span> <span class="st">"bar"</span>,</span>
<span id="cb44-746"><a href="#cb44-746" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n_term =</span> <span class="dv">10</span>,</span>
<span id="cb44-747"><a href="#cb44-747" aria-hidden="true" tabindex="-1"></a>                   <span class="at">term_metric =</span> <span class="st">"FoldEnrich"</span>,</span>
<span id="cb44-748"><a href="#cb44-748" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stats_metric =</span> <span class="st">"qvalue"</span>)</span>
<span id="cb44-749"><a href="#cb44-749" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">plotEnrich</span>(go_results2,</span>
<span id="cb44-750"><a href="#cb44-750" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot_type =</span> <span class="st">"bar"</span>,</span>
<span id="cb44-751"><a href="#cb44-751" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n_term =</span> <span class="dv">10</span>,</span>
<span id="cb44-752"><a href="#cb44-752" aria-hidden="true" tabindex="-1"></a>                   <span class="at">term_metric =</span> <span class="st">"FoldEnrich"</span>,</span>
<span id="cb44-753"><a href="#cb44-753" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stats_metric =</span> <span class="st">"qvalue"</span>)</span>
<span id="cb44-754"><a href="#cb44-754" aria-hidden="true" tabindex="-1"></a>  barplots_1[[i]] <span class="ot">&lt;-</span> p1 <span class="sc">+</span> p2</span>
<span id="cb44-755"><a href="#cb44-755" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-756"><a href="#cb44-756" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-757"><a href="#cb44-757" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-758"><a href="#cb44-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-759"><a href="#cb44-759" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plotEnrich</span>(go_results1, <span class="at">plot_type =</span> <span class="st">"dot"</span>)</span>
<span id="cb44-760"><a href="#cb44-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-761"><a href="#cb44-761" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb44-762"><a href="#cb44-762" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb44-763"><a href="#cb44-763" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Pathway enrichment stats across multiple databases and tissue conditions"</span></span>
<span id="cb44-764"><a href="#cb44-764" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Significant pathways (labelled in blue) across timepoints when using ORA and multiple pathway databases"</span></span>
<span id="cb44-765"><a href="#cb44-765" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(df1)) {df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p.adjust <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> <span class="fu">gt_preview</span>(<span class="at">top_n =</span> <span class="dv">10</span>)}</span>
<span id="cb44-766"><a href="#cb44-766" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p.adjust <span class="sc">&lt;</span> <span class="fl">0.05</span>)) <span class="sc">&gt;=</span> <span class="dv">1</span>) {</span>
<span id="cb44-767"><a href="#cb44-767" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tidyheatmap</span>(<span class="at">df =</span> df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p.adjust <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">p.adjust =</span> <span class="sc">-</span><span class="fu">log10</span>(p.adjust)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(geneset) <span class="sc">%&gt;%</span> <span class="fu">remove_rownames</span>(), <span class="at">color_legend_n =</span> <span class="dv">1</span>, <span class="at">color_legend_min =</span> <span class="dv">0</span>, <span class="at">color_legend_max =</span> <span class="fl">1.3</span>,<span class="at">rows =</span> Description, <span class="at">columns =</span> enrichment, <span class="at">values =</span> p.adjust, <span class="at">annotation_row =</span> geneset, <span class="at">gaps_row =</span> geneset, <span class="at">gaps_col =</span> enrichment, <span class="at">legend_labels =</span> <span class="st">"-log10(p.adjust)"</span></span>
<span id="cb44-768"><a href="#cb44-768" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb44-769"><a href="#cb44-769" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-770"><a href="#cb44-770" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-771"><a href="#cb44-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-772"><a href="#cb44-772" aria-hidden="true" tabindex="-1"></a>**No pathways associated with any of T0 or T12 main effect DEGs.**</span>
<span id="cb44-773"><a href="#cb44-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-774"><a href="#cb44-774" aria-hidden="true" tabindex="-1"></a>Let's see if change of approach from ORA to GSEA lead to different results.</span>
<span id="cb44-775"><a href="#cb44-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-776"><a href="#cb44-776" aria-hidden="true" tabindex="-1"></a>ORA method is easy to conduct, but it will lose information when genes’ differences are slight. For example, if a gene is essential in some pathway but is low-expressed, it will be filtered by fold change cutoff. Unlike ORA, FCS tools do not set a threshold for differentially expressed genes. Instead, it gives each detected gene a differential expression score and then evaluates whether the scores are more positive or negative than expected by chance for each gene set.</span>
<span id="cb44-777"><a href="#cb44-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-778"><a href="#cb44-778" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Pathway analysis using the tissue-specific DEGs (Main effects) using GSEA</span></span>
<span id="cb44-779"><a href="#cb44-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-780"><a href="#cb44-780" aria-hidden="true" tabindex="-1"></a><span class="in">```{r GSEA approach using the res4 output}</span></span>
<span id="cb44-781"><a href="#cb44-781" aria-hidden="true" tabindex="-1"></a>rankedGenes <span class="ot">&lt;-</span> res4 <span class="sc">%&gt;%</span></span>
<span id="cb44-782"><a href="#cb44-782" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(gene, padj, log2FoldChange) <span class="sc">%&gt;%</span></span>
<span id="cb44-783"><a href="#cb44-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="sc">-</span><span class="fu">log10</span>(pvalue) <span class="sc">*</span> <span class="fu">sign</span>(log2FoldChange),</span>
<span id="cb44-784"><a href="#cb44-784" aria-hidden="true" tabindex="-1"></a>         <span class="at">entrez =</span> <span class="fu">transId</span>(gene, <span class="at">transTo =</span> <span class="st">"entrez"</span>, <span class="at">keepNA =</span> T, <span class="at">unique =</span> T, <span class="at">org =</span> <span class="st">"mouse"</span>)<span class="sc">$</span>entrezid) <span class="sc">%&gt;%</span></span>
<span id="cb44-785"><a href="#cb44-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(rank) <span class="sc">&amp;</span> <span class="fu">is.finite</span>(rank)) <span class="sc">%&gt;%</span></span>
<span id="cb44-786"><a href="#cb44-786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(rank)) <span class="sc">%&gt;%</span></span>
<span id="cb44-787"><a href="#cb44-787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(rank, gene)</span>
<span id="cb44-788"><a href="#cb44-788" aria-hidden="true" tabindex="-1"></a><span class="co">#head(rankedGenes)</span></span>
<span id="cb44-789"><a href="#cb44-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-790"><a href="#cb44-790" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb44-791"><a href="#cb44-791" aria-hidden="true" tabindex="-1"></a>barplots_1 <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb44-792"><a href="#cb44-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-793"><a href="#cb44-793" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gene_set)) {</span>
<span id="cb44-794"><a href="#cb44-794" aria-hidden="true" tabindex="-1"></a>  gsea_results1 <span class="ot">=</span> <span class="fu">safely</span>(genGSEA)(<span class="at">genelist =</span> rankedGenes,</span>
<span id="cb44-795"><a href="#cb44-795" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">p_cutoff =</span> <span class="dv">1</span>,</span>
<span id="cb44-796"><a href="#cb44-796" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">q_cutoff =</span> <span class="dv">1</span>,</span>
<span id="cb44-797"><a href="#cb44-797" aria-hidden="true" tabindex="-1"></a>                                <span class="at">geneset =</span> gene_set[[i]])<span class="sc">$</span>result</span>
<span id="cb44-798"><a href="#cb44-798" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-799"><a href="#cb44-799" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(gsea_results1<span class="sc">$</span>gsea_df)) {</span>
<span id="cb44-800"><a href="#cb44-800" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-801"><a href="#cb44-801" aria-hidden="true" tabindex="-1"></a>    barplots_1[[i]] <span class="ot">&lt;-</span> <span class="fu">plotGSEA</span>(gsea_results1, <span class="at">plot_type =</span> <span class="st">"bar"</span>, <span class="at">colour =</span> <span class="fu">c</span>(<span class="st">"navyblue"</span>, <span class="st">"orange"</span>))</span>
<span id="cb44-802"><a href="#cb44-802" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-803"><a href="#cb44-803" aria-hidden="true" tabindex="-1"></a>    df1 <span class="ot">=</span> <span class="fu">rbind_common</span>(df1, gsea_results1<span class="sc">$</span>gsea_df <span class="sc">%&gt;%</span> </span>
<span id="cb44-804"><a href="#cb44-804" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">mutate</span>(<span class="at">enrichment =</span> <span class="fu">ifelse</span>(NES <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"T12"</span>, <span class="st">"T0"</span>),</span>
<span id="cb44-805"><a href="#cb44-805" aria-hidden="true" tabindex="-1"></a>                                <span class="at">geneset =</span> gene_set[[i]]<span class="sc">$</span>type))</span>
<span id="cb44-806"><a href="#cb44-806" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-807"><a href="#cb44-807" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-808"><a href="#cb44-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-809"><a href="#cb44-809" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb44-810"><a href="#cb44-810" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb44-811"><a href="#cb44-811" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Pathway table across multiple databases and tissue conditions"</span></span>
<span id="cb44-812"><a href="#cb44-812" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Signficant pathways (p.adjust &lt; 0.01) identified using GSEA using multiple databases"</span></span>
<span id="cb44-813"><a href="#cb44-813" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(df1)) {df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p.adjust <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> <span class="fu">gt_preview</span>(<span class="at">top_n =</span> <span class="dv">10</span>)}</span>
<span id="cb44-814"><a href="#cb44-814" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(df1)) {</span>
<span id="cb44-815"><a href="#cb44-815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tidyheatmap</span>(<span class="at">df =</span> df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p.adjust <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">p.adjust =</span> <span class="sc">-</span><span class="fu">log10</span>(p.adjust)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(geneset) <span class="sc">%&gt;%</span> <span class="fu">remove_rownames</span>(), <span class="at">color_legend_n =</span> <span class="dv">1</span>, <span class="at">color_legend_min =</span> <span class="dv">0</span>, <span class="at">color_legend_max =</span> <span class="fl">1.3</span>,<span class="at">rows =</span> Description, <span class="at">columns =</span> enrichment, <span class="at">values =</span> p.adjust, <span class="at">annotation_row =</span> geneset, <span class="at">gaps_row =</span> geneset, <span class="at">gaps_col =</span> enrichment, <span class="at">legend_labels =</span> <span class="st">"-log10(p.adjust)"</span></span>
<span id="cb44-816"><a href="#cb44-816" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb44-817"><a href="#cb44-817" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-818"><a href="#cb44-818" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-819"><a href="#cb44-819" aria-hidden="true" tabindex="-1"></a>All the significant pathways (p.adjust &lt; 0.01) are labelled in blue color. </span>
<span id="cb44-820"><a href="#cb44-820" aria-hidden="true" tabindex="-1"></a>To beautify the output and the plots, I resorted to a stricter cutoff for pathways i.e. p.adjust &lt; 0.01 instead of p.adjust &lt; 0.05</span>
<span id="cb44-821"><a href="#cb44-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-822"><a href="#cb44-822" aria-hidden="true" tabindex="-1"></a>**Conclusion: T0-enriched DEGs fell into MYC targets, MTORC1 signaling pathways when using multiple pathway databases (KEGG, GO-BP, MSigDB hallmark and Reactome) when using GSEA approach. GSEA approach also confirmed the findings from the ORA approach. In addition, T12 associated pathways belong to chromatin remodeling, histone modification, KRAS and other pathway terms. The statistically robust approach GSEA is able to identify more pathways compared to ORA which is surprising.**</span>
<span id="cb44-823"><a href="#cb44-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-824"><a href="#cb44-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-825"><a href="#cb44-825" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interaction effects</span></span>
<span id="cb44-826"><a href="#cb44-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-827"><a href="#cb44-827" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Comparison of Wald versus LRT test - interaction effects</span></span>
<span id="cb44-828"><a href="#cb44-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-829"><a href="#cb44-829" aria-hidden="true" tabindex="-1"></a>**DEGs can be defined genes passing the threshold: abs(logFC) \&gt; 1 &amp; padj \&lt; 0.01**</span>
<span id="cb44-830"><a href="#cb44-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-831"><a href="#cb44-831" aria-hidden="true" tabindex="-1"></a>This is useful to detect interaction between tissue and timepoint. </span>
<span id="cb44-832"><a href="#cb44-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-833"><a href="#cb44-833" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Comparison of Wald test and LRT - interaction effects}</span></span>
<span id="cb44-834"><a href="#cb44-834" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb44-835"><a href="#cb44-835" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb44-836"><a href="#cb44-836" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "DEGs obtained with Wald test [Main effects due to tissue]"</span></span>
<span id="cb44-837"><a href="#cb44-837" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "DEGs obtained with paired design and with using LRT [Main effects due to tissue]"</span></span>
<span id="cb44-838"><a href="#cb44-838" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Upset plot showing the common DEGs between comparisons and enrichment directionality [Main effects due to tissue]"</span></span>
<span id="cb44-839"><a href="#cb44-839" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeqDataSetFromMatrix</span>(<span class="at">countData =</span> cts,</span>
<span id="cb44-840"><a href="#cb44-840" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colData =</span> coldata,</span>
<span id="cb44-841"><a href="#cb44-841" aria-hidden="true" tabindex="-1"></a>                              <span class="at">design =</span> <span class="sc">~</span> tissue <span class="sc">*</span> time) <span class="co">#interaction term</span></span>
<span id="cb44-842"><a href="#cb44-842" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds)</span>
<span id="cb44-843"><a href="#cb44-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-844"><a href="#cb44-844" aria-hidden="true" tabindex="-1"></a><span class="co">#vd &lt;- VisualizeDesign(sampleData = coldata,</span></span>
<span id="cb44-845"><a href="#cb44-845" aria-hidden="true" tabindex="-1"></a> <span class="co">#                     designFormula = ~ tissue * time)</span></span>
<span id="cb44-846"><a href="#cb44-846" aria-hidden="true" tabindex="-1"></a><span class="co">#print(vd$plotlist) #can visualize the model matrix and the various coefficients</span></span>
<span id="cb44-847"><a href="#cb44-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-848"><a href="#cb44-848" aria-hidden="true" tabindex="-1"></a>res6 <span class="ot">&lt;-</span> <span class="fu">results</span>(dds, <span class="at">name =</span> <span class="st">"tissueLiver.timeT12"</span>)</span>
<span id="cb44-849"><a href="#cb44-849" aria-hidden="true" tabindex="-1"></a>res6 <span class="ot">&lt;-</span> res6 <span class="sc">%&gt;%</span></span>
<span id="cb44-850"><a href="#cb44-850" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-851"><a href="#cb44-851" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"gene"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-852"><a href="#cb44-852" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(log2FoldChange,padj) <span class="sc">%&gt;%</span></span>
<span id="cb44-853"><a href="#cb44-853" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DEG =</span> <span class="fu">case_when</span>(log2FoldChange <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"up"</span>,</span>
<span id="cb44-854"><a href="#cb44-854" aria-hidden="true" tabindex="-1"></a>                         log2FoldChange <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"down"</span>,</span>
<span id="cb44-855"><a href="#cb44-855" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>),</span>
<span id="cb44-856"><a href="#cb44-856" aria-hidden="true" tabindex="-1"></a>         <span class="at">comparison =</span> <span class="st">"Interaction-Wald"</span>,</span>
<span id="cb44-857"><a href="#cb44-857" aria-hidden="true" tabindex="-1"></a>         <span class="at">enrichment =</span> <span class="fu">case_when</span>(DEG <span class="sc">==</span> <span class="st">"up"</span> <span class="sc">~</span> <span class="st">"Heart"</span>,</span>
<span id="cb44-858"><a href="#cb44-858" aria-hidden="true" tabindex="-1"></a>                                DEG <span class="sc">==</span> <span class="st">"down"</span> <span class="sc">~</span> <span class="st">"Liver"</span>,</span>
<span id="cb44-859"><a href="#cb44-859" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>)) </span>
<span id="cb44-860"><a href="#cb44-860" aria-hidden="true" tabindex="-1"></a><span class="co">#res6 &lt;- add_gene_name(res6)</span></span>
<span id="cb44-861"><a href="#cb44-861" aria-hidden="true" tabindex="-1"></a>res6 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">count</span>(comparison, enrichment) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb44-862"><a href="#cb44-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-863"><a href="#cb44-863" aria-hidden="true" tabindex="-1"></a><span class="co">#LRT test</span></span>
<span id="cb44-864"><a href="#cb44-864" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeqDataSetFromMatrix</span>(<span class="at">countData =</span> cts,</span>
<span id="cb44-865"><a href="#cb44-865" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colData =</span> coldata,</span>
<span id="cb44-866"><a href="#cb44-866" aria-hidden="true" tabindex="-1"></a>                              <span class="at">design =</span> <span class="sc">~</span> tissue <span class="sc">*</span> time) <span class="co">#accounting for timepoint in design</span></span>
<span id="cb44-867"><a href="#cb44-867" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds, <span class="at">test =</span> <span class="st">"LRT"</span>, <span class="at">full =</span> <span class="sc">~</span> tissue <span class="sc">*</span> time, <span class="at">reduced =</span> <span class="sc">~</span> tissue <span class="sc">+</span> time)</span>
<span id="cb44-868"><a href="#cb44-868" aria-hidden="true" tabindex="-1"></a>res7 <span class="ot">&lt;-</span> <span class="fu">results</span>(dds, <span class="at">name =</span> <span class="st">"tissueLiver.timeT12"</span>)</span>
<span id="cb44-869"><a href="#cb44-869" aria-hidden="true" tabindex="-1"></a>res7 <span class="ot">&lt;-</span> res7 <span class="sc">%&gt;%</span></span>
<span id="cb44-870"><a href="#cb44-870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-871"><a href="#cb44-871" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"gene"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-872"><a href="#cb44-872" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(log2FoldChange,padj) <span class="sc">%&gt;%</span></span>
<span id="cb44-873"><a href="#cb44-873" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DEG =</span> <span class="fu">case_when</span>(log2FoldChange <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"up"</span>,</span>
<span id="cb44-874"><a href="#cb44-874" aria-hidden="true" tabindex="-1"></a>                         log2FoldChange <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"down"</span>,</span>
<span id="cb44-875"><a href="#cb44-875" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>),</span>
<span id="cb44-876"><a href="#cb44-876" aria-hidden="true" tabindex="-1"></a>         <span class="at">comparison =</span> <span class="st">"Interaction-LRT"</span>,</span>
<span id="cb44-877"><a href="#cb44-877" aria-hidden="true" tabindex="-1"></a>         <span class="at">enrichment =</span> <span class="fu">case_when</span>(DEG <span class="sc">==</span> <span class="st">"up"</span> <span class="sc">~</span> <span class="st">"Heart"</span>,</span>
<span id="cb44-878"><a href="#cb44-878" aria-hidden="true" tabindex="-1"></a>                                DEG <span class="sc">==</span> <span class="st">"down"</span> <span class="sc">~</span> <span class="st">"Liver"</span>,</span>
<span id="cb44-879"><a href="#cb44-879" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>)) </span>
<span id="cb44-880"><a href="#cb44-880" aria-hidden="true" tabindex="-1"></a><span class="co">#res7 &lt;- add_gene_name(res7)</span></span>
<span id="cb44-881"><a href="#cb44-881" aria-hidden="true" tabindex="-1"></a>res7 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">count</span>(comparison, enrichment) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb44-882"><a href="#cb44-882" aria-hidden="true" tabindex="-1"></a>res8 <span class="ot">=</span> <span class="fu">rbind_common</span>(res6,res7)</span>
<span id="cb44-883"><a href="#cb44-883" aria-hidden="true" tabindex="-1"></a><span class="co">#split(res3, f = list(res3$comparison, res3$enrichment))</span></span>
<span id="cb44-884"><a href="#cb44-884" aria-hidden="true" tabindex="-1"></a><span class="co">#UpSetR::upset()</span></span>
<span id="cb44-885"><a href="#cb44-885" aria-hidden="true" tabindex="-1"></a><span class="fu">plotVenn</span>(<span class="fu">map</span>(<span class="fu">split</span>(res8, <span class="at">f =</span> <span class="fu">list</span>(res8<span class="sc">$</span>comparison, res8<span class="sc">$</span>enrichment)), <span class="cf">function</span>(x) x <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene)),</span>
<span id="cb44-886"><a href="#cb44-886" aria-hidden="true" tabindex="-1"></a>         <span class="at">use_venn =</span> F,</span>
<span id="cb44-887"><a href="#cb44-887" aria-hidden="true" tabindex="-1"></a>         <span class="at">main_text_size =</span> <span class="dv">15</span>,</span>
<span id="cb44-888"><a href="#cb44-888" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend_text_size =</span> <span class="dv">8</span>,</span>
<span id="cb44-889"><a href="#cb44-889" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend_position =</span> <span class="st">"left"</span>)</span>
<span id="cb44-890"><a href="#cb44-890" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-891"><a href="#cb44-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-892"><a href="#cb44-892" aria-hidden="true" tabindex="-1"></a>**No DEGs were identified using the interaction design.**</span>
<span id="cb44-893"><a href="#cb44-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-894"><a href="#cb44-894" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualization of interaction-specific DEGs using DESeq2</span></span>
<span id="cb44-895"><a href="#cb44-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-896"><a href="#cb44-896" aria-hidden="true" tabindex="-1"></a>I am going with res6 object that uses Wald test to identify main effects due to tissue. Wald test DEGs are all represented in the LRT DEGs as determined by the previous Upset plot</span>
<span id="cb44-897"><a href="#cb44-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-898"><a href="#cb44-898" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Identification of interaction-specific DEGs}</span></span>
<span id="cb44-899"><a href="#cb44-899" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb44-900"><a href="#cb44-900" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb44-901"><a href="#cb44-901" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Number of identified DEGs (|logFC| &gt; 1 &amp; padj &lt; 0.01)"</span></span>
<span id="cb44-902"><a href="#cb44-902" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "tissue-specific DEGs agnostic of the sampling timepoint"</span></span>
<span id="cb44-903"><a href="#cb44-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-904"><a href="#cb44-904" aria-hidden="true" tabindex="-1"></a><span class="co">#Volcano plot</span></span>
<span id="cb44-905"><a href="#cb44-905" aria-hidden="true" tabindex="-1"></a>EnhancedVolcano<span class="sc">::</span><span class="fu">EnhancedVolcano</span>(res6,</span>
<span id="cb44-906"><a href="#cb44-906" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">x =</span> <span class="st">"log2FoldChange"</span>,</span>
<span id="cb44-907"><a href="#cb44-907" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y =</span> <span class="st">"padj"</span>,</span>
<span id="cb44-908"><a href="#cb44-908" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">lab =</span> res6<span class="sc">$</span>gene,</span>
<span id="cb44-909"><a href="#cb44-909" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">pCutoff =</span> <span class="fl">0.01</span>,</span>
<span id="cb44-910"><a href="#cb44-910" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">FCcutoff =</span> <span class="dv">1</span>,</span>
<span id="cb44-911"><a href="#cb44-911" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">title =</span> <span class="st">"comparison [Interaction effect]"</span>,</span>
<span id="cb44-912"><a href="#cb44-912" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">subtitle =</span> <span class="st">"Differential expression analysis using DESeq2"</span>,</span>
<span id="cb44-913"><a href="#cb44-913" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">labSize =</span> <span class="fl">2.0</span></span>
<span id="cb44-914"><a href="#cb44-914" aria-hidden="true" tabindex="-1"></a>                                 )</span>
<span id="cb44-915"><a href="#cb44-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-916"><a href="#cb44-916" aria-hidden="true" tabindex="-1"></a><span class="co">#test this code</span></span>
<span id="cb44-917"><a href="#cb44-917" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(<span class="fu">counts</span>(dds[res6<span class="sc">$</span>gene[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], ], <span class="at">normalize =</span> <span class="cn">TRUE</span>),</span>
<span id="cb44-918"><a href="#cb44-918" aria-hidden="true" tabindex="-1"></a>          <span class="at">rownames =</span> <span class="st">'gene'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-919"><a href="#cb44-919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">"sample"</span>, <span class="at">values_to =</span> <span class="st">"counts"</span>, <span class="sc">-</span>gene) <span class="sc">%&gt;%</span></span>
<span id="cb44-920"><a href="#cb44-920" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">as_tibble</span>(<span class="fu">colData</span>(dds), <span class="at">rownames =</span> <span class="st">"group"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-921"><a href="#cb44-921" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(name = paste0(substr(Type, 1, 5), '_', Condition, '_', 1:3)) %&gt;%</span></span>
<span id="cb44-922"><a href="#cb44-922" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> counts, <span class="at">fill =</span> tissue)) <span class="sc">+</span></span>
<span id="cb44-923"><a href="#cb44-923" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>, <span class="at">color =</span> <span class="st">"gray30"</span>) <span class="sc">+</span></span>
<span id="cb44-924"><a href="#cb44-924" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> gene, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb44-925"><a href="#cb44-925" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb44-926"><a href="#cb44-926" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb44-927"><a href="#cb44-927" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb44-928"><a href="#cb44-928" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb44-929"><a href="#cb44-929" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))</span>
<span id="cb44-930"><a href="#cb44-930" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-931"><a href="#cb44-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-932"><a href="#cb44-932" aria-hidden="true" tabindex="-1"></a>The timepoint based DEGs do not have specific pattern because enrichment can be at any tissue and timepoint combination</span>
<span id="cb44-933"><a href="#cb44-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-934"><a href="#cb44-934" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Expression pattern of top interaction-specific DEGs</span></span>
<span id="cb44-935"><a href="#cb44-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-936"><a href="#cb44-936" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Expression pattern of top interaction-specific DEGs}</span></span>
<span id="cb44-937"><a href="#cb44-937" aria-hidden="true" tabindex="-1"></a>significant_genes <span class="ot">&lt;-</span> res6 <span class="sc">%&gt;%</span></span>
<span id="cb44-938"><a href="#cb44-938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-939"><a href="#cb44-939" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.01</span>, <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-940"><a href="#cb44-940" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="fu">abs</span>(log2FoldChange), <span class="at">n =</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-941"><a href="#cb44-941" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(gene)</span>
<span id="cb44-942"><a href="#cb44-942" aria-hidden="true" tabindex="-1"></a>sig_mat <span class="ot">&lt;-</span> normalized_cts[significant_genes,]</span>
<span id="cb44-943"><a href="#cb44-943" aria-hidden="true" tabindex="-1"></a>col_anno <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">df =</span> coldata <span class="sc">%&gt;%</span> <span class="fu">select</span>(tissue, time),</span>
<span id="cb44-944"><a href="#cb44-944" aria-hidden="true" tabindex="-1"></a>                             <span class="at">col =</span> <span class="fu">list</span>(<span class="at">time =</span> <span class="fu">c</span>(<span class="st">"T0"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"T12"</span> <span class="ot">=</span> <span class="st">"blue"</span>)))</span>
<span id="cb44-945"><a href="#cb44-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-946"><a href="#cb44-946" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb44-947"><a href="#cb44-947" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb44-948"><a href="#cb44-948" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Heatmap of top 50 DEGs sorted by |logFC| (|logFC| &gt; 1 &amp; padj &lt; 0.01)"</span></span>
<span id="cb44-949"><a href="#cb44-949" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Boxplot of top 12 DEGs"</span></span>
<span id="cb44-950"><a href="#cb44-950" aria-hidden="true" tabindex="-1"></a><span class="fu">Heatmap</span>(<span class="fu">t</span>(<span class="fu">scale</span>(<span class="fu">t</span>(sig_mat))),</span>
<span id="cb44-951"><a href="#cb44-951" aria-hidden="true" tabindex="-1"></a>        <span class="at">top_annotation =</span> col_anno,</span>
<span id="cb44-952"><a href="#cb44-952" aria-hidden="true" tabindex="-1"></a>        <span class="at">show_row_names =</span> T,</span>
<span id="cb44-953"><a href="#cb44-953" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">"Scaled normalized</span><span class="sc">\n</span><span class="st">expression"</span>,</span>
<span id="cb44-954"><a href="#cb44-954" aria-hidden="true" tabindex="-1"></a>        <span class="at">row_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">6</span>),</span>
<span id="cb44-955"><a href="#cb44-955" aria-hidden="true" tabindex="-1"></a>        <span class="at">column_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">7</span>)</span>
<span id="cb44-956"><a href="#cb44-956" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb44-957"><a href="#cb44-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-958"><a href="#cb44-958" aria-hidden="true" tabindex="-1"></a>significant_genes <span class="ot">&lt;-</span> res6 <span class="sc">%&gt;%</span></span>
<span id="cb44-959"><a href="#cb44-959" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-960"><a href="#cb44-960" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.01</span>, <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-961"><a href="#cb44-961" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="fu">abs</span>(log2FoldChange), <span class="at">n =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-962"><a href="#cb44-962" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(gene)</span>
<span id="cb44-963"><a href="#cb44-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-964"><a href="#cb44-964" aria-hidden="true" tabindex="-1"></a>boxplot_1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(significant_genes, <span class="cf">function</span>(x) {</span>
<span id="cb44-965"><a href="#cb44-965" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotCounts</span>(dds, <span class="at">gene =</span> x,</span>
<span id="cb44-966"><a href="#cb44-966" aria-hidden="true" tabindex="-1"></a>             <span class="at">intgroup =</span> <span class="fu">c</span>(<span class="st">"tissue"</span>,<span class="st">"time"</span>),</span>
<span id="cb44-967"><a href="#cb44-967" aria-hidden="true" tabindex="-1"></a>             <span class="at">returnData =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb44-968"><a href="#cb44-968" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">paste</span>(tissue,time), <span class="at">y =</span> <span class="fu">log2</span>(count), <span class="at">fill =</span> tissue)) <span class="sc">+</span></span>
<span id="cb44-969"><a href="#cb44-969" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb44-970"><a href="#cb44-970" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Experimental group"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Normalized counts"</span>) <span class="sc">+</span> </span>
<span id="cb44-971"><a href="#cb44-971" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb44-972"><a href="#cb44-972" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(x))</span>
<span id="cb44-973"><a href="#cb44-973" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb44-974"><a href="#cb44-974" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(boxplot_1) <span class="sc">&gt;=</span> <span class="dv">1</span>) { <span class="fu">wrap_plots</span>(boxplot_1)}                             </span>
<span id="cb44-975"><a href="#cb44-975" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-976"><a href="#cb44-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-977"><a href="#cb44-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-978"><a href="#cb44-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-979"><a href="#cb44-979" aria-hidden="true" tabindex="-1"></a><span class="fu">## Paired contrast analysis - Difference between Liver and Heart at each timepoint</span></span>
<span id="cb44-980"><a href="#cb44-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-981"><a href="#cb44-981" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Identification of DEGs between Liver and Heart for every timepoint}</span></span>
<span id="cb44-982"><a href="#cb44-982" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb44-983"><a href="#cb44-983" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb44-984"><a href="#cb44-984" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Number of identified DEGs (|logFC| &gt; 1 &amp; padj &lt; 0.01) by comparing Heart versus Liver at time T0"</span></span>
<span id="cb44-985"><a href="#cb44-985" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Number of identified DEGs (|logFC| &gt; 1 &amp; padj &lt; 0.01) by comparing Heart versus Liver at time T12"</span></span>
<span id="cb44-986"><a href="#cb44-986" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Upset plot showing overlap between DEGs"</span></span>
<span id="cb44-987"><a href="#cb44-987" aria-hidden="true" tabindex="-1"></a>coldata<span class="sc">$</span>group <span class="ot">=</span> <span class="fu">paste0</span>(coldata<span class="sc">$</span>tissue, <span class="st">"_"</span>, coldata<span class="sc">$</span>time)</span>
<span id="cb44-988"><a href="#cb44-988" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeqDataSetFromMatrix</span>(<span class="at">countData =</span> cts,</span>
<span id="cb44-989"><a href="#cb44-989" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colData =</span> coldata,</span>
<span id="cb44-990"><a href="#cb44-990" aria-hidden="true" tabindex="-1"></a>                              <span class="at">design =</span> <span class="sc">~</span> group)</span>
<span id="cb44-991"><a href="#cb44-991" aria-hidden="true" tabindex="-1"></a>dds <span class="ot">&lt;-</span> <span class="fu">DESeq</span>(dds)</span>
<span id="cb44-992"><a href="#cb44-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-993"><a href="#cb44-993" aria-hidden="true" tabindex="-1"></a><span class="co">#Comparison between Heart and Liver at time T0</span></span>
<span id="cb44-994"><a href="#cb44-994" aria-hidden="true" tabindex="-1"></a>res9 <span class="ot">&lt;-</span> <span class="fu">results</span>(dds, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"group"</span>, <span class="st">"Heart_T0"</span>, <span class="st">"Liver_T0"</span>))</span>
<span id="cb44-995"><a href="#cb44-995" aria-hidden="true" tabindex="-1"></a>res9 <span class="ot">&lt;-</span> res9 <span class="sc">%&gt;%</span></span>
<span id="cb44-996"><a href="#cb44-996" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-997"><a href="#cb44-997" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"gene"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-998"><a href="#cb44-998" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(log2FoldChange,padj) <span class="sc">%&gt;%</span></span>
<span id="cb44-999"><a href="#cb44-999" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DEG =</span> <span class="fu">case_when</span>(log2FoldChange <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"up"</span>,</span>
<span id="cb44-1000"><a href="#cb44-1000" aria-hidden="true" tabindex="-1"></a>                         log2FoldChange <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"down"</span>,</span>
<span id="cb44-1001"><a href="#cb44-1001" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>),</span>
<span id="cb44-1002"><a href="#cb44-1002" aria-hidden="true" tabindex="-1"></a>         <span class="at">comparison =</span> <span class="st">"Heart_vs_Liver-Time0-LRT"</span>,</span>
<span id="cb44-1003"><a href="#cb44-1003" aria-hidden="true" tabindex="-1"></a>         <span class="at">enrichment =</span> <span class="fu">case_when</span>(DEG <span class="sc">==</span> <span class="st">"up"</span> <span class="sc">~</span> <span class="st">"Heart_T0"</span>,</span>
<span id="cb44-1004"><a href="#cb44-1004" aria-hidden="true" tabindex="-1"></a>                                DEG <span class="sc">==</span> <span class="st">"down"</span> <span class="sc">~</span> <span class="st">"Liver_T0"</span>,</span>
<span id="cb44-1005"><a href="#cb44-1005" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>))</span>
<span id="cb44-1006"><a href="#cb44-1006" aria-hidden="true" tabindex="-1"></a>res9 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">count</span>(comparison, enrichment) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb44-1007"><a href="#cb44-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1008"><a href="#cb44-1008" aria-hidden="true" tabindex="-1"></a><span class="co">#Comparison between Heart and Liver at time T12</span></span>
<span id="cb44-1009"><a href="#cb44-1009" aria-hidden="true" tabindex="-1"></a>res10 <span class="ot">&lt;-</span> <span class="fu">results</span>(dds, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">"group"</span>, <span class="st">"Heart_T12"</span>, <span class="st">"Liver_T12"</span>))</span>
<span id="cb44-1010"><a href="#cb44-1010" aria-hidden="true" tabindex="-1"></a>res10 <span class="ot">&lt;-</span> res10 <span class="sc">%&gt;%</span></span>
<span id="cb44-1011"><a href="#cb44-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-1012"><a href="#cb44-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"gene"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-1013"><a href="#cb44-1013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(log2FoldChange,padj) <span class="sc">%&gt;%</span></span>
<span id="cb44-1014"><a href="#cb44-1014" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DEG =</span> <span class="fu">case_when</span>(log2FoldChange <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"up"</span>,</span>
<span id="cb44-1015"><a href="#cb44-1015" aria-hidden="true" tabindex="-1"></a>                         log2FoldChange <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"down"</span>,</span>
<span id="cb44-1016"><a href="#cb44-1016" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>),</span>
<span id="cb44-1017"><a href="#cb44-1017" aria-hidden="true" tabindex="-1"></a>         <span class="at">comparison =</span> <span class="st">"Heart_vs_Liver-Time12-LRT"</span>,</span>
<span id="cb44-1018"><a href="#cb44-1018" aria-hidden="true" tabindex="-1"></a>         <span class="at">enrichment =</span> <span class="fu">case_when</span>(DEG <span class="sc">==</span> <span class="st">"up"</span> <span class="sc">~</span> <span class="st">"Heart_T12"</span>,</span>
<span id="cb44-1019"><a href="#cb44-1019" aria-hidden="true" tabindex="-1"></a>                                DEG <span class="sc">==</span> <span class="st">"down"</span> <span class="sc">~</span> <span class="st">"Liver_T12"</span>,</span>
<span id="cb44-1020"><a href="#cb44-1020" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"non-sig"</span>))</span>
<span id="cb44-1021"><a href="#cb44-1021" aria-hidden="true" tabindex="-1"></a>res10 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">count</span>(comparison, enrichment) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb44-1022"><a href="#cb44-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1023"><a href="#cb44-1023" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">=</span> <span class="fu">rbind_common</span>(res9,res10)</span>
<span id="cb44-1024"><a href="#cb44-1024" aria-hidden="true" tabindex="-1"></a><span class="fu">plotVenn</span>(<span class="fu">map</span>(<span class="fu">split</span>(res3, <span class="at">f =</span> <span class="fu">list</span>(res3<span class="sc">$</span>comparison, res3<span class="sc">$</span>enrichment)), <span class="cf">function</span>(x) x <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene)),</span>
<span id="cb44-1025"><a href="#cb44-1025" aria-hidden="true" tabindex="-1"></a>         <span class="at">use_venn =</span> F,</span>
<span id="cb44-1026"><a href="#cb44-1026" aria-hidden="true" tabindex="-1"></a>         <span class="at">main_text_size =</span> <span class="dv">15</span>,</span>
<span id="cb44-1027"><a href="#cb44-1027" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend_text_size =</span> <span class="dv">8</span>,</span>
<span id="cb44-1028"><a href="#cb44-1028" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend_position =</span> <span class="st">"left"</span>)</span>
<span id="cb44-1029"><a href="#cb44-1029" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-1030"><a href="#cb44-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1031"><a href="#cb44-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1032"><a href="#cb44-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1033"><a href="#cb44-1033" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Pathway analysis for tissue-enriched DEGs for timepoint T0</span></span>
<span id="cb44-1034"><a href="#cb44-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1035"><a href="#cb44-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1038"><a href="#cb44-1038" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-1039"><a href="#cb44-1039" aria-hidden="true" tabindex="-1"></a><span class="co"># perform pathway analysis using multiple pathway genesets</span></span>
<span id="cb44-1040"><a href="#cb44-1040" aria-hidden="true" tabindex="-1"></a><span class="co">#empty lists for adding in the pathway results</span></span>
<span id="cb44-1041"><a href="#cb44-1041" aria-hidden="true" tabindex="-1"></a>barplots_1 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb44-1042"><a href="#cb44-1042" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb44-1043"><a href="#cb44-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1044"><a href="#cb44-1044" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gene_set)) {</span>
<span id="cb44-1045"><a href="#cb44-1045" aria-hidden="true" tabindex="-1"></a>  go_results1 <span class="ot">=</span> <span class="fu">safely</span>(genORA)(res9 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(enrichment <span class="sc">==</span> <span class="st">"Heart"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene),</span>
<span id="cb44-1046"><a href="#cb44-1046" aria-hidden="true" tabindex="-1"></a>                               <span class="at">geneset =</span> gene_set[[i]],</span>
<span id="cb44-1047"><a href="#cb44-1047" aria-hidden="true" tabindex="-1"></a>                               <span class="at">p_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb44-1048"><a href="#cb44-1048" aria-hidden="true" tabindex="-1"></a>                               <span class="at">q_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb44-1049"><a href="#cb44-1049" aria-hidden="true" tabindex="-1"></a>                               <span class="at">universe =</span> <span class="fu">rownames</span>(res9))<span class="sc">$</span>result</span>
<span id="cb44-1050"><a href="#cb44-1050" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-1051"><a href="#cb44-1051" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results1)) {</span>
<span id="cb44-1052"><a href="#cb44-1052" aria-hidden="true" tabindex="-1"></a>    go_results1<span class="sc">$</span>geneset <span class="ot">=</span> gene_set[[i]]<span class="sc">$</span>type</span>
<span id="cb44-1053"><a href="#cb44-1053" aria-hidden="true" tabindex="-1"></a>    go_results1<span class="sc">$</span>enrichment <span class="ot">=</span> <span class="st">"Heart"</span></span>
<span id="cb44-1054"><a href="#cb44-1054" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-1055"><a href="#cb44-1055" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-1056"><a href="#cb44-1056" aria-hidden="true" tabindex="-1"></a>  go_results2 <span class="ot">=</span> <span class="fu">safely</span>(genORA)(res9 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(enrichment <span class="sc">==</span> <span class="st">"Liver"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene),</span>
<span id="cb44-1057"><a href="#cb44-1057" aria-hidden="true" tabindex="-1"></a>                               <span class="at">geneset =</span> gene_set[[i]],</span>
<span id="cb44-1058"><a href="#cb44-1058" aria-hidden="true" tabindex="-1"></a>                               <span class="at">p_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb44-1059"><a href="#cb44-1059" aria-hidden="true" tabindex="-1"></a>                               <span class="at">q_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb44-1060"><a href="#cb44-1060" aria-hidden="true" tabindex="-1"></a>                               <span class="at">universe =</span> <span class="fu">rownames</span>(res9))<span class="sc">$</span>result</span>
<span id="cb44-1061"><a href="#cb44-1061" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-1062"><a href="#cb44-1062" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results2)) {</span>
<span id="cb44-1063"><a href="#cb44-1063" aria-hidden="true" tabindex="-1"></a>    go_results2<span class="sc">$</span>geneset <span class="ot">=</span> gene_set[[i]]<span class="sc">$</span>type</span>
<span id="cb44-1064"><a href="#cb44-1064" aria-hidden="true" tabindex="-1"></a>    go_results2<span class="sc">$</span>enrichment <span class="ot">=</span> <span class="st">"Liver"</span></span>
<span id="cb44-1065"><a href="#cb44-1065" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-1066"><a href="#cb44-1066" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-1067"><a href="#cb44-1067" aria-hidden="true" tabindex="-1"></a>  df1 <span class="ot">&lt;-</span> <span class="fu">rbind_common</span>(df1, go_results1, go_results2)</span>
<span id="cb44-1068"><a href="#cb44-1068" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-1069"><a href="#cb44-1069" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(go_results2)) {</span>
<span id="cb44-1070"><a href="#cb44-1070" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">plotEnrich</span>(go_results1,</span>
<span id="cb44-1071"><a href="#cb44-1071" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot_type =</span> <span class="st">"bar"</span>,</span>
<span id="cb44-1072"><a href="#cb44-1072" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n_term =</span> <span class="dv">10</span>,</span>
<span id="cb44-1073"><a href="#cb44-1073" aria-hidden="true" tabindex="-1"></a>                   <span class="at">term_metric =</span> <span class="st">"FoldEnrich"</span>,</span>
<span id="cb44-1074"><a href="#cb44-1074" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stats_metric =</span> <span class="st">"qvalue"</span>)</span>
<span id="cb44-1075"><a href="#cb44-1075" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">plotEnrich</span>(go_results2,</span>
<span id="cb44-1076"><a href="#cb44-1076" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot_type =</span> <span class="st">"bar"</span>,</span>
<span id="cb44-1077"><a href="#cb44-1077" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n_term =</span> <span class="dv">10</span>,</span>
<span id="cb44-1078"><a href="#cb44-1078" aria-hidden="true" tabindex="-1"></a>                   <span class="at">term_metric =</span> <span class="st">"FoldEnrich"</span>,</span>
<span id="cb44-1079"><a href="#cb44-1079" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stats_metric =</span> <span class="st">"qvalue"</span>)</span>
<span id="cb44-1080"><a href="#cb44-1080" aria-hidden="true" tabindex="-1"></a>  barplots_1[[i]] <span class="ot">&lt;-</span> p1 <span class="sc">+</span> p2</span>
<span id="cb44-1081"><a href="#cb44-1081" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-1082"><a href="#cb44-1082" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-1083"><a href="#cb44-1083" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-1084"><a href="#cb44-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1085"><a href="#cb44-1085" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb44-1086"><a href="#cb44-1086" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb44-1087"><a href="#cb44-1087" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Pathway enrichment stats across multiple databases and tissue conditions"</span></span>
<span id="cb44-1088"><a href="#cb44-1088" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Significant pathways (labelled in blue) across timepoints when using ORA and multiple pathway databases"</span></span>
<span id="cb44-1089"><a href="#cb44-1089" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(df1)) { df1 <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="sc">%&gt;%</span> <span class="fu">gt_preview</span>(<span class="at">top_n =</span> <span class="dv">10</span>) }</span>
<span id="cb44-1090"><a href="#cb44-1090" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(df1)) {</span>
<span id="cb44-1091"><a href="#cb44-1091" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tidyheatmap</span>(<span class="at">df =</span> df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p.adjust <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">p.adjust =</span> <span class="sc">-</span><span class="fu">log10</span>(p.adjust)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(geneset) <span class="sc">%&gt;%</span> <span class="fu">remove_rownames</span>(), <span class="at">color_legend_n =</span> <span class="dv">1</span>, <span class="at">color_legend_min =</span> <span class="dv">0</span>, <span class="at">color_legend_max =</span> <span class="fl">1.3</span>,<span class="at">rows =</span> Description, <span class="at">columns =</span> enrichment, <span class="at">values =</span> p.adjust, <span class="at">annotation_row =</span> geneset, <span class="at">gaps_row =</span> geneset, <span class="at">gaps_col =</span> enrichment</span>
<span id="cb44-1092"><a href="#cb44-1092" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb44-1093"><a href="#cb44-1093" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-1094"><a href="#cb44-1094" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-1095"><a href="#cb44-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1096"><a href="#cb44-1096" aria-hidden="true" tabindex="-1"></a>No pathways significant for Heart and Liver DEGs for timepoint T0. </span>
<span id="cb44-1097"><a href="#cb44-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1098"><a href="#cb44-1098" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Pathway analysis for tissue-enriched DEGs for timepoint T12</span></span>
<span id="cb44-1099"><a href="#cb44-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1102"><a href="#cb44-1102" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-1103"><a href="#cb44-1103" aria-hidden="true" tabindex="-1"></a><span class="co"># perform pathway analysis using multiple pathway genesets</span></span>
<span id="cb44-1104"><a href="#cb44-1104" aria-hidden="true" tabindex="-1"></a><span class="co">#empty lists for adding in the pathway results</span></span>
<span id="cb44-1105"><a href="#cb44-1105" aria-hidden="true" tabindex="-1"></a>barplots_1 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb44-1106"><a href="#cb44-1106" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb44-1107"><a href="#cb44-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1108"><a href="#cb44-1108" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gene_set)) {</span>
<span id="cb44-1109"><a href="#cb44-1109" aria-hidden="true" tabindex="-1"></a>  go_results1 <span class="ot">=</span> <span class="fu">safely</span>(genORA)(res10 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(enrichment <span class="sc">==</span> <span class="st">"Heart"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene),</span>
<span id="cb44-1110"><a href="#cb44-1110" aria-hidden="true" tabindex="-1"></a>                               <span class="at">geneset =</span> gene_set[[i]],</span>
<span id="cb44-1111"><a href="#cb44-1111" aria-hidden="true" tabindex="-1"></a>                               <span class="at">p_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb44-1112"><a href="#cb44-1112" aria-hidden="true" tabindex="-1"></a>                               <span class="at">q_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb44-1113"><a href="#cb44-1113" aria-hidden="true" tabindex="-1"></a>                               <span class="at">universe =</span> <span class="fu">rownames</span>(res10))<span class="sc">$</span>result</span>
<span id="cb44-1114"><a href="#cb44-1114" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-1115"><a href="#cb44-1115" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results1)) {</span>
<span id="cb44-1116"><a href="#cb44-1116" aria-hidden="true" tabindex="-1"></a>    go_results1<span class="sc">$</span>geneset <span class="ot">=</span> gene_set[[i]]<span class="sc">$</span>type</span>
<span id="cb44-1117"><a href="#cb44-1117" aria-hidden="true" tabindex="-1"></a>    go_results1<span class="sc">$</span>enrichment <span class="ot">=</span> <span class="st">"Heart"</span></span>
<span id="cb44-1118"><a href="#cb44-1118" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-1119"><a href="#cb44-1119" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-1120"><a href="#cb44-1120" aria-hidden="true" tabindex="-1"></a>  go_results2 <span class="ot">=</span> <span class="fu">safely</span>(genORA)(res10 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(enrichment <span class="sc">==</span> <span class="st">"Liver"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene),</span>
<span id="cb44-1121"><a href="#cb44-1121" aria-hidden="true" tabindex="-1"></a>                               <span class="at">geneset =</span> gene_set[[i]],</span>
<span id="cb44-1122"><a href="#cb44-1122" aria-hidden="true" tabindex="-1"></a>                               <span class="at">p_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb44-1123"><a href="#cb44-1123" aria-hidden="true" tabindex="-1"></a>                               <span class="at">q_cutoff =</span> <span class="dv">1</span>, <span class="co">#to retrieve the whole output</span></span>
<span id="cb44-1124"><a href="#cb44-1124" aria-hidden="true" tabindex="-1"></a>                               <span class="at">universe =</span> <span class="fu">rownames</span>(res10))<span class="sc">$</span>result</span>
<span id="cb44-1125"><a href="#cb44-1125" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-1126"><a href="#cb44-1126" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results2)) {</span>
<span id="cb44-1127"><a href="#cb44-1127" aria-hidden="true" tabindex="-1"></a>    go_results2<span class="sc">$</span>geneset <span class="ot">=</span> gene_set[[i]]<span class="sc">$</span>type</span>
<span id="cb44-1128"><a href="#cb44-1128" aria-hidden="true" tabindex="-1"></a>    go_results2<span class="sc">$</span>enrichment <span class="ot">=</span> <span class="st">"Liver"</span></span>
<span id="cb44-1129"><a href="#cb44-1129" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-1130"><a href="#cb44-1130" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-1131"><a href="#cb44-1131" aria-hidden="true" tabindex="-1"></a>  df1 <span class="ot">&lt;-</span> <span class="fu">rbind_common</span>(df1, go_results1, go_results2)</span>
<span id="cb44-1132"><a href="#cb44-1132" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-1133"><a href="#cb44-1133" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(go_results1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(go_results2)) {</span>
<span id="cb44-1134"><a href="#cb44-1134" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">plotEnrich</span>(go_results1,</span>
<span id="cb44-1135"><a href="#cb44-1135" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot_type =</span> <span class="st">"bar"</span>,</span>
<span id="cb44-1136"><a href="#cb44-1136" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n_term =</span> <span class="dv">10</span>,</span>
<span id="cb44-1137"><a href="#cb44-1137" aria-hidden="true" tabindex="-1"></a>                   <span class="at">term_metric =</span> <span class="st">"FoldEnrich"</span>,</span>
<span id="cb44-1138"><a href="#cb44-1138" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stats_metric =</span> <span class="st">"qvalue"</span>)</span>
<span id="cb44-1139"><a href="#cb44-1139" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">plotEnrich</span>(go_results2,</span>
<span id="cb44-1140"><a href="#cb44-1140" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot_type =</span> <span class="st">"bar"</span>,</span>
<span id="cb44-1141"><a href="#cb44-1141" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n_term =</span> <span class="dv">10</span>,</span>
<span id="cb44-1142"><a href="#cb44-1142" aria-hidden="true" tabindex="-1"></a>                   <span class="at">term_metric =</span> <span class="st">"FoldEnrich"</span>,</span>
<span id="cb44-1143"><a href="#cb44-1143" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stats_metric =</span> <span class="st">"qvalue"</span>)</span>
<span id="cb44-1144"><a href="#cb44-1144" aria-hidden="true" tabindex="-1"></a>  barplots_1[[i]] <span class="ot">&lt;-</span> p1 <span class="sc">+</span> p2</span>
<span id="cb44-1145"><a href="#cb44-1145" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-1146"><a href="#cb44-1146" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-1147"><a href="#cb44-1147" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-1148"><a href="#cb44-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1149"><a href="#cb44-1149" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb44-1150"><a href="#cb44-1150" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb44-1151"><a href="#cb44-1151" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Pathway enrichment stats across multiple databases and tissue conditions"</span></span>
<span id="cb44-1152"><a href="#cb44-1152" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Significant pathways (labelled in blue) across timepoints when using ORA and multiple pathway databases"</span></span>
<span id="cb44-1153"><a href="#cb44-1153" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(df1)) { df1 <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="sc">%&gt;%</span> <span class="fu">gt_preview</span>(<span class="at">top_n =</span> <span class="dv">10</span>) }</span>
<span id="cb44-1154"><a href="#cb44-1154" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(df1)) {</span>
<span id="cb44-1155"><a href="#cb44-1155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">tidyheatmap</span>(<span class="at">df =</span> df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p.adjust <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">p.adjust =</span> <span class="sc">-</span><span class="fu">log10</span>(p.adjust)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(geneset) <span class="sc">%&gt;%</span> <span class="fu">remove_rownames</span>(), <span class="at">color_legend_n =</span> <span class="dv">1</span>, <span class="at">color_legend_min =</span> <span class="dv">0</span>, <span class="at">color_legend_max =</span> <span class="fl">1.3</span>,<span class="at">rows =</span> Description, <span class="at">columns =</span> enrichment, <span class="at">values =</span> p.adjust, <span class="at">annotation_row =</span> geneset, <span class="at">gaps_row =</span> geneset, <span class="at">gaps_col =</span> enrichment</span>
<span id="cb44-1156"><a href="#cb44-1156" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb44-1157"><a href="#cb44-1157" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-1158"><a href="#cb44-1158" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-1159"><a href="#cb44-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1160"><a href="#cb44-1160" aria-hidden="true" tabindex="-1"></a>No pathways significant for Heart and Liver DEGs for timepoint t12. </span>
<span id="cb44-1161"><a href="#cb44-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1162"><a href="#cb44-1162" aria-hidden="true" tabindex="-1"></a><span class="fu">## Heirarchical clustering of all the DEGs</span></span>
<span id="cb44-1163"><a href="#cb44-1163" aria-hidden="true" tabindex="-1"></a>Main effect DEGs are in res1 (tissue), res4 (Timepoint) objects whereas interaction specific DEGs are in res6 objects. res9 and res10 objects contain DEGs between Heart and Liver comparison for timepoints T0 and T12 respectively. </span>
<span id="cb44-1164"><a href="#cb44-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1167"><a href="#cb44-1167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-1168"><a href="#cb44-1168" aria-hidden="true" tabindex="-1"></a>significant_genes <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(res1 <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene), res4 <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene), res6 <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene), res9 <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene), res10 <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">filter</span>(padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(gene)))</span>
<span id="cb44-1169"><a href="#cb44-1169" aria-hidden="true" tabindex="-1"></a>sig_mat <span class="ot">&lt;-</span> normalized_cts[significant_genes,]</span>
<span id="cb44-1170"><a href="#cb44-1170" aria-hidden="true" tabindex="-1"></a>col_anno <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">df =</span> coldata <span class="sc">%&gt;%</span> <span class="fu">select</span>(tissue, time),</span>
<span id="cb44-1171"><a href="#cb44-1171" aria-hidden="true" tabindex="-1"></a>                             <span class="at">col =</span> <span class="fu">list</span>(<span class="at">tissue =</span> <span class="fu">c</span>(<span class="st">"Liver"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Heart"</span> <span class="ot">=</span> <span class="st">"blue"</span>)))</span>
<span id="cb44-1172"><a href="#cb44-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1173"><a href="#cb44-1173" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb44-1174"><a href="#cb44-1174" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb44-1175"><a href="#cb44-1175" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Heatmap of top 50 DEGs sorted by |logFC| (|logFC| &gt; 1 &amp; padj &lt; 0.01)"</span></span>
<span id="cb44-1176"><a href="#cb44-1176" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Boxplot of top 12 DEGs"</span></span>
<span id="cb44-1177"><a href="#cb44-1177" aria-hidden="true" tabindex="-1"></a><span class="fu">Heatmap</span>(<span class="fu">t</span>(<span class="fu">scale</span>(<span class="fu">t</span>(sig_mat))),</span>
<span id="cb44-1178"><a href="#cb44-1178" aria-hidden="true" tabindex="-1"></a>        <span class="at">top_annotation =</span> col_anno,</span>
<span id="cb44-1179"><a href="#cb44-1179" aria-hidden="true" tabindex="-1"></a>        <span class="at">show_row_names =</span> F,</span>
<span id="cb44-1180"><a href="#cb44-1180" aria-hidden="true" tabindex="-1"></a>        <span class="at">cluster_rows =</span> T,</span>
<span id="cb44-1181"><a href="#cb44-1181" aria-hidden="true" tabindex="-1"></a>        <span class="at">cluster_columns =</span> T,</span>
<span id="cb44-1182"><a href="#cb44-1182" aria-hidden="true" tabindex="-1"></a>        <span class="at">column_km =</span> <span class="dv">2</span>,</span>
<span id="cb44-1183"><a href="#cb44-1183" aria-hidden="true" tabindex="-1"></a>        <span class="at">row_km =</span> <span class="dv">2</span>,</span>
<span id="cb44-1184"><a href="#cb44-1184" aria-hidden="true" tabindex="-1"></a>        <span class="at">row_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">6</span>),</span>
<span id="cb44-1185"><a href="#cb44-1185" aria-hidden="true" tabindex="-1"></a>        <span class="at">column_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">7</span>),</span>
<span id="cb44-1186"><a href="#cb44-1186" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">"Scaled normalized</span><span class="sc">\n</span><span class="st">expression"</span></span>
<span id="cb44-1187"><a href="#cb44-1187" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb44-1188"><a href="#cb44-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1189"><a href="#cb44-1189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-1190"><a href="#cb44-1190" aria-hidden="true" tabindex="-1"></a>From the heatmap, we see that clustering of samples based on the tissue then the timepoint. tissue effects drive major source of variation compared to the timepoint. I roughly divided the DEGs obtained from various comparisons into 4 clusters -</span>
<span id="cb44-1191"><a href="#cb44-1191" aria-hidden="true" tabindex="-1"></a>Cluster 1 and 2 are associated with genes/markers active in either tissue irrespective of the timepoint. </span>
<span id="cb44-1192"><a href="#cb44-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1193"><a href="#cb44-1193" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot the expression pattern of the DEGs obtained from all the above comparisons</span></span>
<span id="cb44-1194"><a href="#cb44-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1197"><a href="#cb44-1197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-1198"><a href="#cb44-1198" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb44-1199"><a href="#cb44-1199" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: </span></span>
<span id="cb44-1200"><a href="#cb44-1200" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Grouping all the DEGs into clusters based on expression pattern trends"</span></span>
<span id="cb44-1201"><a href="#cb44-1201" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Clusters and their associated genes"</span></span>
<span id="cb44-1202"><a href="#cb44-1202" aria-hidden="true" tabindex="-1"></a>ma <span class="ot">=</span> <span class="fu">assay</span>(<span class="fu">vst</span>(dds))[significant_genes,]</span>
<span id="cb44-1203"><a href="#cb44-1203" aria-hidden="true" tabindex="-1"></a>coldata1 <span class="ot">=</span> coldata <span class="sc">%&gt;%</span> <span class="fu">column_to_rownames</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-1204"><a href="#cb44-1204" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">paste0</span>(tissue,<span class="st">"_"</span>, time),</span>
<span id="cb44-1205"><a href="#cb44-1205" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">group =</span> <span class="fu">factor</span>(group))</span>
<span id="cb44-1206"><a href="#cb44-1206" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">degPatterns</span>(ma, </span>
<span id="cb44-1207"><a href="#cb44-1207" aria-hidden="true" tabindex="-1"></a>                        <span class="at">metadata =</span> coldata1, </span>
<span id="cb44-1208"><a href="#cb44-1208" aria-hidden="true" tabindex="-1"></a>                        <span class="at">time =</span> <span class="st">"group"</span>, <span class="at">plot =</span> T)</span>
<span id="cb44-1209"><a href="#cb44-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1210"><a href="#cb44-1210" aria-hidden="true" tabindex="-1"></a>clusters<span class="sc">$</span>df <span class="sc">%&gt;%</span> <span class="fu">gt_preview</span>(<span class="at">top_n =</span> <span class="dv">10</span>)</span>
<span id="cb44-1211"><a href="#cb44-1211" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-1212"><a href="#cb44-1212" aria-hidden="true" tabindex="-1"></a> The output is the list of genes along with cluster IDs that facilitate filtering of genes with a particular expression pattern trend. </span>
<span id="cb44-1213"><a href="#cb44-1213" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb44-1214"><a href="#cb44-1214" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pathway analysis of various clusters obtained from the above analysis</span></span>
<span id="cb44-1215"><a href="#cb44-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1218"><a href="#cb44-1218" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-1219"><a href="#cb44-1219" aria-hidden="true" tabindex="-1"></a>hg_gs <span class="ot">=</span> geneset<span class="sc">::</span><span class="fu">getMsigdb</span>(<span class="at">org =</span> <span class="st">"human"</span>, <span class="at">category =</span> <span class="st">"H"</span>)</span>
<span id="cb44-1220"><a href="#cb44-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1221"><a href="#cb44-1221" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb44-1222"><a href="#cb44-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1223"><a href="#cb44-1223" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">unique</span>(clusters<span class="sc">$</span>df<span class="sc">$</span>cluster), <span class="cf">function</span>(x) {</span>
<span id="cb44-1224"><a href="#cb44-1224" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-1225"><a href="#cb44-1225" aria-hidden="true" tabindex="-1"></a>  go_results1 <span class="ot">=</span> <span class="fu">safely</span>(genORA)(clusters<span class="sc">$</span>df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(cluster <span class="sc">==</span> x) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(genes),</span>
<span id="cb44-1226"><a href="#cb44-1226" aria-hidden="true" tabindex="-1"></a>                               <span class="at">geneset =</span> hg_gs,</span>
<span id="cb44-1227"><a href="#cb44-1227" aria-hidden="true" tabindex="-1"></a>                               <span class="co">#p_cutoff = 1, #to retrieve the whole output</span></span>
<span id="cb44-1228"><a href="#cb44-1228" aria-hidden="true" tabindex="-1"></a>                               <span class="co">#q_cutoff = 1, #to retrieve the whole output</span></span>
<span id="cb44-1229"><a href="#cb44-1229" aria-hidden="true" tabindex="-1"></a>                               <span class="at">universe =</span> clusters<span class="sc">$</span>df <span class="sc">%&gt;%</span> <span class="fu">pull</span>(genes))<span class="sc">$</span>result</span>
<span id="cb44-1230"><a href="#cb44-1230" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb44-1231"><a href="#cb44-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1232"><a href="#cb44-1232" aria-hidden="true" tabindex="-1"></a><span class="fu">list_rbind</span>(df1, <span class="at">names_to =</span> <span class="st">"cluster"</span>)</span>
<span id="cb44-1233"><a href="#cb44-1233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-1234"><a href="#cb44-1234" aria-hidden="true" tabindex="-1"></a>Cluster 1 (genes active in liver irrespective of timepoint) genes are associated with HALLMARK_XENOBIOTIC_METABOLISM &amp; HALLMARK_COAGULATION pathways.</span>
<span id="cb44-1235"><a href="#cb44-1235" aria-hidden="true" tabindex="-1"></a>Cluster 4 (genes active in heart irrespective of timepoint) genes are associated with HALLMARK_MYOGENESIS &amp; HALLMARK_OXIDATIVE_PHOSPHORYLATION pathways.</span>
<span id="cb44-1236"><a href="#cb44-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1239"><a href="#cb44-1239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-1240"><a href="#cb44-1240" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb44-1241"><a href="#cb44-1241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>